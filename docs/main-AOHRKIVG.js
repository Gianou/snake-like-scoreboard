import{A as db,B as Hn,C as Pi,D as vh,E as vu,F as gy,G as hb,H as fb,I as ae,J as wn,K as Pt,L as my,M as pb,N as wu,O as ce,P as Gt,Q as wh,R as yy,S as zn,T as ki,U as si,V as na,W as gb,X as En,Y as ft,a as Q,b as Je,c as hy,d as M,e as rb,f as ph,g as ib,h as sb,i as j,j as ea,k as gh,l as ob,m as ab,n as Ut,o as ta,p as _u,q as fy,r as cb,s as Er,t as py,u as mh,v as yh,w as ub,x as _h,y as Ct,z as lb}from"./chunk-L2ZMDQ4Q.js";var mb=null;var _y=1,yb=Symbol("SIGNAL");function Ve(n){let e=mb;return mb=n,e}var _b={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function FL(n){if(!(Ey(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===_y)){if(!n.producerMustRecompute(n)&&!vy(n)){n.dirty=!1,n.lastCleanEpoch=_y;return}n.producerRecomputeValue(n),n.dirty=!1,n.lastCleanEpoch=_y}}function vb(n){return n&&(n.nextProducerIndex=0),Ve(n)}function wb(n,e){if(Ve(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Ey(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)wy(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function vy(n){Eh(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(FL(t),r!==t.version))return!0}return!1}function Eb(n){if(Eh(n),Ey(n))for(let e=0;e<n.producerNode.length;e++)wy(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function wy(n,e){if(LL(n),Eh(n),n.liveConsumerNode.length===1)for(let r=0;r<n.producerNode.length;r++)wy(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];Eh(i),i.producerIndexOfThis[r]=e}}function Ey(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Eh(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function LL(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function VL(){throw new Error}var UL=VL;function Ib(n){UL=n}function de(n){return typeof n=="function"}function ra(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Ih=ra(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Vs(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var mt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(de(r))try{r()}catch(s){e=s instanceof Ih?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{Tb(s)}catch(o){e=e??[],o instanceof Ih?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Ih(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Tb(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Vs(t,e)}remove(e){let{_finalizers:t}=this;t&&Vs(t,e),e instanceof n&&e._removeParent(this)}};mt.EMPTY=(()=>{let n=new mt;return n.closed=!0,n})();var Iy=mt.EMPTY;function Th(n){return n instanceof mt||n&&"closed"in n&&de(n.remove)&&de(n.add)&&de(n.unsubscribe)}function Tb(n){de(n)?n():n.unsubscribe()}var sr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var ia={setTimeout(n,e,...t){let{delegate:r}=ia;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=ia;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Ch(n){ia.setTimeout(()=>{let{onUnhandledError:e}=sr;if(e)e(n);else throw n})}function Us(){}var Cb=Ty("C",void 0,void 0);function Db(n){return Ty("E",void 0,n)}function bb(n){return Ty("N",n,void 0)}function Ty(n,e,t){return{kind:n,value:e,error:t}}var js=null;function sa(n){if(sr.useDeprecatedSynchronousErrorHandling){let e=!js;if(e&&(js={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=js;if(js=null,t)throw r}}else n()}function Sb(n){sr.useDeprecatedSynchronousErrorHandling&&js&&(js.errorThrown=!0,js.error=n)}var Bs=class extends mt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Th(e)&&e.add(this)):this.destination=$L}static create(e,t,r){return new oi(e,t,r)}next(e){this.isStopped?Dy(bb(e),this):this._next(e)}error(e){this.isStopped?Dy(Db(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Dy(Cb,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},jL=Function.prototype.bind;function Cy(n,e){return jL.call(n,e)}var by=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Dh(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Dh(r)}else Dh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Dh(t)}}},oi=class extends Bs{constructor(e,t,r){super();let i;if(de(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&sr.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Cy(e.next,s),error:e.error&&Cy(e.error,s),complete:e.complete&&Cy(e.complete,s)}):i=e}this.destination=new by(i)}};function Dh(n){sr.useDeprecatedSynchronousErrorHandling?Sb(n):Ch(n)}function BL(n){throw n}function Dy(n,e){let{onStoppedNotification:t}=sr;t&&ia.setTimeout(()=>t(n,e))}var $L={closed:!0,next:Us,error:BL,complete:Us};var oa=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Wt(n){return n}function Sy(...n){return Ay(n)}function Ay(n){return n.length===0?Wt:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var ve=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=HL(t)?t:new oi(t,r,i);return sa(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=Ab(r),new r((i,s)=>{let o=new oi({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[oa](){return this}pipe(...t){return Ay(t)(this)}toPromise(t){return t=Ab(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function Ab(n){var e;return(e=n??sr.Promise)!==null&&e!==void 0?e:Promise}function qL(n){return n&&de(n.next)&&de(n.error)&&de(n.complete)}function HL(n){return n&&n instanceof Bs||qL(n)&&Th(n)}function Ry(n){return de(n?.lift)}function ue(n){return e=>{if(Ry(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function he(n,e,t,r,i){return new xy(n,e,t,r,i)}var xy=class extends Bs{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function aa(){return ue((n,e)=>{let t=null;n._refCount++;let r=he(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var ca=class extends ve{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Ry(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new mt;let t=this.getSubject();e.add(this.source.subscribe(he(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=mt.EMPTY)}return e}refCount(){return aa()(this)}};var Rb=ra(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var yt=(()=>{class n extends ve{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new bh(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new Rb}next(t){sa(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){sa(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){sa(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Iy:(this.currentObservers=null,s.push(t),new mt(()=>{this.currentObservers=null,Vs(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new ve;return t.source=this,t}}return n.create=(e,t)=>new bh(e,t),n})(),bh=class extends yt{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Iy}};var Kt=class extends yt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Eu={now(){return(Eu.delegate||Date).now()},delegate:void 0};var Sh=class extends yt{constructor(e=1/0,t=1/0,r=Eu){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){let{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;t||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){let{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=t.now(),a=0;for(let c=1;c<r.length&&r[c]<=o;c+=2)a=c;a&&r.splice(0,a+1)}}};var Ah=class extends mt{constructor(e,t){super()}schedule(e,t=0){return this}};var Iu={setInterval(n,e,...t){let{delegate:r}=Iu;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Iu;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var ua=class extends Ah{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,r=0){return Iu.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&Iu.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Vs(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var la=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};la.now=Eu.now;var da=class extends la{constructor(e,t=la.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var ai=new da(ua);var Rh=class extends ua{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var xh=class extends da{};var My=new xh(Rh);var cn=new ve(n=>n.complete());function xb(n){return n&&de(n.schedule)}function Ny(n){return n[n.length-1]}function Mh(n){return de(Ny(n))?n.pop():void 0}function Ir(n){return xb(Ny(n))?n.pop():void 0}function Mb(n,e){return typeof Ny(n)=="number"?n.pop():e}var Nh=n=>n&&typeof n.length=="number"&&typeof n!="function";function Ph(n){return de(n?.then)}function kh(n){return de(n[oa])}function Oh(n){return Symbol.asyncIterator&&de(n?.[Symbol.asyncIterator])}function Fh(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function zL(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Lh=zL();function Vh(n){return de(n?.[Lh])}function Uh(n){return ib(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield ph(t.read());if(i)return yield ph(void 0);yield yield ph(r)}}finally{t.releaseLock()}})}function jh(n){return de(n?.getReader)}function et(n){if(n instanceof ve)return n;if(n!=null){if(kh(n))return GL(n);if(Nh(n))return WL(n);if(Ph(n))return KL(n);if(Oh(n))return Nb(n);if(Vh(n))return QL(n);if(jh(n))return YL(n)}throw Fh(n)}function GL(n){return new ve(e=>{let t=n[oa]();if(de(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function WL(n){return new ve(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function KL(n){return new ve(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Ch)})}function QL(n){return new ve(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function Nb(n){return new ve(e=>{ZL(n,e).catch(t=>e.error(t))})}function YL(n){return Nb(Uh(n))}function ZL(n,e){var t,r,i,s;return rb(this,void 0,void 0,function*(){try{for(t=sb(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function In(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function Mn(n,e=0){return ue((t,r)=>{t.subscribe(he(r,i=>In(r,n,()=>r.next(i),e),()=>In(r,n,()=>r.complete(),e),i=>In(r,n,()=>r.error(i),e)))})}function or(n,e=0){return ue((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function Pb(n,e){return et(n).pipe(or(e),Mn(e))}function kb(n,e){return et(n).pipe(or(e),Mn(e))}function Ob(n,e){return new ve(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function Fb(n,e){return new ve(t=>{let r;return In(t,e,()=>{r=n[Lh](),In(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>de(r?.return)&&r.return()})}function Bh(n,e){if(!n)throw new Error("Iterable cannot be null");return new ve(t=>{In(t,e,()=>{let r=n[Symbol.asyncIterator]();In(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function Lb(n,e){return Bh(Uh(n),e)}function Vb(n,e){if(n!=null){if(kh(n))return Pb(n,e);if(Nh(n))return Ob(n,e);if(Ph(n))return kb(n,e);if(Oh(n))return Bh(n,e);if(Vh(n))return Fb(n,e);if(jh(n))return Lb(n,e)}throw Fh(n)}function Ae(n,e){return e?Vb(n,e):et(n)}function ne(...n){let e=Ir(n);return Ae(n,e)}function ha(n,e){let t=de(n)?n:()=>n,r=i=>i.error(t());return new ve(e?i=>e.schedule(r,0,i):r)}function Py(n){return!!n&&(n instanceof ve||de(n.lift)&&de(n.subscribe))}var ci=ra(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function ee(n,e){return ue((t,r)=>{let i=0;t.subscribe(he(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:XL}=Array;function JL(n,e){return XL(e)?n(...e):n(e)}function Ub(n){return ee(e=>JL(n,e))}var{isArray:eV}=Array,{getPrototypeOf:tV,prototype:nV,keys:rV}=Object;function jb(n){if(n.length===1){let e=n[0];if(eV(e))return{args:e,keys:null};if(iV(e)){let t=rV(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function iV(n){return n&&typeof n=="object"&&tV(n)===nV}function Bb(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Tu(...n){let e=Ir(n),t=Mh(n),{args:r,keys:i}=jb(n);if(r.length===0)return Ae([],e);let s=new ve(sV(r,e,i?o=>Bb(i,o):Wt));return t?s.pipe(Ub(t)):s}function sV(n,e,t=Wt){return r=>{$b(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)$b(e,()=>{let l=Ae(n[c],e),d=!1;l.subscribe(he(r,f=>{s[c]=f,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function $b(n,e,t){n?In(t,n,e):e()}function qb(n,e,t,r,i,s,o,a){let c=[],l=0,d=0,f=!1,g=()=>{f&&!c.length&&!l&&e.complete()},y=b=>l<r?v(b):c.push(b),v=b=>{s&&e.next(b),l++;let C=!1;et(t(b,d++)).subscribe(he(e,V=>{i?.(V),s?y(V):e.next(V)},()=>{C=!0},void 0,()=>{if(C)try{for(l--;c.length&&l<r;){let V=c.shift();o?In(e,o,()=>v(V)):v(V)}g()}catch(V){e.error(V)}}))};return n.subscribe(he(e,y,()=>{f=!0,g()})),()=>{a?.()}}function Dt(n,e,t=1/0){return de(e)?Dt((r,i)=>ee((s,o)=>e(r,s,i,o))(et(n(r,i))),t):(typeof e=="number"&&(t=e),ue((r,i)=>qb(r,i,n,t)))}function Oi(n=1/0){return Dt(Wt,n)}function Hb(){return Oi(1)}function fa(...n){return Hb()(Ae(n,Ir(n)))}function $h(n){return new ve(e=>{et(n()).subscribe(e)})}function pa(...n){let e=Ir(n),t=Mb(n,1/0),r=n;return r.length?r.length===1?et(r[0]):Oi(t)(Ae(r,e)):cn}function Qt(n,e){return ue((t,r)=>{let i=0;t.subscribe(he(r,s=>n.call(e,s,i++)&&r.next(s)))})}function Fi(n){return ue((e,t)=>{let r=null,i=!1,s;r=e.subscribe(he(t,void 0,void 0,o=>{s=et(n(o,Fi(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function zb(n,e,t,r,i){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(he(o,d=>{let f=l++;c=a?n(c,d,f):(a=!0,d),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function $s(n,e){return de(e)?Dt(n,e,1):Dt(n,1)}function ky(n,e=ai){return ue((t,r)=>{let i=null,s=null,o=null,a=()=>{if(i){i.unsubscribe(),i=null;let l=s;s=null,r.next(l)}};function c(){let l=o+n,d=e.now();if(d<l){i=this.schedule(void 0,l-d),r.add(i);return}a()}t.subscribe(he(r,l=>{s=l,o=e.now(),i||(i=e.schedule(c,n),r.add(i))},()=>{a(),r.complete()},void 0,()=>{s=i=null}))})}function Li(n){return ue((e,t)=>{let r=!1;e.subscribe(he(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function ui(n){return n<=0?()=>cn:ue((e,t)=>{let r=0;e.subscribe(he(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function Oy(n){return ee(()=>n)}function Cu(n,e=Wt){return n=n??oV,ue((t,r)=>{let i,s=!0;t.subscribe(he(r,o=>{let a=e(o);(s||!n(i,a))&&(s=!1,i=a,r.next(o))}))})}function oV(n,e){return n===e}function qh(n=aV){return ue((e,t)=>{let r=!1;e.subscribe(he(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function aV(){return new ci}function Du(n){return ue((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Gn(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Qt((i,s)=>n(i,s,r)):Wt,ui(1),t?Li(e):qh(()=>new ci))}function ga(n){return n<=0?()=>cn:ue((e,t)=>{let r=[];e.subscribe(he(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Fy(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Qt((i,s)=>n(i,s,r)):Wt,ga(1),t?Li(e):qh(()=>new ci))}function bu(){return ue((n,e)=>{let t,r=!1;n.subscribe(he(e,i=>{let s=t;t=i,r&&e.next([s,i]),r=!0}))})}function Tr(n,e){return ue(zb(n,e,arguments.length>=2,!0))}function Su(n={}){let{connector:e=()=>new yt,resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return s=>{let o,a,c,l=0,d=!1,f=!1,g=()=>{a?.unsubscribe(),a=void 0},y=()=>{g(),o=c=void 0,d=f=!1},v=()=>{let b=o;y(),b?.unsubscribe()};return ue((b,C)=>{l++,!f&&!d&&g();let V=c=c??e();C.add(()=>{l--,l===0&&!f&&!d&&(a=Ly(v,i))}),V.subscribe(C),!o&&l>0&&(o=new oi({next:B=>V.next(B),error:B=>{f=!0,g(),a=Ly(y,t,B),V.error(B)},complete:()=>{d=!0,g(),a=Ly(y,r),V.complete()}}),et(b).subscribe(o))})(s)}}function Ly(n,e,...t){if(e===!0){n();return}if(e===!1)return;let r=new oi({next:()=>{r.unsubscribe(),n()}});return et(e(...t)).subscribe(r)}function Hh(n,e,t){let r,i=!1;return n&&typeof n=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n:r=n??1/0,Su({connector:()=>new Sh(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function Vy(n){return ue((e,t)=>{let r=!1,i=0;e.subscribe(he(t,s=>(r||(r=!n(s,i++)))&&t.next(s)))})}function qs(...n){let e=Ir(n);return ue((t,r)=>{(e?fa(n,t,e):fa(n,t)).subscribe(r)})}function ze(n,e){return ue((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(he(r,c=>{i?.unsubscribe();let l=0,d=s++;et(n(c,d)).subscribe(i=he(r,f=>r.next(e?e(c,f,d,l++):f),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function zh(n,e){return de(e)?ze(()=>n,e):ze(()=>n)}function Uy(n){return ue((e,t)=>{et(n).subscribe(he(t,()=>t.complete(),Us)),!t.closed&&e.subscribe(t)})}function bt(n,e,t){let r=de(n)||e||t?{next:n,error:e,complete:t}:n;return r?ue((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(he(s,c=>{var l;(l=r.next)===null||l===void 0||l.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,c),s.error(c)},()=>{var c,l;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):Wt}function jy(...n){let e=Mh(n);return ue((t,r)=>{let i=n.length,s=new Array(i),o=n.map(()=>!1),a=!1;for(let c=0;c<i;c++)et(n[c]).subscribe(he(r,l=>{s[c]=l,!a&&!o[c]&&(o[c]=!0,(a=o.every(Wt))&&(o=null))},Us));t.subscribe(he(r,c=>{if(a){let l=[c,...s];r.next(e?e(...l):l)}}))})}var se=class extends Error{constructor(e,t){super(F_(e,t)),this.code=e}};function F_(n,e){return`${`NG0${Math.abs(n)}`}${e?": "+e:""}`}function ju(n){return{toString:n}.toString()}var Gh="__parameters__";function cV(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function SS(n,e,t){return ju(()=>{let r=cV(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,l,d){let f=c.hasOwnProperty(Gh)?c[Gh]:Object.defineProperty(c,Gh,{value:[]})[Gh];for(;f.length<=d;)f.push(null);return(f[d]=f[d]||[]).push(o),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var Nn=globalThis;function Ge(n){for(let e in n)if(n[e]===Ge)return e;throw Error("Could not find renamed property on target object.")}function Cn(n){if(typeof n=="string")return n;if(Array.isArray(n))return"["+n.map(Cn).join(", ")+"]";if(n==null)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;let e=n.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function Gb(n,e){return n==null||n===""?e===null?"":e:e==null||e===""?n:n+" "+e}var uV=Ge({__forward_ref__:Ge});function AS(n){return n.__forward_ref__=AS,n.toString=function(){return Cn(this())},n}function Wn(n){return RS(n)?n():n}function RS(n){return typeof n=="function"&&n.hasOwnProperty(uV)&&n.__forward_ref__===AS}function J(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function _t(n){return{providers:n.providers||[],imports:n.imports||[]}}function Ef(n){return Wb(n,MS)||Wb(n,NS)}function xS(n){return Ef(n)!==null}function Wb(n,e){return n.hasOwnProperty(e)?n[e]:null}function lV(n){let e=n&&(n[MS]||n[NS]);return e||null}function Kb(n){return n&&(n.hasOwnProperty(Qb)||n.hasOwnProperty(dV))?n[Qb]:null}var MS=Ge({\u0275prov:Ge}),Qb=Ge({\u0275inj:Ge}),NS=Ge({ngInjectableDef:Ge}),dV=Ge({ngInjectorDef:Ge}),K=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=J({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function PS(n){return n&&!!n.\u0275providers}var hV=Ge({\u0275cmp:Ge}),fV=Ge({\u0275dir:Ge}),pV=Ge({\u0275pipe:Ge}),gV=Ge({\u0275mod:Ge}),Jh=Ge({\u0275fac:Ge}),Au=Ge({__NG_ELEMENT_ID__:Ge}),Yb=Ge({__NG_ENV_ID__:Ge});function kS(n){return typeof n=="string"?n:n==null?"":String(n)}function mV(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():kS(n)}function yV(n,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new se(-200,n)}function L_(n,e){throw new se(-201,!1)}var Ce=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Ce||{}),Yy;function OS(){return Yy}function Tn(n){let e=Yy;return Yy=n,e}function FS(n,e,t){let r=Ef(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&Ce.Optional)return null;if(e!==void 0)return e;L_(n,"Injector")}var _V={},xu=_V,Zy="__NG_DI_FLAG__",ef="ngTempTokenPath",vV="ngTokenPath",wV=/\n/gm,EV="\u0275",Zb="__source",wa;function IV(){return wa}function Vi(n){let e=wa;return wa=n,e}function TV(n,e=Ce.Default){if(wa===void 0)throw new se(-203,!1);return wa===null?FS(n,void 0,e):wa.get(n,e&Ce.Optional?null:void 0,e)}function F(n,e=Ce.Default){return(OS()||TV)(Wn(n),e)}function G(n,e=Ce.Default){return F(n,If(e))}function If(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Xy(n){let e=[];for(let t=0;t<n.length;t++){let r=Wn(n[t]);if(Array.isArray(r)){if(r.length===0)throw new se(900,!1);let i,s=Ce.Default;for(let o=0;o<r.length;o++){let a=r[o],c=CV(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(F(i,s))}else e.push(F(r))}return e}function LS(n,e){return n[Zy]=e,n.prototype[Zy]=e,n}function CV(n){return n[Zy]}function DV(n,e,t,r){let i=n[ef];throw e[Zb]&&i.unshift(e[Zb]),n.message=bV(`
`+n.message,i,t,r),n[vV]=i,n[ef]=null,n}function bV(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==EV?n.slice(2):n;let i=Cn(e);if(Array.isArray(e))i=e.map(Cn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Cn(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(wV,`
  `)}`}var Xs=LS(SS("Optional"),8);var Tf=LS(SS("SkipSelf"),4);function Gs(n,e){let t=n.hasOwnProperty(Jh);return t?n[Jh]:null}function V_(n,e){n.forEach(t=>Array.isArray(t)?V_(t,e):e(t))}function VS(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function tf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}var Mu={},Cr=[],Ia=new K(""),US=new K("",-1),jS=new K(""),nf=class{get(e,t=xu){if(t===xu){let r=new Error(`NullInjectorError: No provider for ${Cn(e)}!`);throw r.name="NullInjectorError",r}return t}},BS=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(BS||{}),br=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(br||{}),Bi=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(Bi||{});function SV(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function Jy(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];RV(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function AV(n){return n===3||n===4||n===6}function RV(n){return n.charCodeAt(0)===64}function U_(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?Xb(n,t,i,null,e[++r]):Xb(n,t,i,null,null))}}return n}function Xb(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(n[s+1]=i);return}else if(r===n[s+1]){n[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),r!==null&&n.splice(s++,0,r),i!==null&&n.splice(s++,0,i)}var $S="ng-template";function xV(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&SV(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(j_(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function j_(n){return n.type===4&&n.value!==$S}function MV(n,e,t){let r=n.type===4&&!t?$S:n.value;return e===r}function NV(n,e,t){let r=4,i=n.attrs,s=i!==null?OV(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!ar(r)&&!ar(c))return!1;if(o&&ar(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!MV(n,c,t)||c===""&&e.length===1){if(ar(r))return!1;o=!0}}else if(r&8){if(i===null||!xV(n,i,c,t)){if(ar(r))return!1;o=!0}}else{let l=e[++a],d=PV(c,i,j_(n),t);if(d===-1){if(ar(r))return!1;o=!0;continue}if(l!==""){let f;if(d>s?f="":f=i[d+1].toLowerCase(),r&2&&l!==f){if(ar(r))return!1;o=!0}}}}return ar(r)||o}function ar(n){return(n&1)===0}function PV(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return FV(e,n)}function kV(n,e,t=!1){for(let r=0;r<e.length;r++)if(NV(n,e[r],t))return!0;return!1}function OV(n){for(let e=0;e<n.length;e++){let t=n[e];if(AV(t))return e}return n.length}function FV(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function Jb(n,e){return n?":not("+e.trim()+")":e}function LV(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!ar(o)&&(e+=Jb(s,i),i=""),r=o,s=s||!ar(r);t++}return i!==""&&(e+=Jb(s,i)),e}function VV(n){return n.map(LV).join(",")}function UV(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!ar(i))break;i=s}r++}return{attrs:e,classes:t}}function ba(n){return ju(()=>{let e=WS(n),t=Je(Q({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===BS.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||br.Emulated,styles:n.styles||Cr,_:null,schemas:n.schemas||null,tView:null,id:""});KS(t);let r=n.dependencies;return t.directiveDefs=tS(r,!1),t.pipeDefs=tS(r,!0),t.id=$V(t),t})}function jV(n){return $i(n)||qS(n)}function BV(n){return n!==null}function vt(n){return ju(()=>({type:n.type,bootstrap:n.bootstrap||Cr,declarations:n.declarations||Cr,imports:n.imports||Cr,exports:n.exports||Cr,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function eS(n,e){if(n==null)return Mu;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a=Bi.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(t[s]=a!==Bi.None?[r,a]:r,e[s]=o):t[s]=r}return t}function Sa(n){return ju(()=>{let e=WS(n);return KS(e),e})}function B_(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone===!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function $i(n){return n[hV]||null}function qS(n){return n[fV]||null}function HS(n){return n[pV]||null}function zS(n){let e=$i(n)||qS(n)||HS(n);return e!==null?e.standalone:!1}function GS(n,e){let t=n[gV]||null;if(!t&&e===!0)throw new Error(`Type ${Cn(n)} does not have '\u0275mod' property.`);return t}function WS(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||Mu,exportAs:n.exportAs||null,standalone:n.standalone===!0,signals:n.signals===!0,selectors:n.selectors||Cr,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:eS(n.inputs,e),outputs:eS(n.outputs),debugInfo:null}}function KS(n){n.features?.forEach(e=>e(n))}function tS(n,e){if(!n)return null;let t=e?HS:jV;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(BV)}function $V(n){let e=0,t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(let i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function qV(...n){return{\u0275providers:QS(!0,n),\u0275fromNgModule:!0}}function QS(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return V_(e,o=>{let a=o;e_(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&YS(i,s),t}function YS(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];$_(i,s=>{e(s,r)})}}function e_(n,e,t,r){if(n=Wn(n),!n)return!1;let i=null,s=Kb(n),o=!s&&$i(n);if(!s&&!o){let c=n.ngModule;if(s=Kb(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)e_(l,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let l;try{V_(s.imports,d=>{e_(d,e,t,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&YS(l,e)}if(!a){let l=Gs(i)||(()=>new i);e({provide:i,useFactory:l,deps:Cr},i),e({provide:jS,useValue:i,multi:!0},i),e({provide:Ia,useValue:()=>F(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let l=n;$_(c,d=>{e(d,l)})}}else return!1;return i!==n&&n.providers!==void 0}function $_(n,e){for(let t of n)PS(t)&&(t=t.\u0275providers),Array.isArray(t)?$_(t,e):e(t)}var HV=Ge({provide:String,useValue:Ge});function ZS(n){return n!==null&&typeof n=="object"&&HV in n}function zV(n){return!!(n&&n.useExisting)}function GV(n){return!!(n&&n.useFactory)}function t_(n){return typeof n=="function"}var Cf=new K(""),Kh={},WV={},By;function q_(){return By===void 0&&(By=new nf),By}var Dn=class{},Nu=class extends Dn{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,r_(e,o=>this.processProvider(o)),this.records.set(US,ma(void 0,this)),i.has("environment")&&this.records.set(Dn,ma(void 0,this));let s=this.records.get(Cf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(jS,Cr,Ce.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Ve(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ve(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=Vi(this),r=Tn(void 0),i;try{return e()}finally{Vi(t),Tn(r)}}get(e,t=xu,r=Ce.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(Yb))return e[Yb](this);r=If(r);let i,s=Vi(this),o=Tn(void 0);try{if(!(r&Ce.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=JV(e)&&Ef(e);l&&this.injectableDefInScope(l)?c=ma(n_(e),Kh):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&Ce.Self?q_():this.parent;return t=r&Ce.Optional&&t===xu?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[ef]=a[ef]||[]).unshift(Cn(e)),s)throw a;return DV(a,e,"R3InjectorError",this.source)}else throw a}finally{Tn(o),Vi(s)}}resolveInjectorInitializers(){let e=Ve(null),t=Vi(this),r=Tn(void 0),i;try{let s=this.get(Ia,Cr,Ce.Self);for(let o of s)o()}finally{Vi(t),Tn(r),Ve(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(Cn(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new se(205,!1)}processProvider(e){e=Wn(e);let t=t_(e)?e:Wn(e&&e.provide),r=QV(e);if(!t_(e)&&e.multi===!0){let i=this.records.get(t);i||(i=ma(void 0,Kh,!0),i.factory=()=>Xy(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){let r=Ve(null);try{return t.value===Kh&&(t.value=WV,t.value=t.factory()),typeof t.value=="object"&&t.value&&XV(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Ve(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=Wn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function n_(n){let e=Ef(n),t=e!==null?e.factory:Gs(n);if(t!==null)return t;if(n instanceof K)throw new se(204,!1);if(n instanceof Function)return KV(n);throw new se(204,!1)}function KV(n){if(n.length>0)throw new se(204,!1);let t=lV(n);return t!==null?()=>t.factory(n):()=>new n}function QV(n){if(ZS(n))return ma(void 0,n.useValue);{let e=YV(n);return ma(e,Kh)}}function YV(n,e,t){let r;if(t_(n)){let i=Wn(n);return Gs(i)||n_(i)}else if(ZS(n))r=()=>Wn(n.useValue);else if(GV(n))r=()=>n.useFactory(...Xy(n.deps||[]));else if(zV(n))r=()=>F(Wn(n.useExisting));else{let i=Wn(n&&(n.useClass||n.provide));if(ZV(n))r=()=>new i(...Xy(n.deps));else return Gs(i)||n_(i)}return r}function ma(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function ZV(n){return!!n.deps}function XV(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function JV(n){return typeof n=="function"||typeof n=="object"&&n instanceof K}function r_(n,e){for(let t of n)Array.isArray(t)?r_(t,e):t&&PS(t)?r_(t.\u0275providers,e):e(t)}function hi(n,e){n instanceof Nu&&n.assertNotDestroyed();let t,r=Vi(n),i=Tn(void 0);try{return e()}finally{Vi(r),Tn(i)}}function XS(){return OS()!==void 0||IV()!=null}function e2(n){if(!XS())throw new se(-203,!1)}function t2(n){let e=Nn.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function n2(n){return typeof n=="function"}var fi=0,xe=1,le=2,en=3,cr=4,lr=5,rf=6,nS=7,li=8,Ta=9,Sr=10,bn=11,Pu=12,rS=13,Aa=14,Ar=15,Df=16,ya=17,Ca=18,bf=19,JS=20,ji=21,$y=22,Ws=23,ur=25,eA=1;var Ks=7,sf=8,of=9,Kn=10,H_=function(n){return n[n.None=0]="None",n[n.HasTransplantedViews=2]="HasTransplantedViews",n}(H_||{});function Hs(n){return Array.isArray(n)&&typeof n[eA]=="object"}function pi(n){return Array.isArray(n)&&n[eA]===!0}function tA(n){return(n.flags&4)!==0}function Sf(n){return n.componentOffset>-1}function nA(n){return(n.flags&1)===1}function Bu(n){return!!n.template}function r2(n){return(n[le]&512)!==0}var i_=class{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function rA(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}function Af(){return iA}function iA(n){return n.type.prototype.ngOnChanges&&(n.setInput=s2),i2}Af.ngInherit=!0;function i2(){let n=oA(this),e=n?.current;if(e){let t=n.previous;if(t===Mu)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function s2(n,e,t,r,i){let s=this.declaredInputs[r],o=oA(n)||o2(n,{previous:Mu,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new i_(l&&l.currentValue,t,c===Mu),rA(n,e,i,t)}var sA="__ngSimpleChanges__";function oA(n){return n[sA]||null}function o2(n,e){return n[sA]=e}var iS=null;var Ui=function(n,e,t){iS?.(n,e,t)},a2="svg",c2="math",u2=!1;function l2(){return u2}function di(n){for(;Array.isArray(n);)n=n[fi];return n}function d2(n,e){return di(e[n])}function xr(n,e){return di(e[n.index])}function aA(n,e){return n.data[e]}function cA(n,e){return n[e]}function Js(n,e){let t=e[n];return Hs(t)?t:t[fi]}function z_(n){return(n[le]&128)===128}function h2(n){return pi(n[en])}function af(n,e){return e==null?null:n[e]}function uA(n){n[ya]=0}function f2(n){n[le]&1024||(n[le]|=1024,z_(n)&&ku(n))}function p2(n,e){for(;n>0;)e=e[Aa],n--;return e}function G_(n){return!!(n[le]&9216||n[Ws]?.dirty)}function s_(n){n[Sr].changeDetectionScheduler?.notify(1),G_(n)?ku(n):n[le]&64&&(l2()?(n[le]|=1024,ku(n)):n[Sr].changeDetectionScheduler?.notify())}function ku(n){n[Sr].changeDetectionScheduler?.notify();let e=Ou(n);for(;e!==null&&!(e[le]&8192||(e[le]|=8192,!z_(e)));)e=Ou(e)}function lA(n,e){if((n[le]&256)===256)throw new se(911,!1);n[ji]===null&&(n[ji]=[]),n[ji].push(e)}function g2(n,e){if(n[ji]===null)return;let t=n[ji].indexOf(e);t!==-1&&n[ji].splice(t,1)}function Ou(n){let e=n[en];return pi(e)?e[en]:e}var Me={lFrame:vA(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function m2(){return Me.lFrame.elementDepthCount}function y2(){Me.lFrame.elementDepthCount++}function _2(){Me.lFrame.elementDepthCount--}function dA(){return Me.bindingsEnabled}function v2(){return Me.skipHydrationRootTNode!==null}function w2(n){return Me.skipHydrationRootTNode===n}function E2(){Me.skipHydrationRootTNode=null}function St(){return Me.lFrame.lView}function eo(){return Me.lFrame.tView}function Mr(){let n=hA();for(;n!==null&&n.type===64;)n=n.parent;return n}function hA(){return Me.lFrame.currentTNode}function I2(){let n=Me.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function $u(n,e){let t=Me.lFrame;t.currentTNode=n,t.isParent=e}function fA(){return Me.lFrame.isParent}function T2(){Me.lFrame.isParent=!1}function C2(){return Me.lFrame.contextLView}function pA(){let n=Me.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function D2(n){return Me.lFrame.bindingIndex=n}function gA(){return Me.lFrame.bindingIndex++}function b2(){return Me.lFrame.inI18n}function S2(n,e){let t=Me.lFrame;t.bindingIndex=t.bindingRootIndex=n,o_(e)}function A2(){return Me.lFrame.currentDirectiveIndex}function o_(n){Me.lFrame.currentDirectiveIndex=n}function mA(n){Me.lFrame.currentQueryIndex=n}function R2(n){let e=n[xe];return e.type===2?e.declTNode:e.type===1?n[lr]:null}function yA(n,e,t){if(t&Ce.SkipSelf){let i=e,s=n;for(;i=i.parent,i===null&&!(t&Ce.Host);)if(i=R2(s),i===null||(s=s[Aa],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=Me.lFrame=_A();return r.currentTNode=e,r.lView=n,!0}function W_(n){let e=_A(),t=n[xe];Me.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function _A(){let n=Me.lFrame,e=n===null?null:n.child;return e===null?vA(n):e}function vA(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function wA(){let n=Me.lFrame;return Me.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var EA=wA;function K_(){let n=wA();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function x2(n){return(Me.lFrame.contextLView=p2(n,Me.lFrame.contextLView))[li]}function Q_(){return Me.lFrame.selectedIndex}function Qs(n){Me.lFrame.selectedIndex=n}function M2(){let n=Me.lFrame;return aA(n.tView,n.selectedIndex)}function N2(){return Me.lFrame.currentNamespace}var IA=!0;function Y_(){return IA}function Z_(n){IA=n}function P2(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=iA(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function X_(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),l&&((n.viewHooks??=[]).push(t,l),(n.viewCheckHooks??=[]).push(t,l)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function Qh(n,e,t){TA(n,e,3,t)}function Yh(n,e,t,r){(n[le]&3)===t&&TA(n,e,t,r)}function qy(n,e){let t=n[le];(t&3)===e&&(t&=16383,t+=1,n[le]=t)}function TA(n,e,t,r){let i=r!==void 0?n[ya]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[ya]+=65536),(a<s||s==-1)&&(k2(n,t,e,c),n[ya]=(n[ya]&4294901760)+c+2),c++}function sS(n,e){Ui(4,n,e);let t=Ve(null);try{e.call(n)}finally{Ve(t),Ui(5,n,e)}}function k2(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[le]>>14<n[ya]>>16&&(n[le]&3)===e&&(n[le]+=16384,sS(a,s)):sS(a,s)}var Ea=-1,Fu=class{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function O2(n){return n instanceof Fu}function F2(n){return(n.flags&8)!==0}function L2(n){return(n.flags&16)!==0}function CA(n){return n!==Ea}function cf(n){return n&32767}function V2(n){return n>>16}function uf(n,e){let t=V2(n),r=e;for(;t>0;)r=r[Aa],t--;return r}var a_=!0;function lf(n){let e=a_;return a_=n,e}var U2=256,DA=U2-1,bA=5,j2=0,Dr={};function B2(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Au)&&(r=t[Au]),r==null&&(r=t[Au]=j2++);let i=r&DA,s=1<<i;e.data[n+(i>>bA)]|=s}function SA(n,e){let t=AA(n,e);if(t!==-1)return t;let r=e[xe];r.firstCreatePass&&(n.injectorIndex=e.length,Hy(r.data,n),Hy(e,null),Hy(r.blueprint,null));let i=J_(n,e),s=n.injectorIndex;if(CA(i)){let o=cf(i),a=uf(i,e),c=a[xe].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=i,s}function Hy(n,e){n.push(0,0,0,0,0,0,0,0,e)}function AA(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function J_(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=PA(i),r===null)return Ea;if(t++,i=i[Aa],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Ea}function $2(n,e,t){B2(n,e,t)}function RA(n,e,t){if(t&Ce.Optional||n!==void 0)return n;L_(e,"NodeInjector")}function xA(n,e,t,r){if(t&Ce.Optional&&r===void 0&&(r=null),!(t&(Ce.Self|Ce.Host))){let i=n[Ta],s=Tn(void 0);try{return i?i.get(e,r,t&Ce.Optional):FS(e,r,t&Ce.Optional)}finally{Tn(s)}}return RA(r,e,t)}function MA(n,e,t,r=Ce.Default,i){if(n!==null){if(e[le]&2048&&!(r&Ce.Self)){let o=W2(n,e,t,r,Dr);if(o!==Dr)return o}let s=NA(n,e,t,r,Dr);if(s!==Dr)return s}return xA(e,t,r,i)}function NA(n,e,t,r,i){let s=z2(t);if(typeof s=="function"){if(!yA(e,n,r))return r&Ce.Host?RA(i,t,r):xA(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&Ce.Optional))L_(t);else return o}finally{EA()}}else if(typeof s=="number"){let o=null,a=AA(n,e),c=Ea,l=r&Ce.Host?e[Ar][lr]:null;for((a===-1||r&Ce.SkipSelf)&&(c=a===-1?J_(n,e):e[a+8],c===Ea||!aS(r,!1)?a=-1:(o=e[xe],a=cf(c),e=uf(c,e)));a!==-1;){let d=e[xe];if(oS(s,a,d.data)){let f=q2(a,e,t,o,r,l);if(f!==Dr)return f}c=e[a+8],c!==Ea&&aS(r,e[xe].data[a+8]===l)&&oS(s,a,e)?(o=d,a=cf(c),e=uf(c,e)):a=-1}}return i}function q2(n,e,t,r,i,s){let o=e[xe],a=o.data[n+8],c=r==null?Sf(a)&&a_:r!=o&&(a.type&3)!==0,l=i&Ce.Host&&s===a,d=H2(a,o,t,c,l);return d!==null?Lu(e,o,d,a):Dr}function H2(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,l=n.directiveEnd,d=s>>20,f=r?a:a+d,g=i?a+d:l;for(let y=f;y<g;y++){let v=o[y];if(y<c&&t===v||y>=c&&v.type===t)return y}if(i){let y=o[c];if(y&&Bu(y)&&y.type===t)return c}return null}function Lu(n,e,t,r){let i=n[t],s=e.data;if(O2(i)){let o=i;o.resolving&&yV(mV(s[t]));let a=lf(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?Tn(o.injectImpl):null,d=yA(n,r,Ce.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&P2(t,s[t],e)}finally{l!==null&&Tn(l),lf(a),o.resolving=!1,EA()}}return i}function z2(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Au)?n[Au]:void 0;return typeof e=="number"?e>=0?e&DA:G2:e}function oS(n,e,t){let r=1<<n;return!!(t[e+(n>>bA)]&r)}function aS(n,e){return!(n&Ce.Self)&&!(n&Ce.Host&&e)}var zs=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return MA(this._tNode,this._lView,e,If(r),t)}};function G2(){return new zs(Mr(),St())}function ev(n){return ju(()=>{let e=n.prototype.constructor,t=e[Jh]||c_(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[Jh]||c_(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function c_(n){return RS(n)?()=>{let e=c_(Wn(n));return e&&e()}:Gs(n)}function W2(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[le]&2048&&!(o[le]&512);){let a=NA(s,o,t,r|Ce.Self,Dr);if(a!==Dr)return a;let c=s.parent;if(!c){let l=o[JS];if(l){let d=l.get(t,Dr,r);if(d!==Dr)return d}c=PA(o),o=o[Aa]}s=c}return i}function PA(n){let e=n[xe],t=e.type;return t===2?e.declTNode:t===1?n[lr]:null}function cS(n,e=null,t=null,r){let i=kA(n,e,t,r);return i.resolveInjectorInitializers(),i}function kA(n,e=null,t=null,r,i=new Set){let s=[t||Cr,qV(n)];return r=r||(typeof n=="object"?void 0:Cn(n)),new Nu(s,e||q_(),r||null,i)}var Nr=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return cS({name:""},i,r,"");{let s=r.name??"";return cS({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=xu,e.NULL=new nf,e.\u0275prov=J({token:e,providedIn:"any",factory:()=>F(US)}),e.__NG_ELEMENT_ID__=-1;let n=e;return n})();var K2="ngOriginalError";function zy(n){return n[K2]}var Rr=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&zy(e);for(;t&&zy(t);)t=zy(t);return t||null}},OA=new K("",{providedIn:"root",factory:()=>G(Rr).handleError.bind(void 0)}),tv=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=Q2,e.__NG_ENV_ID__=r=>r;let n=e;return n})(),u_=class extends tv{constructor(e){super(),this._lView=e}onDestroy(e){return lA(this._lView,e),()=>g2(this._lView,e)}};function Q2(){return new u_(St())}function Y2(){return Rf(Mr(),St())}function Rf(n,e){return new qu(xr(n,e))}var qu=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=Y2;let n=e;return n})();var l_=class extends yt{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,XS()&&(this.destroyRef=G(tv,{optional:!0})??void 0)}emit(e){let t=Ve(null);try{super.next(e)}finally{Ve(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=Gy(s),i&&(i=Gy(i)),o&&(o=Gy(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof mt&&e.add(a),a}};function Gy(n){return e=>{setTimeout(n,void 0,e)}}var un=l_;function FA(n){return(n.flags&128)===128}var LA=new Map,Z2=0;function X2(){return Z2++}function J2(n){LA.set(n[bf],n)}function eU(n){LA.delete(n[bf])}var uS="__ngContext__";function Ys(n,e){Hs(e)?(n[uS]=e[bf],J2(e)):n[uS]=e}function VA(n){return jA(n[Pu])}function UA(n){return jA(n[cr])}function jA(n){for(;n!==null&&!pi(n);)n=n[cr];return n}var d_;function BA(n){d_=n}function tU(){if(d_!==void 0)return d_;if(typeof document<"u")return document;throw new se(210,!1)}var xf=new K("",{providedIn:"root",factory:()=>nU}),nU="ng",nv=new K(""),jt=new K("",{providedIn:"platform",factory:()=>"unknown"});var rv=new K("",{providedIn:"root",factory:()=>tU().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var rU="h",iU="b";var sU=()=>null;function iv(n,e,t=!1){return sU(n,e,t)}var $A=!1,oU=new K("",{providedIn:"root",factory:()=>$A});function qA(n){return n instanceof Function?n():n}function aU(n){return(n??G(Nr)).get(jt)==="browser"}var zi=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(zi||{}),cU;function sv(n,e){return cU(n,e)}function _a(n,e,t,r,i){if(r!=null){let s,o=!1;pi(r)?s=r:Hs(r)&&(o=!0,r=r[fi]);let a=di(r);n===0&&t!==null?i==null?KA(e,t,a):df(e,t,a,i||null,!0):n===1&&t!==null?df(e,t,a,i||null,!0):n===2?DU(e,a,o):n===3&&e.destroyNode(a),s!=null&&SU(e,n,s,t,i)}}function uU(n,e){return n.createText(e)}function lU(n,e,t){n.setValue(e,t)}function HA(n,e,t){return n.createElement(e,t)}function dU(n,e){zA(n,e),e[fi]=null,e[lr]=null}function hU(n,e,t,r,i,s){r[fi]=i,r[lr]=e,Mf(n,r,t,1,i,s)}function zA(n,e){e[Sr].changeDetectionScheduler?.notify(1),Mf(n,e,e[bn],2,null,null)}function fU(n){let e=n[Pu];if(!e)return Wy(n[xe],n);for(;e;){let t=null;if(Hs(e))t=e[Pu];else{let r=e[Kn];r&&(t=r)}if(!t){for(;e&&!e[cr]&&e!==n;)Hs(e)&&Wy(e[xe],e),e=e[en];e===null&&(e=n),Hs(e)&&Wy(e[xe],e),t=e&&e[cr]}e=t}}function pU(n,e,t,r){let i=Kn+r,s=t.length;r>0&&(t[i-1][cr]=e),r<s-Kn?(e[cr]=t[i],VS(t,Kn+r,e)):(t.push(e),e[cr]=null),e[en]=t;let o=e[Df];o!==null&&t!==o&&gU(o,e);let a=e[Ca];a!==null&&a.insertView(n),s_(e),e[le]|=128}function gU(n,e){let t=n[of],i=e[en][en][Ar];e[Ar]!==i&&(n[le]|=H_.HasTransplantedViews),t===null?n[of]=[e]:t.push(e)}function GA(n,e){let t=n[of],r=t.indexOf(e);t.splice(r,1)}function h_(n,e){if(n.length<=Kn)return;let t=Kn+e,r=n[t];if(r){let i=r[Df];i!==null&&i!==n&&GA(i,r),e>0&&(n[t-1][cr]=r[cr]);let s=tf(n,Kn+e);dU(r[xe],r);let o=s[Ca];o!==null&&o.detachView(s[xe]),r[en]=null,r[cr]=null,r[le]&=-129}return r}function WA(n,e){if(!(e[le]&256)){let t=e[bn];t.destroyNode&&Mf(n,e,t,3,null,null),fU(e)}}function Wy(n,e){if(e[le]&256)return;let t=Ve(null);try{e[le]&=-129,e[le]|=256,e[Ws]&&Eb(e[Ws]),yU(n,e),mU(n,e),e[xe].type===1&&e[bn].destroy();let r=e[Df];if(r!==null&&pi(e[en])){r!==e[en]&&GA(r,e);let i=e[Ca];i!==null&&i.detachView(n)}eU(e)}finally{Ve(t)}}function mU(n,e){let t=n.cleanup,r=e[nS];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[t[s+1]];t[s].call(o)}r!==null&&(e[nS]=null);let i=e[ji];if(i!==null){e[ji]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function yU(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof Fu)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];Ui(4,a,c);try{c.call(a)}finally{Ui(5,a,c)}}else{Ui(4,i,s);try{s.call(i)}finally{Ui(5,i,s)}}}}}function _U(n,e,t){return vU(n,e.parent,t)}function vU(n,e,t){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return t[fi];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=n.data[r.directiveStart+i];if(s===br.None||s===br.Emulated)return null}return xr(r,t)}}function df(n,e,t,r,i){n.insertBefore(e,t,r,i)}function KA(n,e,t){n.appendChild(e,t)}function lS(n,e,t,r,i){r!==null?df(n,e,t,r,i):KA(n,e,t)}function wU(n,e,t,r){n.removeChild(e,t,r)}function ov(n,e){return n.parentNode(e)}function EU(n,e){return n.nextSibling(e)}function IU(n,e,t){return CU(n,e,t)}function TU(n,e,t){return n.type&40?xr(n,t):null}var CU=TU,dS;function av(n,e,t,r){let i=_U(n,r,e),s=e[bn],o=r.parent||e[lr],a=IU(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)lS(s,i,t[c],a,!1);else lS(s,i,t,a,!1);dS!==void 0&&dS(s,r,e,t,i)}function Zh(n,e){if(e!==null){let t=e.type;if(t&3)return xr(e,n);if(t&4)return f_(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Zh(n,r);{let i=n[e.index];return pi(i)?f_(-1,i):di(i)}}else{if(t&32)return sv(e,n)()||di(n[e.index]);{let r=QA(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Ou(n[Ar]);return Zh(i,r)}else return Zh(n,e.next)}}}return null}function QA(n,e){if(e!==null){let r=n[Ar][lr],i=e.projection;return r.projection[i]}return null}function f_(n,e){let t=Kn+n+1;if(t<e.length){let r=e[t],i=r[xe].firstChild;if(i!==null)return Zh(r,i)}return e[Ks]}function DU(n,e,t){let r=ov(n,e);r&&wU(n,r,e,t)}function cv(n,e,t,r,i,s,o){for(;t!=null;){let a=r[t.index],c=t.type;if(o&&e===0&&(a&&Ys(di(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)cv(n,e,t.child,r,i,s,!1),_a(e,n,i,a,s);else if(c&32){let l=sv(t,r),d;for(;d=l();)_a(e,n,i,d,s);_a(e,n,i,a,s)}else c&16?bU(n,e,r,t,i,s):_a(e,n,i,a,s);t=o?t.projectionNext:t.next}}function Mf(n,e,t,r,i,s){cv(t,r,n.firstChild,e,i,s,!1)}function bU(n,e,t,r,i,s){let o=t[Ar],c=o[lr].projection[r.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let d=c[l];_a(e,n,i,d,s)}else{let l=c,d=o[en];FA(r)&&(l.flags|=128),cv(n,e,l,d,i,s,!0)}}function SU(n,e,t,r,i){let s=t[Ks],o=di(t);s!==o&&_a(e,n,r,s,i);for(let a=Kn;a<t.length;a++){let c=t[a];Mf(c[xe],c,n,e,r,s)}}function AU(n,e,t){n.setAttribute(e,"style",t)}function YA(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function ZA(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&Jy(n,e,r),i!==null&&YA(n,e,i),s!==null&&AU(n,e,s)}var Hu={};function ln(n=1){XA(eo(),St(),Q_()+n,!1)}function XA(n,e,t,r){if(!r)if((e[le]&3)===3){let s=n.preOrderCheckHooks;s!==null&&Qh(e,s,t)}else{let s=n.preOrderHooks;s!==null&&Yh(e,s,0,t)}Qs(t)}function tn(n,e=Ce.Default){let t=St();if(t===null)return F(n,e);let r=Mr();return MA(r,t,Wn(n),e)}function JA(){let n="invalid";throw new Error(n)}function eR(n,e,t,r,i,s){let o=Ve(null);try{let a=null;i&Bi.SignalBased&&(a=e[r][yb]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&Bi.HasDecoratorInputTransform&&(s=n.inputTransforms[r].call(e,s)),n.setInput!==null?n.setInput(e,a,s,t,r):rA(e,a,r,s)}finally{Ve(o)}}function RU(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Qs(~i);else{let s=i,o=t[++r],a=t[++r];S2(o,s);let c=e[s];a(2,c)}}}finally{Qs(-1)}}function Nf(n,e,t,r,i,s,o,a,c,l,d){let f=e.blueprint.slice();return f[fi]=i,f[le]=r|4|128|8|64,(l!==null||n&&n[le]&2048)&&(f[le]|=2048),uA(f),f[en]=f[Aa]=n,f[li]=t,f[Sr]=o||n&&n[Sr],f[bn]=a||n&&n[bn],f[Ta]=c||n&&n[Ta]||null,f[lr]=s,f[bf]=X2(),f[rf]=d,f[JS]=l,f[Ar]=e.type==2?n[Ar]:f,f}function Pf(n,e,t,r,i){let s=n.data[e];if(s===null)s=xU(n,e,t,r,i),b2()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=I2();s.injectorIndex=o===null?-1:o.injectorIndex}return $u(s,!0),s}function xU(n,e,t,r,i){let s=hA(),o=fA(),a=o?s:s&&s.parent,c=n.data[e]=OU(n,a,t,e,r,i);return n.firstChild===null&&(n.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function tR(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function nR(n,e,t,r,i){let s=Q_(),o=r&2;try{Qs(-1),o&&e.length>ur&&XA(n,e,ur,!1),Ui(o?2:0,i),t(r,i)}finally{Qs(s),Ui(o?3:1,i)}}function rR(n,e,t){if(tA(e)){let r=Ve(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{Ve(r)}}}function iR(n,e,t){dA()&&($U(n,e,t,xr(t,e)),(t.flags&64)===64&&uR(n,e,t))}function sR(n,e,t=xr){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function oR(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=uv(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function uv(n,e,t,r,i,s,o,a,c,l,d){let f=ur+r,g=f+i,y=MU(f,g),v=typeof l=="function"?l():l;return y[xe]={type:n,blueprint:y,template:t,queries:null,viewQuery:a,declTNode:e,data:y.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:v,incompleteFirstPass:!1,ssrId:d}}function MU(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Hu);return t}function NU(n,e,t,r){let s=r.get(oU,$A)||t===br.ShadowDom,o=n.selectRootElement(e,s);return PU(o),o}function PU(n){kU(n)}var kU=()=>null;function OU(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return v2()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function hS(n,e,t,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=Bi.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(i!==null){if(!i.hasOwnProperty(s))continue;l=i[s]}n===0?fS(r,t,l,a,c):fS(r,t,l,a)}return r}function fS(n,e,t,r,i){let s;n.hasOwnProperty(t)?(s=n[t]).push(e,r):s=n[t]=[e,r],i!==void 0&&s.push(i)}function FU(n,e,t){let r=e.directiveStart,i=e.directiveEnd,s=n.data,o=e.attrs,a=[],c=null,l=null;for(let d=r;d<i;d++){let f=s[d],g=t?t.get(f):null,y=g?g.inputs:null,v=g?g.outputs:null;c=hS(0,f.inputs,d,c,y),l=hS(1,f.outputs,d,l,v);let b=c!==null&&o!==null&&!j_(e)?ZU(c,d,o):null;a.push(b)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function LU(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function VU(n,e,t,r,i,s,o,a){let c=xr(e,t),l=e.inputs,d;!a&&l!=null&&(d=l[r])?(lv(n,t,d,r,i),Sf(e)&&UU(t,e.index)):e.type&3?(r=LU(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function UU(n,e){let t=Js(e,n);t[le]&16||(t[le]|=64)}function aR(n,e,t,r){if(dA()){let i=r===null?null:{"":-1},s=HU(n,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&cR(n,e,t,o,i,a),i&&zU(t,r,i)}t.mergedAttrs=U_(t.mergedAttrs,t.attrs)}function cR(n,e,t,r,i,s){for(let l=0;l<r.length;l++)$2(SA(t,e),n,r[l].type);WU(t,n.data.length,r.length);for(let l=0;l<r.length;l++){let d=r[l];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,c=tR(n,e,r.length,null);for(let l=0;l<r.length;l++){let d=r[l];t.mergedAttrs=U_(t.mergedAttrs,d.hostAttrs),KU(n,t,e,c,d),GU(c,d,i),d.contentQueries!==null&&(t.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(t.flags|=64);let f=d.type.prototype;!o&&(f.ngOnChanges||f.ngOnInit||f.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(f.ngOnChanges||f.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}FU(n,t,s)}function jU(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;BU(o)!=a&&o.push(a),o.push(t,r,s)}}function BU(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function $U(n,e,t,r){let i=t.directiveStart,s=t.directiveEnd;Sf(t)&&QU(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||SA(t,e),Ys(r,e);let o=t.initialInputs;for(let a=i;a<s;a++){let c=n.data[a],l=Lu(e,n,a,t);if(Ys(l,e),o!==null&&YU(e,a-i,l,c,t,o),Bu(c)){let d=Js(t.index,e);d[li]=Lu(e,n,a,t)}}}function uR(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=A2();try{Qs(s);for(let a=r;a<i;a++){let c=n.data[a],l=e[a];o_(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&qU(c,l)}}finally{Qs(-1),o_(o)}}function qU(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function HU(n,e){let t=n.directiveRegistry,r=null,i=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(kV(e,o.selectors,!1))if(r||(r=[]),Bu(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;p_(n,e,c)}else r.unshift(o),p_(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function p_(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function zU(n,e,t){if(e){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new se(-301,!1);r.push(e[i],s)}}}function GU(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;Bu(e)&&(t[""]=n)}}function WU(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function KU(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=Gs(i.type,!0)),o=new Fu(s,Bu(i),tn);n.blueprint[r]=o,t[r]=o,jU(n,e,r,tR(n,t,i.hostVars,Hu),i)}function QU(n,e,t){let r=xr(e,n),i=oR(t),s=n[Sr].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=kf(n,Nf(n,i,null,o,r,e,null,s.createRenderer(r,t),null,null,null));n[e.index]=a}function YU(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],d=o[a++],f=o[a++];eR(r,t,c,l,d,f)}}function ZU(n,e,t){let r=null,i=0;for(;i<t.length;){let s=t[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(n.hasOwnProperty(s)){r===null&&(r=[]);let o=n[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],t[i+1]);break}}i+=2}return r}function lR(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function dR(n,e){let t=n.contentQueries;if(t!==null){let r=Ve(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];mA(s),a.contentQueries(2,e[o],o)}}}finally{Ve(r)}}}function kf(n,e){return n[Pu]?n[rS][cr]=e:n[Pu]=e,n[rS]=e,e}function g_(n,e,t){mA(0);let r=Ve(null);try{e(n,t)}finally{Ve(r)}}function XU(n,e){let t=n[Ta],r=t?t.get(Rr,null):null;r&&r.handleError(e)}function lv(n,e,t,r,i){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],l=e[o],d=n.data[o];eR(d,l,r,a,c,i)}}function JU(n,e,t){let r=d2(e,n);lU(n[bn],r,t)}function ej(n,e){let t=Js(e,n),r=t[xe];tj(r,t);let i=t[fi];i!==null&&t[rf]===null&&(t[rf]=iv(i,t[Ta])),dv(r,t,t[li])}function tj(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function dv(n,e,t){W_(e);try{let r=n.viewQuery;r!==null&&g_(1,r,t);let i=n.template;i!==null&&nR(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[Ca]?.finishViewCreation(n),n.staticContentQueries&&dR(n,e),n.staticViewQueries&&g_(2,n.viewQuery,t);let s=n.components;s!==null&&nj(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[le]&=-5,K_()}}function nj(n,e){for(let t=0;t<e.length;t++)ej(n,e[t])}function rj(n,e,t,r){let i=Ve(null);try{let s=e.tView,a=n[le]&4096?4096:16,c=Nf(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=n[e.index];c[Df]=l;let d=n[Ca];return d!==null&&(c[Ca]=d.createEmbeddedView(s)),dv(s,c,t),c}finally{Ve(i)}}function pS(n,e){return!e||e.firstChild===null||FA(n)}function ij(n,e,t,r=!0){let i=e[xe];if(pU(i,e,n,t),r){let o=f_(t,n),a=e[bn],c=ov(a,n[Ks]);c!==null&&hU(i,n[lr],a,e,c,o)}let s=e[rf];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function hf(n,e,t,r,i=!1){for(;t!==null;){let s=e[t.index];s!==null&&r.push(di(s)),pi(s)&&sj(s,r);let o=t.type;if(o&8)hf(n,e,t.child,r);else if(o&32){let a=sv(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=QA(e,t);if(Array.isArray(a))r.push(...a);else{let c=Ou(e[Ar]);hf(c[xe],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function sj(n,e){for(let t=Kn;t<n.length;t++){let r=n[t],i=r[xe].firstChild;i!==null&&hf(r[xe],r,i,e)}n[Ks]!==n[fi]&&e.push(n[Ks])}var hR=[];function oj(n){return n[Ws]??aj(n)}function aj(n){let e=hR.pop()??Object.create(uj);return e.lView=n,e}function cj(n){n.lView[Ws]!==n&&(n.lView=null,hR.push(n))}var uj=Je(Q({},_b),{consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{ku(n.lView)},consumerOnSignalRead(){this.lView[Ws]=this}}),fR=100;function pR(n,e=!0,t=0){let r=n[Sr],i=r.rendererFactory,s=!1;s||i.begin?.();try{lj(n,t)}catch(o){throw e&&XU(n,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function lj(n,e){m_(n,e);let t=0;for(;G_(n);){if(t===fR)throw new se(103,!1);t++,m_(n,1)}}function dj(n,e,t,r){let i=e[le];if((i&256)===256)return;let s=!1;!s&&e[Sr].inlineEffectRunner?.flush(),W_(e);let o=null,a=null;!s&&hj(n)&&(a=oj(e),o=vb(a));try{uA(e),D2(n.bindingStartIndex),t!==null&&nR(n,e,t,2,r);let c=(i&3)===3;if(!s)if(c){let f=n.preOrderCheckHooks;f!==null&&Qh(e,f,null)}else{let f=n.preOrderHooks;f!==null&&Yh(e,f,0,null),qy(e,0)}if(fj(e),gR(e,0),n.contentQueries!==null&&dR(n,e),!s)if(c){let f=n.contentCheckHooks;f!==null&&Qh(e,f)}else{let f=n.contentHooks;f!==null&&Yh(e,f,1),qy(e,1)}RU(n,e);let l=n.components;l!==null&&yR(e,l,0);let d=n.viewQuery;if(d!==null&&g_(2,d,r),!s)if(c){let f=n.viewCheckHooks;f!==null&&Qh(e,f)}else{let f=n.viewHooks;f!==null&&Yh(e,f,2),qy(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[$y]){for(let f of e[$y])f();e[$y]=null}s||(e[le]&=-73)}catch(c){throw ku(e),c}finally{a!==null&&(wb(a,o),cj(a)),K_()}}function hj(n){return n.type!==2}function gR(n,e){for(let t=VA(n);t!==null;t=UA(t))for(let r=Kn;r<t.length;r++){let i=t[r];mR(i,e)}}function fj(n){for(let e=VA(n);e!==null;e=UA(e)){if(!(e[le]&H_.HasTransplantedViews))continue;let t=e[of];for(let r=0;r<t.length;r++){let i=t[r],s=i[en];f2(i)}}}function pj(n,e,t){let r=Js(e,n);mR(r,t)}function mR(n,e){z_(n)&&m_(n,e)}function m_(n,e){let r=n[xe],i=n[le],s=n[Ws],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&vy(s)),s&&(s.dirty=!1),n[le]&=-9217,o)dj(r,n,r.template,n[li]);else if(i&8192){gR(n,1);let a=r.components;a!==null&&yR(n,a,1)}}function yR(n,e,t){for(let r=0;r<e.length;r++)pj(n,e[r],t)}function _R(n){for(n[Sr].changeDetectionScheduler?.notify();n;){n[le]|=64;let e=Ou(n);if(r2(n)&&!e)return n;n=e}return null}var Zs=class{get rootNodes(){let e=this._lView,t=e[xe];return hf(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[li]}set context(e){this._lView[li]=e}get destroyed(){return(this._lView[le]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[en];if(pi(e)){let t=e[sf],r=t?t.indexOf(this):-1;r>-1&&(h_(e,r),tf(t,r))}this._attachedToViewContainer=!1}WA(this._lView[xe],this._lView)}onDestroy(e){lA(this._lView,e)}markForCheck(){_R(this._cdRefInjectingView||this._lView)}detach(){this._lView[le]&=-129}reattach(){s_(this._lView),this._lView[le]|=128}detectChanges(){this._lView[le]|=1024,pR(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new se(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,zA(this._lView[xe],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new se(902,!1);this._appRef=e,s_(this._lView)}},Of=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=yj;let n=e;return n})(),gj=Of,mj=class extends gj{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=rj(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new Zs(i)}};function yj(){return vR(Mr(),St())}function vR(n,e){return n.type&4?new mj(e,n,Rf(n,e)):null}var rX=new RegExp(`^(\\d+)*(${iU}|${rU})*(.*)`);var _j=()=>null;function gS(n,e){return _j(n,e)}var ff=class{},y_=class{},pf=class{};function vj(n){let e=Error(`No component factory found for ${Cn(n)}.`);return e[wj]=n,e}var wj="ngComponent";var __=class{resolveComponentFactory(e){throw vj(e)}},Ff=(()=>{let e=class e{};e.NULL=new __;let n=e;return n})(),Vu=class{},Lf=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>Ej();let n=e;return n})();function Ej(){let n=St(),e=Mr(),t=Js(e.index,n);return(Hs(t)?t:n)[bn]}var Ij=(()=>{let e=class e{};e.\u0275prov=J({token:e,providedIn:"root",factory:()=>null});let n=e;return n})(),Ky={};var mS=new Set;function hv(n){mS.has(n)||(mS.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}function yS(...n){}function Tj(){let n=typeof Nn.requestAnimationFrame=="function",e=Nn[n?"requestAnimationFrame":"setTimeout"],t=Nn[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var De=class n{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new un(!1),this.onMicrotaskEmpty=new un(!1),this.onStable=new un(!1),this.onError=new un(!1),typeof Zone>"u")throw new se(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=Tj().nativeRequestAnimationFrame,bj(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new se(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new se(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,Cj,yS,yS);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},Cj={};function fv(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Dj(n){n.isCheckStableRunning||n.lastRequestAnimationFrameId!==-1||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Nn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,v_(n),n.isCheckStableRunning=!0,fv(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),v_(n))}function bj(n){let e=()=>{Dj(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(Sj(a))return t.invokeTask(i,s,o,a);try{return _S(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),vS(n)}},onInvoke:(t,r,i,s,o,a,c)=>{try{return _S(n),t.invoke(i,s,o,a,c)}finally{n.shouldCoalesceRunChangeDetection&&e(),vS(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,v_(n),fv(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function v_(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.lastRequestAnimationFrameId!==-1?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function _S(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function vS(n){n._nesting--,fv(n)}var w_=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new un,this.onMicrotaskEmpty=new un,this.onStable=new un,this.onError=new un}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function Sj(n){return!Array.isArray(n)||n.length!==1?!1:n[0].data?.__ignore_ng_zone__===!0}function Aj(n="zone.js",e){return n==="noop"?new w_:n==="zone.js"?new De(e):n}var va=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(va||{}),Rj={destroy(){}};function Vf(n,e){!e&&e2(Vf);let t=e?.injector??G(Nr);if(!aU(t))return Rj;hv("NgAfterNextRender");let r=t.get(pv),i=r.handler??=new I_,s=e?.phase??va.MixedReadWrite,o=()=>{i.unregister(c),a()},a=t.get(tv).onDestroy(o),c=hi(t,()=>new E_(s,()=>{o(),n()}));return i.register(c),{destroy:o}}var E_=class{constructor(e,t){this.phase=e,this.callbackFn=t,this.zone=G(De),this.errorHandler=G(Rr,{optional:!0}),G(ff,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},I_=class{constructor(){this.executingCallbacks=!1,this.buckets={[va.EarlyRead]:new Set,[va.Write]:new Set,[va.MixedReadWrite]:new Set,[va.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let t of e)t.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},pv=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=J({token:e,providedIn:"root",factory:()=>new e});let n=e;return n})();function T_(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=Gb(i,a);else if(s==2){let c=a,l=e[++o];r=Gb(r,c+": "+l+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}var gf=class extends Ff{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=$i(e);return new Da(t,this.ngModule)}};function wS(n){let e=[];for(let t in n){if(!n.hasOwnProperty(t))continue;let r=n[t];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:t})}return e}function xj(n){let e=n.toLowerCase();return e==="svg"?a2:e==="math"?c2:null}var C_=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=If(r);let i=this.injector.get(e,Ky,r);return i!==Ky||t===Ky?i:this.parentInjector.get(e,t,r)}},Da=class extends pf{get inputs(){let e=this.componentDef,t=e.inputTransforms,r=wS(e.inputs);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return wS(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=VV(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=Ve(null);try{i=i||this.ngModule;let o=i instanceof Dn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new C_(e,o):e,c=a.get(Vu,null);if(c===null)throw new se(407,!1);let l=a.get(Ij,null),d=a.get(pv,null),f=a.get(ff,null),g={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:d,changeDetectionScheduler:f},y=c.createRenderer(null,this.componentDef),v=this.componentDef.selectors[0][0]||"div",b=r?NU(y,r,this.componentDef.encapsulation,a):HA(y,v,xj(v)),C=512;this.componentDef.signals?C|=4096:this.componentDef.onPush||(C|=16);let V=null;b!==null&&(V=iv(b,a,!0));let B=uv(0,null,null,1,0,null,null,null,null,null,null),O=Nf(null,B,null,C,null,null,g,y,a,null,V);W_(O);let z,re;try{let Z=this.componentDef,I,_=null;Z.findHostDirectiveDefs?(I=[],_=new Map,Z.findHostDirectiveDefs(Z,I,_),I.push(Z)):I=[Z];let w=Mj(O,b),T=Nj(w,b,Z,I,O,g,y);re=aA(B,ur),b&&Oj(y,Z,b,r),t!==void 0&&Fj(re,this.ngContentSelectors,t),z=kj(T,Z,I,_,O,[Lj]),dv(B,O,null)}finally{K_()}return new D_(this.componentType,z,Rf(re,O),O,re)}finally{Ve(s)}}},D_=class extends y_{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new Zs(i,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;lv(s[xe],s,i,e,t),this.previousInputValues.set(e,t);let o=Js(this._tNode.index,s);_R(o)}}get injector(){return new zs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function Mj(n,e){let t=n[xe],r=ur;return n[r]=e,Pf(t,r,2,"#host",null)}function Nj(n,e,t,r,i,s,o){let a=i[xe];Pj(r,n,e,o);let c=null;e!==null&&(c=iv(e,i[Ta]));let l=s.rendererFactory.createRenderer(e,t),d=16;t.signals?d=4096:t.onPush&&(d=64);let f=Nf(i,oR(t),null,d,i[n.index],n,s,l,null,null,c);return a.firstCreatePass&&p_(a,n,r.length-1),kf(i,f),i[n.index]=f}function Pj(n,e,t,r){for(let i of n)e.mergedAttrs=U_(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(T_(e,e.mergedAttrs,!0),t!==null&&ZA(r,t,e))}function kj(n,e,t,r,i,s){let o=Mr(),a=i[xe],c=xr(o,i);cR(a,i,o,t,null,r);for(let d=0;d<t.length;d++){let f=o.directiveStart+d,g=Lu(i,a,f,o);Ys(g,i)}uR(a,i,o),c&&Ys(c,i);let l=Lu(i,a,o.directiveStart+o.componentOffset,o);if(n[li]=i[li]=l,s!==null)for(let d of s)d(l,e);return rR(a,o,i),l}function Oj(n,e,t,r){if(r)Jy(n,t,["ng-version","17.3.12"]);else{let{attrs:i,classes:s}=UV(e.selectors[0]);i&&Jy(n,t,i),s&&s.length>0&&YA(n,t,s.join(" "))}}function Fj(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null?Array.from(s):null)}}function Lj(){let n=Mr();X_(St()[xe],n)}var Ra=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=Vj;let n=e;return n})();function Vj(){let n=Mr();return jj(n,St())}var Uj=Ra,wR=class extends Uj{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Rf(this._hostTNode,this._hostLView)}get injector(){return new zs(this._hostTNode,this._hostLView)}get parentInjector(){let e=J_(this._hostTNode,this._hostLView);if(CA(e)){let t=uf(e,this._hostLView),r=cf(e),i=t[xe].data[r+8];return new zs(i,t)}else return new zs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=ES(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Kn}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=gS(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,pS(this._hostTNode,o)),a}createComponent(e,t,r,i,s){let o=e&&!n2(e),a;if(o)a=t;else{let v=t||{};a=v.index,r=v.injector,i=v.projectableNodes,s=v.environmentInjector||v.ngModuleRef}let c=o?e:new Da($i(e)),l=r||this.parentInjector;if(!s&&c.ngModule==null){let b=(o?l:this.parentInjector).get(Dn,null);b&&(s=b)}let d=$i(c.componentType??{}),f=gS(this._lContainer,d?.id??null),g=f?.firstChild??null,y=c.create(l,i,g,s);return this.insertImpl(y.hostView,a,pS(this._hostTNode,f)),y}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(h2(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[en],l=new wR(c,c[lr],c[en]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return ij(o,i,s,r),e.attachToViewContainerRef(),VS(Qy(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=ES(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=h_(this._lContainer,t);r&&(tf(Qy(this._lContainer),t),WA(r[xe],r))}detach(e){let t=this._adjustIndex(e,-1),r=h_(this._lContainer,t);return r&&tf(Qy(this._lContainer),t)!=null?new Zs(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function ES(n){return n[sf]}function Qy(n){return n[sf]||(n[sf]=[])}function jj(n,e){let t,r=e[n.index];return pi(r)?t=r:(t=lR(r,e,null,n),e[n.index]=t,kf(e,t)),$j(t,e,n,r),new wR(t,n,e)}function Bj(n,e){let t=n[bn],r=t.createComment(""),i=xr(e,n),s=ov(t,i);return df(t,s,r,EU(t,i),!1),r}var $j=zj,qj=()=>!1;function Hj(n,e,t){return qj(n,e,t)}function zj(n,e,t,r){if(n[Ks])return;let i;t.type&8?i=di(r):i=Bj(e,t),n[Ks]=i}function Gj(n){let e=[],t=new Map;function r(i){let s=t.get(i);if(!s){let o=n(i);t.set(i,s=o.then(Yj))}return s}return mf.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(l=>{i.template=l}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let l=i.styles.length,d=i.styleUrls;i.styleUrls.forEach((f,g)=>{a.push(""),o.push(r(f).then(y=>{a[l+g]=y,d.splice(d.indexOf(f),1),d.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(l=>{a.push(l),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>Zj(s));e.push(c)}),Kj(),Promise.all(e).then(()=>{})}var mf=new Map,Wj=new Set;function Kj(){let n=mf;return mf=new Map,n}function Qj(){return mf.size===0}function Yj(n){return typeof n=="string"?n:n.text()}function Zj(n){Wj.delete(n)}var qi=class{},Uu=class{};var yf=class extends qi{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new gf(this);let i=GS(e);this._bootstrapComponents=qA(i.bootstrap),this._r3Injector=kA(e,t,[{provide:qi,useValue:this},{provide:Ff,useValue:this.componentFactoryResolver},...r],Cn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},_f=class extends Uu{constructor(e){super(),this.moduleType=e}create(e){return new yf(this.moduleType,e,[])}};function Xj(n,e,t){return new yf(n,e,t)}var b_=class extends qi{constructor(e){super(),this.componentFactoryResolver=new gf(this),this.instance=null;let t=new Nu([...e.providers,{provide:qi,useValue:this},{provide:Ff,useValue:this.componentFactoryResolver}],e.parent||q_(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Uf(n,e,t=null){return new b_({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var jf=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Kt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function ER(n){return gv(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function Jj(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function gv(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function eB(n,e,t){return n[e]=t}function mv(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function tB(n){return(n.flags&32)===32}function nB(n,e,t,r,i,s,o,a,c){let l=e.consts,d=Pf(e,n,4,o||null,af(l,a));aR(e,t,d,af(l,c)),X_(e,d);let f=d.tView=uv(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,d),f.queries=e.queries.embeddedTView(d)),d}function to(n,e,t,r,i,s,o,a){let c=St(),l=eo(),d=n+ur,f=l.firstCreatePass?nB(d,l,c,e,t,r,i,s,o):l.data[d];$u(f,!1);let g=rB(l,c,f,n);Y_()&&av(l,c,g,f),Ys(g,c);let y=lR(g,c,g,f);return c[d]=y,kf(c,y),Hj(y,f,c),nA(f)&&iR(l,c,f),o!=null&&sR(c,f,a),to}var rB=iB;function iB(n,e,t,r){return Z_(!0),e[bn].createComment("")}function sB(n,e,t,r){return mv(n,gA(),t)?e+kS(t)+r:Hu}function Gi(n,e,t){let r=St(),i=gA();if(mv(r,i,e)){let s=eo(),o=M2();VU(s,o,r,n,e,r[bn],t,!1)}return Gi}function IS(n,e,t,r,i){let s=e.inputs,o=i?"class":"style";lv(n,t,s[o],o,r)}function oB(n,e,t,r,i,s){let o=e.consts,a=af(o,i),c=Pf(e,n,2,r,a);return aR(e,t,c,af(o,s)),c.attrs!==null&&T_(c,c.attrs,!1),c.mergedAttrs!==null&&T_(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function rt(n,e,t,r){let i=St(),s=eo(),o=ur+n,a=i[bn],c=s.firstCreatePass?oB(o,s,i,e,t,r):s.data[o],l=aB(s,i,c,a,e,n);i[o]=l;let d=nA(c);return $u(c,!0),ZA(a,l,c),!tB(c)&&Y_()&&av(s,i,l,c),m2()===0&&Ys(l,i),y2(),d&&(iR(s,i,c),rR(s,c,i)),r!==null&&sR(i,c),rt}function tt(){let n=Mr();fA()?T2():(n=n.parent,$u(n,!1));let e=n;w2(e)&&E2(),_2();let t=eo();return t.firstCreatePass&&(X_(t,n),tA(n)&&t.queries.elementEnd(n)),e.classesWithoutHost!=null&&F2(e)&&IS(t,e,St(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&L2(e)&&IS(t,e,St(),e.stylesWithoutHost,!1),tt}function zu(n,e,t,r){return rt(n,e,t,r),tt(),zu}var aB=(n,e,t,r,i,s)=>(Z_(!0),HA(r,i,N2()));var vf="en-US";var cB=vf;function uB(n){typeof n=="string"&&(cB=n.toLowerCase().replace(/_/g,"-"))}function yv(n=1){return x2(n)}function lB(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function IR(n){let e=C2();return cA(e,ur+n)}function kt(n,e=""){let t=St(),r=eo(),i=n+ur,s=r.firstCreatePass?Pf(r,i,1,e,null):r.data[i],o=dB(r,t,s,e,n);t[i]=o,Y_()&&av(r,t,o,s),$u(s,!1)}var dB=(n,e,t,r,i)=>(Z_(!0),uU(e[bn],r));function Pr(n){return Bf("",n,""),Pr}function Bf(n,e,t){let r=St(),i=sB(r,n,e,t);return i!==Hu&&JU(r,Q_(),i),Bf}var hB=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=QS(!1,r.type),s=i.length>0?Uf([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=J({token:e,providedIn:"environment",factory:()=>new e(F(Dn))});let n=e;return n})();function TR(n){hv("NgStandalone"),n.getStandaloneInjector=e=>e.get(hB).getOrCreateStandaloneInjector(n)}function CR(n,e,t,r){return DR(St(),pA(),n,e,t,r)}function fB(n,e){let t=n[e];return t===Hu?void 0:t}function DR(n,e,t,r,i,s){let o=e+t;return mv(n,o,i)?eB(n,o+1,s?r.call(s,i):r(i)):fB(n,o+1)}function _v(n,e){let t=eo(),r,i=n+ur;t.firstCreatePass?(r=pB(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let s=r.factory||(r.factory=Gs(r.type,!0)),o,a=Tn(tn);try{let c=lf(!1),l=s();return lf(c),lB(t,St(),i,l),l}finally{Tn(a)}}function pB(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function vv(n,e,t){let r=n+ur,i=St(),s=cA(i,r);return gB(i,r)?DR(i,pA(),e,s.transform,t,s):s.transform(t)}function gB(n,e){return n[xe].data[e].pure}function bR(n,e){return vR(n,e)}var Wh=null;function mB(n){Wh!==null&&(n.defaultEncapsulation!==Wh.defaultEncapsulation||n.preserveWhitespaces!==Wh.preserveWhitespaces)||(Wh=n)}var Hi=class{constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},SR=new Hi("17.3.12"),$f=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();var wv=new K(""),Gu=new K(""),qf=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,Ev||(yB(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{De.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(F(De),F(Hf),F(Gu))},e.\u0275prov=J({token:e,factory:e.\u0275fac});let n=e;return n})(),Hf=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return Ev?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})();function yB(n){Ev=n}var Ev;function xa(n){return!!n&&typeof n.then=="function"}function Iv(n){return!!n&&typeof n.subscribe=="function"}var zf=new K(""),AR=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=G(zf,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(xa(o))r.push(o);else if(Iv(o)){let a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Tv=new K("");function _B(){Ib(()=>{throw new se(600,!1)})}function vB(n){return n.isBoundToModule}function wB(n,e,t){try{let r=t();return xa(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}function RR(n,e){return Array.isArray(e)?e.reduce(RR,n):Q(Q({},n),e)}var Ma=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=G(OA),this.afterRenderEffectManager=G(pv),this.externalTestViews=new Set,this.beforeRender=new yt,this.afterTick=new yt,this.componentTypes=[],this.components=[],this.isStable=G(jf).hasPendingTasks.pipe(ee(r=>!r)),this._injector=G(Dn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof pf;if(!this._injector.get(AR).done){let y=!s&&zS(r),v=!1;throw new se(405,v)}let a;s?a=r:a=this._injector.get(Ff).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=vB(a)?void 0:this._injector.get(qi),l=i||a.selector,d=a.create(Nr.NULL,[],l,c),f=d.location.nativeElement,g=d.injector.get(wv,null);return g?.registerApplication(f),d.onDestroy(()=>{this.detachView(d.hostView),Xh(this.components,d),g?.unregisterApplication(f)}),this._loadComponent(d),d}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new se(101,!1);let i=Ve(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,Ve(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===fR)throw new se(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)EB(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>S_(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>S_(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;Xh(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(Tv,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>Xh(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new se(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Xh(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function EB(n,e,t){!e&&!S_(n)||IB(n,t,e)}function S_(n){return G_(n)}function IB(n,e,t){let r;t?(r=0,n[le]|=1024):n[le]&64?r=0:r=1,pR(n,e,r)}var A_=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},Gf=(()=>{let e=class e{compileModuleSync(r){return new _f(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=GS(r),o=qA(s.declarations).reduce((a,c)=>{let l=$i(c);return l&&a.push(new Da(l)),a},[]);return new A_(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),TB=new K("");function CB(n,e,t){let r=new _f(t);return Promise.resolve(r)}function TS(n){for(let e=n.length-1;e>=0;e--)if(n[e]!==void 0)return n[e]}var DB=(()=>{let e=class e{constructor(){this.zone=G(De),this.applicationRef=G(Ma)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function bB(n){return[{provide:De,useFactory:n},{provide:Ia,multi:!0,useFactory:()=>{let e=G(DB,{optional:!0});return()=>e.initialize()}},{provide:Ia,multi:!0,useFactory:()=>{let e=G(RB);return()=>{e.initialize()}}},{provide:OA,useFactory:SB}]}function SB(){let n=G(De),e=G(Rr);return t=>n.runOutsideAngular(()=>e.handleError(t))}function AB(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var RB=(()=>{let e=class e{constructor(){this.subscription=new mt,this.initialized=!1,this.zone=G(De),this.pendingTasks=G(jf)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{De.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{De.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function xB(){return typeof $localize<"u"&&$localize.locale||vf}var Cv=new K("",{providedIn:"root",factory:()=>G(Cv,Ce.Optional|Ce.SkipSelf)||xB()});var xR=new K(""),MR=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=Aj(i?.ngZone,AB({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=Xj(r.moduleType,this.injector,bB(()=>s)),a=o.injector.get(Rr,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:l=>{a.handleError(l)}});o.onDestroy(()=>{Xh(this._modules,o),c.unsubscribe()})}),wB(a,s,()=>{let c=o.injector.get(AR);return c.runInitializers(),c.donePromise.then(()=>{let l=o.injector.get(Cv,vf);return uB(l||vf),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=RR({},i);return CB(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(Ma);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new se(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new se(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(xR,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(F(Nr))},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"platform"});let n=e;return n})(),Ru=null,NR=new K("");function MB(n){if(Ru&&!Ru.get(NR,!1))throw new se(400,!1);_B(),Ru=n;let e=n.get(MR);return kB(n),e}function Dv(n,e,t=[]){let r=`Platform: ${e}`,i=new K(r);return(s=[])=>{let o=PR();if(!o||o.injector.get(NR,!1)){let a=[...t,...s,{provide:i,useValue:!0}];n?n(a):MB(NB(a,r))}return PB(i)}}function NB(n=[],e){return Nr.create({name:e,providers:[{provide:Cf,useValue:"platform"},{provide:xR,useValue:new Set([()=>Ru=null])},...n]})}function PB(n){let e=PR();if(!e)throw new se(401,!1);return e}function PR(){return Ru?.get(MR)??null}function kB(n){n.get(nv,null)?.forEach(t=>t())}function bv(){return!1}var no=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=OB;let n=e;return n})();function OB(n){return FB(Mr(),St(),(n&16)===16)}function FB(n,e,t){if(Sf(n)&&!t){let r=Js(n.index,e);return new Zs(r,r)}else if(n.type&47){let r=e[Ar];return new Zs(r,e)}return null}var R_=class{constructor(){}supports(e){return ER(e)}create(e){return new x_(e)}},LB=(n,e)=>e,x_=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||LB}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){let o=!r||t&&t.currentIndex<CS(r,i,s)?t:r,a=CS(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,o.previousIndex==null)i++;else{s||(s=[]);let l=a-i,d=c-i;if(l!=d){for(let g=0;g<l;g++){let y=g<s.length?s[g]:s[g]=0,v=y+g;d<=v&&v<l&&(s[g]=y+1)}let f=o.previousIndex;s[f]=d-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!ER(e))throw new se(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),r=!0):(r&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else i=0,Jj(e,a=>{o=this._trackByFn(i,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new M_(t,r),s,i)),e}_verifyReinsertion(e,t,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new wf),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new wf),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},M_=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},N_=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},wf=class{constructor(){this.map=new Map}put(e){let t=e.trackById,r=this.map.get(t);r||(r=new N_,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function CS(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}var P_=class{constructor(){}supports(e){return e instanceof Map||gv(e)}create(){return new k_}},k_=class{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return this._additionsHead!==null||this._changesHead!==null||this._removalsHead!==null}forEachItem(e){let t;for(t=this._mapHead;t!==null;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;t!==null;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;t!==null;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}diff(e){if(!e)e=new Map;else if(!(e instanceof Map||gv(e)))throw new se(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(r,i)=>{if(t&&t.key===i)this._maybeAddToChanges(t,r),this._appendAfter=t,t=t._next;else{let s=this._getOrCreateRecordForKey(i,r);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let r=t;r!==null;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){let r=e._prev;return t._next=e,t._prev=r,e._prev=t,r&&(r._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){let i=this._records.get(e);this._maybeAddToChanges(i,t);let s=i._prev,o=i._next;return s&&(s._next=o),o&&(o._prev=s),i._next=null,i._prev=null,i}let r=new O_(e);return this._records.set(e,r),r.currentValue=t,this._addToAdditions(r),r}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;e!==null;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;e!=null;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){this._additionsHead===null?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){this._changesHead===null?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(r=>t(e[r],r))}},O_=class{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}};function DS(){return new Sv([new R_])}var Sv=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||DS()),deps:[[e,new Tf,new Xs]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new se(901,!1)}};e.\u0275prov=J({token:e,providedIn:"root",factory:DS});let n=e;return n})();function bS(){return new Av([new P_])}var Av=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||bS()),deps:[[e,new Tf,new Xs]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i)return i;throw new se(901,!1)}};e.\u0275prov=J({token:e,providedIn:"root",factory:bS});let n=e;return n})();var kR=Dv(null,"core",[]),OR=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(F(Ma))},e.\u0275mod=vt({type:e}),e.\u0275inj=_t({});let n=e;return n})();function Rv(n){let e=Ve(null);try{return n()}finally{Ve(e)}}function FR(n){let e=$i(n);if(!e)return null;let t=new Da(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var BR=null;function ro(){return BR}function $R(n){BR??=n}var Wf=class{};var Sn=new K(""),Fv=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:()=>G($B),providedIn:"platform"});let n=e;return n})(),qR=new K(""),$B=(()=>{let e=class e extends Fv{constructor(){super(),this._doc=G(Sn),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ro().getBaseHref(this._doc)}onPopState(r){let i=ro().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=ro().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:()=>new e,providedIn:"platform"});let n=e;return n})();function Lv(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function LR(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function gi(n){return n&&n[0]!=="?"?"?"+n:n}var io=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:()=>G(Vv),providedIn:"root"});let n=e;return n})(),HR=new K(""),Vv=(()=>{let e=class e extends io{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??G(Sn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return Lv(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+gi(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+gi(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+gi(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(F(Fv),F(HR,8))},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),zR=(()=>{let e=class e extends io{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=Lv(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+gi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+gi(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(F(Fv),F(HR,8))},e.\u0275prov=J({token:e,factory:e.\u0275fac});let n=e;return n})(),Na=(()=>{let e=class e{constructor(r){this._subject=new un,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=zB(LR(VR(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+gi(i))}normalize(r){return e.stripTrailingSlash(HB(this._basePath,VR(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+gi(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+gi(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=gi,e.joinWithSlash=Lv,e.stripTrailingSlash=LR,e.\u0275fac=function(i){return new(i||e)(F(io))},e.\u0275prov=J({token:e,factory:()=>qB(),providedIn:"root"});let n=e;return n})();function qB(){return new Na(F(io))}function HB(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function VR(n){return n.replace(/\/index.html$/,"")}function zB(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function GR(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var xv=class{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},WR=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new xv(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),UR(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);UR(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(tn(Ra),tn(Of),tn(Sv))},e.\u0275dir=Sa({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let n=e;return n})();function UR(n,e){n.context.$implicit=e.item}var KR=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new Mv,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){jR("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){jR("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(tn(Ra),tn(Of))},e.\u0275dir=Sa({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let n=e;return n})(),Mv=class{constructor(){this.$implicit=null,this.ngIf=null}};function jR(n,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${n} must be a TemplateRef, but received '${Cn(e)}'.`)}var QR=(()=>{let e=class e{constructor(r,i,s){this._ngEl=r,this._differs=i,this._renderer=s,this._ngStyle=null,this._differ=null}set ngStyle(r){this._ngStyle=r,!this._differ&&r&&(this._differ=this._differs.find(r).create())}ngDoCheck(){if(this._differ){let r=this._differ.diff(this._ngStyle);r&&this._applyChanges(r)}}_setStyle(r,i){let[s,o]=r.split("."),a=s.indexOf("-")===-1?void 0:zi.DashCase;i!=null?this._renderer.setStyle(this._ngEl.nativeElement,s,o?`${i}${o}`:i,a):this._renderer.removeStyle(this._ngEl.nativeElement,s,a)}_applyChanges(r){r.forEachRemovedItem(i=>this._setStyle(i.key,null)),r.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),r.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}};e.\u0275fac=function(i){return new(i||e)(tn(qu),tn(Av),tn(Lf))},e.\u0275dir=Sa({type:e,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0});let n=e;return n})();function GB(n,e){return new se(2100,!1)}var Nv=class{createSubscription(e,t){return Rv(()=>e.subscribe({next:t,error:r=>{throw r}}))}dispose(e){Rv(()=>e.unsubscribe())}},Pv=class{createSubscription(e,t){return e.then(t,r=>{throw r})}dispose(e){}},WB=new Pv,KB=new Nv,YR=(()=>{let e=class e{constructor(r){this._latestValue=null,this.markForCheckOnValueUpdate=!0,this._subscription=null,this._obj=null,this._strategy=null,this._ref=r}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(r){if(!this._obj){if(r)try{this.markForCheckOnValueUpdate=!1,this._subscribe(r)}finally{this.markForCheckOnValueUpdate=!0}return this._latestValue}return r!==this._obj?(this._dispose(),this.transform(r)):this._latestValue}_subscribe(r){this._obj=r,this._strategy=this._selectStrategy(r),this._subscription=this._strategy.createSubscription(r,i=>this._updateLatestValue(r,i))}_selectStrategy(r){if(xa(r))return WB;if(Iv(r))return KB;throw GB(e,r)}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(r,i){r===this._obj&&(this._latestValue=i,this.markForCheckOnValueUpdate&&this._ref?.markForCheck())}};e.\u0275fac=function(i){return new(i||e)(tn(no,16))},e.\u0275pipe=B_({name:"async",type:e,pure:!1,standalone:!0});let n=e;return n})();var ZR=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=vt({type:e}),e.\u0275inj=_t({});let n=e;return n})(),Uv="browser",QB="server";function YB(n){return n===Uv}function so(n){return n===QB}var XR=(()=>{let e=class e{};e.\u0275prov=J({token:e,providedIn:"root",factory:()=>YB(G(jt))?new kv(G(Sn),window):new Ov});let n=e;return n})(),kv=class{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=ZB(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function ZB(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var Ov=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},Kf=class{};var $v=class extends Wf{constructor(){super(...arguments),this.supportsDOMEvents=!0}},qv=class n extends $v{static makeCurrent(){$R(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=e$();return t==null?null:t$(t)}resetBaseElement(){Wu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return GR(document.cookie,e)}},Wu=null;function e$(){return Wu=Wu||document.querySelector("base"),Wu?Wu.getAttribute("href"):null}function t$(n){return new URL(n,document.baseURI).pathname}var Hv=class{addToWindow(e){Nn.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new se(5103,!1);return s},Nn.getAllAngularTestabilities=()=>e.getAllTestabilities(),Nn.getAllAngularRootElements=()=>e.getAllRootElements();let t=r=>{let i=Nn.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};Nn.frameworkStabilizers||(Nn.frameworkStabilizers=[]),Nn.frameworkStabilizers.push(t)}findTestabilityInTree(e,t,r){if(t==null)return null;let i=e.getTestability(t);return i??(r?ro().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},n$=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac});let n=e;return n})(),zv=new K(""),nx=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new se(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(F(zv),F(De))},e.\u0275prov=J({token:e,factory:e.\u0275fac});let n=e;return n})(),Qf=class{constructor(e){this._doc=e}},jv="ng-app-id",rx=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=so(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${jv}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(jv),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(jv,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(F(Sn),F(xf),F(rv,8),F(jt))},e.\u0275prov=J({token:e,factory:e.\u0275fac});let n=e;return n})(),Bv={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Wv=/%COMP%/g,ix="%COMP%",r$=`_nghost-${ix}`,i$=`_ngcontent-${ix}`,s$=!0,o$=new K("",{providedIn:"root",factory:()=>s$});function a$(n){return i$.replace(Wv,n)}function c$(n){return r$.replace(Wv,n)}function sx(n,e){return e.map(t=>t.replace(Wv,n))}var JR=(()=>{let e=class e{constructor(r,i,s,o,a,c,l,d=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=so(c),this.defaultRenderer=new Ku(r,a,l,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===br.ShadowDom&&(i=Je(Q({},i),{encapsulation:br.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Yf?s.applyToHost(r):s instanceof Qu&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,d=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,g=this.platformIsServer;switch(i.encapsulation){case br.Emulated:o=new Yf(l,d,i,this.appId,f,a,c,g);break;case br.ShadowDom:return new Gv(l,d,r,i,a,c,this.nonce,g);default:o=new Qu(l,d,i,f,a,c,g);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(F(nx),F(rx),F(xf),F(o$),F(Sn),F(jt),F(De),F(rv))},e.\u0275prov=J({token:e,factory:e.\u0275fac});let n=e;return n})(),Ku=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Bv[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(ex(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(ex(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new se(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=Bv[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Bv[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(zi.DashCase|zi.Important)?e.style.setProperty(t,r,i&zi.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&zi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=ro().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function ex(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Gv=class extends Ku{constructor(e,t,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=sx(i.id,i.styles);for(let d of l){let f=document.createElement("style");a&&f.setAttribute("nonce",a),f.textContent=d,this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Qu=class extends Ku{constructor(e,t,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?sx(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Yf=class extends Qu{constructor(e,t,r,i,s,o,a,c){let l=i+"-"+r.id;super(e,t,r,s,o,a,c,l),this.contentAttr=a$(l),this.hostAttr=c$(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},u$=(()=>{let e=class e extends Qf{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(F(Sn))},e.\u0275prov=J({token:e,factory:e.\u0275fac});let n=e;return n})(),tx=["alt","control","meta","shift"],l$={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},d$={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},h$=(()=>{let e=class e extends Qf{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ro().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),tx.forEach(d=>{let f=i.indexOf(d);f>-1&&(i.splice(f,1),a+=d+".")}),a+=o,i.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(r,i){let s=l$[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),tx.forEach(a=>{if(a!==s){let c=d$[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(F(Sn))},e.\u0275prov=J({token:e,factory:e.\u0275fac});let n=e;return n})();function f$(){qv.makeCurrent()}function p$(){return new Rr}function g$(){return BA(document),document}var m$=[{provide:jt,useValue:Uv},{provide:nv,useValue:f$,multi:!0},{provide:Sn,useFactory:g$,deps:[]}],ox=Dv(kR,"browser",m$),y$=new K(""),_$=[{provide:Gu,useClass:Hv,deps:[]},{provide:wv,useClass:qf,deps:[De,Hf,Gu]},{provide:qf,useClass:qf,deps:[De,Hf,Gu]}],v$=[{provide:Cf,useValue:"root"},{provide:Rr,useFactory:p$,deps:[]},{provide:zv,useClass:u$,multi:!0,deps:[Sn,De,jt]},{provide:zv,useClass:h$,multi:!0,deps:[Sn]},JR,rx,nx,{provide:Vu,useExisting:JR},{provide:Kf,useClass:n$,deps:[]},[]],ax=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:xf,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(F(y$,12))},e.\u0275mod=vt({type:e}),e.\u0275inj=_t({providers:[...v$,..._$],imports:[ZR,OR]});let n=e;return n})();var cx=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(F(Sn))},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var _e="primary",ll=Symbol("RouteTitle"),Xv=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function La(n){return new Xv(n)}function w$(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function E$(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!kr(n[t],e[t]))return!1;return!0}function kr(n,e){let t=n?Jv(n):void 0,r=e?Jv(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!_x(n[i],e[i]))return!1;return!0}function Jv(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function _x(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function vx(n){return n.length>0?n[n.length-1]:null}function Yi(n){return Py(n)?n:xa(n)?Ae(Promise.resolve(n)):ne(n)}var I$={exact:Ex,subset:Ix},wx={exact:T$,subset:C$,ignored:()=>!0};function lx(n,e,t){return I$[t.paths](n.root,e.root,t.matrixParams)&&wx[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function T$(n,e){return kr(n,e)}function Ex(n,e,t){if(!ao(n.segments,e.segments)||!Jf(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!Ex(n.children[r],e.children[r],t))return!1;return!0}function C$(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>_x(n[t],e[t]))}function Ix(n,e,t){return Tx(n,e,e.segments,t)}function Tx(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!ao(i,t)||e.hasChildren()||!Jf(i,t,r))}else if(n.segments.length===t.length){if(!ao(n.segments,t)||!Jf(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!Ix(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!ao(n.segments,i)||!Jf(n.segments,i,r)||!n.children[_e]?!1:Tx(n.children[_e],e,s,r)}}function Jf(n,e,t){return e.every((r,i)=>wx[t](n[i].parameters,r.parameters))}var Wi=class{constructor(e=new je([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=La(this.queryParams),this._queryParamMap}toString(){return S$.serialize(this)}},je=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ep(this)}},oo=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=La(this.parameters),this._parameterMap}toString(){return Dx(this)}};function D$(n,e){return ao(n,e)&&n.every((t,r)=>kr(t.parameters,e[r].parameters))}function ao(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function b$(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===_e&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==_e&&(t=t.concat(e(i,r)))}),t}var dl=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:()=>new nl,providedIn:"root"});let n=e;return n})(),nl=class{parse(e){let t=new tw(e);return new Wi(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Yu(e.root,!0)}`,r=x$(e.queryParams),i=typeof e.fragment=="string"?`#${A$(e.fragment)}`:"";return`${t}${r}${i}`}},S$=new nl;function ep(n){return n.segments.map(e=>Dx(e)).join("/")}function Yu(n,e){if(!n.hasChildren())return ep(n);if(e){let t=n.children[_e]?Yu(n.children[_e],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==_e&&r.push(`${i}:${Yu(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=b$(n,(r,i)=>i===_e?[Yu(n.children[_e],!1)]:[`${i}:${Yu(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[_e]!=null?`${ep(n)}/${t[0]}`:`${ep(n)}/(${t.join("//")})`}}function Cx(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Zf(n){return Cx(n).replace(/%3B/gi,";")}function A$(n){return encodeURI(n)}function ew(n){return Cx(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function tp(n){return decodeURIComponent(n)}function dx(n){return tp(n.replace(/\+/g,"%20"))}function Dx(n){return`${ew(n.path)}${R$(n.parameters)}`}function R$(n){return Object.entries(n).map(([e,t])=>`;${ew(e)}=${ew(t)}`).join("")}function x$(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Zf(t)}=${Zf(i)}`).join("&"):`${Zf(t)}=${Zf(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var M$=/^[^\/()?;#]+/;function Kv(n){let e=n.match(M$);return e?e[0]:""}var N$=/^[^\/()?;=#]+/;function P$(n){let e=n.match(N$);return e?e[0]:""}var k$=/^[^=?&#]+/;function O$(n){let e=n.match(k$);return e?e[0]:""}var F$=/^[^&#]+/;function L$(n){let e=n.match(F$);return e?e[0]:""}var tw=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new je([],{}):new je([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[_e]=new je(e,t)),r}parseSegment(){let e=Kv(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new se(4009,!1);return this.capture(e),new oo(tp(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=P$(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=Kv(this.remaining);i&&(r=i,this.capture(r))}e[tp(t)]=tp(r)}parseQueryParam(e){let t=O$(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=L$(this.remaining);o&&(r=o,this.capture(r))}let i=dx(t),s=dx(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Kv(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new se(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=_e);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[_e]:new je([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new se(4011,!1)}};function bx(n){return n.segments.length>0?new je([],{[_e]:n}):n}function Sx(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=Sx(i);if(r===_e&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new je(n.segments,e);return V$(t)}function V$(n){if(n.numberOfChildren===1&&n.children[_e]){let e=n.children[_e];return new je(n.segments.concat(e.segments),e.children)}return n}function Va(n){return n instanceof Wi}function U$(n,e,t=null,r=null){let i=Ax(n);return Rx(i,e,t,r)}function Ax(n){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new je(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=bx(r);return e??i}function Rx(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return Qv(i,i,i,t,r);let s=j$(e);if(s.toRoot())return Qv(i,i,new je([],{}),t,r);let o=B$(s,i,n),a=o.processChildren?Ju(o.segmentGroup,o.index,s.commands):Mx(o.segmentGroup,o.index,s.commands);return Qv(i,o.segmentGroup,a,t,r)}function np(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function rl(n){return typeof n=="object"&&n!=null&&n.outlets}function Qv(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let o;n===e?o=t:o=xx(n,e,t);let a=bx(Sx(o));return new Wi(a,s,i)}function xx(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=xx(s,e,t)}),new je(n.segments,r)}var rp=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&np(r[0]))throw new se(4003,!1);let i=r.find(rl);if(i&&i!==vx(r))throw new se(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function j$(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new rp(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new rp(t,e,r)}var Oa=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function B$(n,e,t){if(n.isAbsolute)return new Oa(e,!0,0);if(!t)return new Oa(e,!1,NaN);if(t.parent===null)return new Oa(t,!0,0);let r=np(n.commands[0])?0:1,i=t.segments.length-1+r;return $$(t,i,n.numberOfDoubleDots)}function $$(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new se(4005,!1);i=r.segments.length}return new Oa(r,!1,i-s)}function q$(n){return rl(n[0])?n[0].outlets:{[_e]:n}}function Mx(n,e,t){if(n??=new je([],{}),n.segments.length===0&&n.hasChildren())return Ju(n,e,t);let r=H$(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new je(n.segments.slice(0,r.pathIndex),{});return s.children[_e]=new je(n.segments.slice(r.pathIndex),n.children),Ju(s,0,i)}else return r.match&&i.length===0?new je(n.segments,{}):r.match&&!n.hasChildren()?nw(n,e,t):r.match?Ju(n,0,i):nw(n,e,t)}function Ju(n,e,t){if(t.length===0)return new je(n.segments,{});{let r=q$(t),i={};if(Object.keys(r).some(s=>s!==_e)&&n.children[_e]&&n.numberOfChildren===1&&n.children[_e].segments.length===0){let s=Ju(n.children[_e],e,t);return new je(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=Mx(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new je(n.segments,i)}}function H$(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(rl(a))break;let c=`${a}`,l=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!fx(c,l,o))return s;r+=2}else{if(!fx(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function nw(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(rl(s)){let c=z$(s.outlets);return new je(r,c)}if(i===0&&np(t[0])){let c=n.segments[e];r.push(new oo(c.path,hx(t[0]))),i++;continue}let o=rl(s)?s.outlets[_e]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&np(a)?(r.push(new oo(o,hx(a))),i+=2):(r.push(new oo(o,{})),i++)}return new je(r,{})}function z$(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=nw(new je([],{}),0,r))}),e}function hx(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function fx(n,e,t){return n==t.path&&kr(e,t.parameters)}var el="imperative",Bt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Bt||{}),Qn=class{constructor(e,t){this.id=e,this.url=t}},Ua=class extends Qn{constructor(e,t,r="imperative",i=null){super(e,t),this.type=Bt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},mi=class extends Qn{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=Bt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},On=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(On||{}),ip=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(ip||{}),Ki=class extends Qn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Bt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Qi=class extends Qn{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Bt.NavigationSkipped}},il=class extends Qn{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=Bt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},sp=class extends Qn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Bt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},rw=class extends Qn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Bt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},iw=class extends Qn{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Bt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},sw=class extends Qn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Bt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ow=class extends Qn{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Bt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},aw=class{constructor(e){this.route=e,this.type=Bt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},cw=class{constructor(e){this.route=e,this.type=Bt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},uw=class{constructor(e){this.snapshot=e,this.type=Bt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},lw=class{constructor(e){this.snapshot=e,this.type=Bt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},dw=class{constructor(e){this.snapshot=e,this.type=Bt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},hw=class{constructor(e){this.snapshot=e,this.type=Bt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},op=class{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=Bt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},sl=class{},ol=class{constructor(e){this.url=e}};var fw=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new hl,this.attachRef=null}},hl=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new fw,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),ap=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=pw(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=pw(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=gw(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return gw(e,this._root).map(t=>t.value)}};function pw(n,e){if(n===e.value)return e;for(let t of e.children){let r=pw(n,t);if(r)return r}return null}function gw(n,e){if(n===e.value)return[e];for(let t of e.children){let r=gw(n,t);if(r.length)return r.unshift(e),r}return[]}var kn=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function ka(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var cp=class extends ap{constructor(e,t){super(e),this.snapshot=t,Dw(this,e)}toString(){return this.snapshot.toString()}};function Nx(n){let e=G$(n),t=new Kt([new oo("",{})]),r=new Kt({}),i=new Kt({}),s=new Kt({}),o=new Kt(""),a=new ja(t,r,s,o,i,_e,n,e.root);return a.snapshot=e.root,new cp(new kn(a,[]),e)}function G$(n){let e={},t={},r={},i="",s=new al([],e,r,i,t,_e,n,null,{});return new up("",new kn(s,[]))}var ja=class{constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(ee(l=>l[ll]))??ne(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ee(e=>La(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ee(e=>La(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Cw(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:Q(Q({},e.params),n.params),data:Q(Q({},e.data),n.data),resolve:Q(Q(Q(Q({},n.data),e.data),i?.data),n._resolvedData)}:r={params:Q({},n.params),data:Q({},n.data),resolve:Q(Q({},n.data),n._resolvedData??{})},i&&kx(i)&&(r.resolve[ll]=i.title),r}var al=class{get title(){return this.data?.[ll]}constructor(e,t,r,i,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=La(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=La(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},up=class extends ap{constructor(e,t){super(t),this.url=e,Dw(this,t)}toString(){return Px(this._root)}};function Dw(n,e){e.value._routerState=n,e.children.forEach(t=>Dw(n,t))}function Px(n){let e=n.children.length>0?` { ${n.children.map(Px).join(", ")} } `:"";return`${n.value}${e}`}function Yv(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,kr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),kr(e.params,t.params)||n.paramsSubject.next(t.params),E$(e.url,t.url)||n.urlSubject.next(t.url),kr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function mw(n,e){let t=kr(n.params,e.params)&&D$(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||mw(n.parent,e.parent))}function kx(n){return typeof n.title=="string"||n.title===null}var W$=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=_e,this.activateEvents=new un,this.deactivateEvents=new un,this.attachEvents=new un,this.detachEvents=new un,this.parentContexts=G(hl),this.location=G(Ra),this.changeDetector=G(no),this.environmentInjector=G(Dn),this.inputBinder=G(pp,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new se(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new se(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new se(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new se(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new yw(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Sa({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Af]});let n=e;return n})(),yw=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===ja?this.route:e===hl?this.childContexts:this.parent.get(e,t)}},pp=new K(""),px=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Tu([i.queryParams,i.params,i.data]).pipe(ze(([o,a,c],l)=>(c=Q(Q(Q({},o),a),c),l===0?ne(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=FR(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac});let n=e;return n})();function K$(n,e,t){let r=cl(n,e._root,t?t._root:void 0);return new cp(r,e)}function cl(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=Q$(n,e,t);return new kn(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>cl(n,a)),o}}let r=Y$(e.value),i=e.children.map(s=>cl(n,s));return new kn(r,i)}}function Q$(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return cl(n,r,i);return cl(n,r)})}function Y$(n){return new ja(new Kt(n.url),new Kt(n.params),new Kt(n.queryParams),new Kt(n.fragment),new Kt(n.data),n.outlet,n.component,n)}var Ox="ngNavigationCancelingError";function Fx(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Va(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=Lx(!1,On.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function Lx(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[Ox]=!0,t.cancellationCode=e,t}function Z$(n){return Vx(n)&&Va(n.url)}function Vx(n){return!!n&&n[Ox]}var X$=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=ba({type:e,selectors:[["ng-component"]],standalone:!0,features:[TR],decls:1,vars:0,template:function(i,s){i&1&&zu(0,"router-outlet")},dependencies:[W$],encapsulation:2});let n=e;return n})();function J$(n,e){return n.providers&&!n._injector&&(n._injector=Uf(n.providers,e,`Route: ${n.path}`)),n._injector??e}function bw(n){let e=n.children&&n.children.map(bw),t=e?Je(Q({},n),{children:e}):Q({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==_e&&(t.component=X$),t}function Or(n){return n.outlet||_e}function eq(n,e){let t=n.filter(r=>Or(r)===e);return t.push(...n.filter(r=>Or(r)!==e)),t}function fl(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var tq=(n,e,t,r)=>ee(i=>(new _w(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),_w=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Yv(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=ka(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=ka(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=ka(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=ka(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new hw(s.value.snapshot))}),e.children.length&&this.forwardEvent(new lw(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(Yv(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Yv(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=fl(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},lp=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Fa=class{constructor(e,t){this.component=e,this.route=t}};function nq(n,e,t){let r=n._root,i=e?e._root:null;return Zu(r,i,t,[r.value])}function rq(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function $a(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!xS(n)?n:e.get(n):r}function Zu(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=ka(e);return n.children.forEach(o=>{iq(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>tl(a,t.getContext(o),i)),i}function iq(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=sq(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new lp(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Zu(n,e,a?a.children:null,r,i):Zu(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Fa(a.outlet.component,o))}else o&&tl(e,a,i),i.canActivateChecks.push(new lp(r)),s.component?Zu(n,null,a?a.children:null,r,i):Zu(n,null,t,r,i);return i}function sq(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!ao(n.url,e.url);case"pathParamsOrQueryParamsChange":return!ao(n.url,e.url)||!kr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!mw(n,e)||!kr(n.queryParams,e.queryParams);case"paramsChange":default:return!mw(n,e)}}function tl(n,e,t){let r=ka(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?tl(o,e.children.getContext(s),t):tl(o,null,t):tl(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Fa(e.outlet.component,i)):t.canDeactivateChecks.push(new Fa(null,i)):t.canDeactivateChecks.push(new Fa(null,i))}function pl(n){return typeof n=="function"}function oq(n){return typeof n=="boolean"}function aq(n){return n&&pl(n.canLoad)}function cq(n){return n&&pl(n.canActivate)}function uq(n){return n&&pl(n.canActivateChild)}function lq(n){return n&&pl(n.canDeactivate)}function dq(n){return n&&pl(n.canMatch)}function Ux(n){return n instanceof ci||n?.name==="EmptyError"}var Xf=Symbol("INITIAL_VALUE");function Ba(){return ze(n=>Tu(n.map(e=>e.pipe(ui(1),qs(Xf)))).pipe(ee(e=>{for(let t of e)if(t!==!0){if(t===Xf)return Xf;if(t===!1||t instanceof Wi)return t}return!0}),Qt(e=>e!==Xf),ui(1)))}function hq(n,e){return Dt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?ne(Je(Q({},t),{guardsResult:!0})):fq(o,r,i,n).pipe(Dt(a=>a&&oq(a)?pq(r,s,n,e):ne(a)),ee(a=>Je(Q({},t),{guardsResult:a})))})}function fq(n,e,t,r){return Ae(n).pipe(Dt(i=>vq(i.component,i.route,t,e,r)),Gn(i=>i!==!0,!0))}function pq(n,e,t,r){return Ae(e).pipe($s(i=>fa(mq(i.route.parent,r),gq(i.route,r),_q(n,i.path,t),yq(n,i.route,t))),Gn(i=>i!==!0,!0))}function gq(n,e){return n!==null&&e&&e(new dw(n)),ne(!0)}function mq(n,e){return n!==null&&e&&e(new uw(n)),ne(!0)}function yq(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return ne(!0);let i=r.map(s=>$h(()=>{let o=fl(e)??t,a=$a(s,o),c=cq(a)?a.canActivate(e,n):hi(o,()=>a(e,n));return Yi(c).pipe(Gn())}));return ne(i).pipe(Ba())}function _q(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>rq(o)).filter(o=>o!==null).map(o=>$h(()=>{let a=o.guards.map(c=>{let l=fl(o.node)??t,d=$a(c,l),f=uq(d)?d.canActivateChild(r,n):hi(l,()=>d(r,n));return Yi(f).pipe(Gn())});return ne(a).pipe(Ba())}));return ne(s).pipe(Ba())}function vq(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return ne(!0);let o=s.map(a=>{let c=fl(e)??i,l=$a(a,c),d=lq(l)?l.canDeactivate(n,e,t,r):hi(c,()=>l(n,e,t,r));return Yi(d).pipe(Gn())});return ne(o).pipe(Ba())}function wq(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return ne(!0);let s=i.map(o=>{let a=$a(o,n),c=aq(a)?a.canLoad(e,t):hi(n,()=>a(e,t));return Yi(c)});return ne(s).pipe(Ba(),jx(r))}function jx(n){return Sy(bt(e=>{if(Va(e))throw Fx(n,e)}),ee(e=>e===!0))}function Eq(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return ne(!0);let s=i.map(o=>{let a=$a(o,n),c=dq(a)?a.canMatch(e,t):hi(n,()=>a(e,t));return Yi(c)});return ne(s).pipe(Ba(),jx(r))}var ul=class{constructor(e){this.segmentGroup=e||null}},dp=class extends Error{constructor(e){super(),this.urlTree=e}};function Pa(n){return ha(new ul(n))}function Iq(n){return ha(new se(4e3,!1))}function Tq(n){return ha(Lx(!1,On.GuardRejected))}var vw=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return ne(r);if(i.numberOfChildren>1||!i.children[_e])return Iq(e.redirectTo);i=i.children[_e]}}applyRedirectCommands(e,t,r){let i=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t.startsWith("/"))throw new dp(i);return i}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Wi(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new je(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new se(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},ww={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Cq(n,e,t,r,i){let s=Sw(n,e,t);return s.matched?(r=J$(e,r),Eq(r,e,t,i).pipe(ee(o=>o===!0?s:Q({},ww)))):ne(s)}function Sw(n,e,t){if(e.path==="**")return Dq(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?Q({},ww):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||w$)(t,n,e);if(!i)return Q({},ww);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?Q(Q({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function Dq(n){return{matched:!0,parameters:n.length>0?vx(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function gx(n,e,t,r){return t.length>0&&Aq(n,t,r)?{segmentGroup:new je(e,Sq(r,new je(t,n.children))),slicedSegments:[]}:t.length===0&&Rq(n,t,r)?{segmentGroup:new je(n.segments,bq(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new je(n.segments,n.children),slicedSegments:t}}function bq(n,e,t,r){let i={};for(let s of t)if(gp(n,e,s)&&!r[Or(s)]){let o=new je([],{});i[Or(s)]=o}return Q(Q({},r),i)}function Sq(n,e){let t={};t[_e]=e;for(let r of n)if(r.path===""&&Or(r)!==_e){let i=new je([],{});t[Or(r)]=i}return t}function Aq(n,e,t){return t.some(r=>gp(n,e,r)&&Or(r)!==_e)}function Rq(n,e,t){return t.some(r=>gp(n,e,r))}function gp(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function xq(n,e,t,r){return Or(n)!==r&&(r===_e||!gp(e,t,n))?!1:Sw(e,n,t).matched}function Mq(n,e,t){return e.length===0&&!n.children[t]}var Ew=class{};function Nq(n,e,t,r,i,s,o="emptyOnly"){return new Iw(n,e,t,r,i,o,s).recognize()}var Pq=31,Iw=class{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new vw(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new se(4002,`'${e.segmentGroup}'`)}recognize(){let e=gx(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(ee(t=>{let r=new al([],Object.freeze({}),Object.freeze(Q({},this.urlTree.queryParams)),this.urlTree.fragment,{},_e,this.rootComponentType,null,{}),i=new kn(r,t),s=new up("",i),o=U$(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,_e).pipe(Fi(r=>{if(r instanceof dp)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof ul?this.noMatchError(r):r}))}inheritParamsAndData(e,t){let r=e.value,i=Cw(r,t,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,t,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0).pipe(ee(s=>s instanceof kn?[s]:[]))}processChildren(e,t,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return Ae(i).pipe($s(s=>{let o=r.children[s],a=eq(t,s);return this.processSegmentGroup(e,a,o,s)}),Tr((s,o)=>(s.push(...o),s)),Li(null),Fy(),Dt(s=>{if(s===null)return Pa(r);let o=Bx(s);return kq(o),ne(o)}))}processSegment(e,t,r,i,s,o){return Ae(t).pipe($s(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(Fi(c=>{if(c instanceof ul)return ne(null);throw c}))),Gn(a=>!!a),Fi(a=>{if(Ux(a))return Mq(r,i,s)?ne(new Ew):Pa(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return xq(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):Pa(i):Pa(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:d}=Sw(t,i,s);if(!a)return Pa(t);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Pq&&(this.allowRedirects=!1));let f=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,f).pipe(Dt(g=>this.processSegment(e,r,t,g.concat(d),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s){let o=Cq(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),o.pipe(ze(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(ze(({routes:c})=>{let l=r._loadedInjector??e,{consumedSegments:d,remainingSegments:f,parameters:g}=a,y=new al(d,g,Object.freeze(Q({},this.urlTree.queryParams)),this.urlTree.fragment,Fq(r),Or(r),r.component??r._loadedComponent??null,r,Lq(r)),{segmentGroup:v,slicedSegments:b}=gx(t,d,f,c);if(b.length===0&&v.hasChildren())return this.processChildren(l,c,v).pipe(ee(V=>V===null?null:new kn(y,V)));if(c.length===0&&b.length===0)return ne(new kn(y,[]));let C=Or(r)===s;return this.processSegment(l,c,v,b,C?_e:s,!0).pipe(ee(V=>new kn(y,V instanceof kn?[V]:[])))}))):Pa(t)))}getChildConfig(e,t,r){return t.children?ne({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?ne({routes:t._loadedRoutes,injector:t._loadedInjector}):wq(e,t,r,this.urlSerializer).pipe(Dt(i=>i?this.configLoader.loadChildren(e,t).pipe(bt(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):Tq(t))):ne({routes:[],injector:e})}};function kq(n){n.sort((e,t)=>e.value.outlet===_e?-1:t.value.outlet===_e?1:e.value.outlet.localeCompare(t.value.outlet))}function Oq(n){let e=n.value.routeConfig;return e&&e.path===""}function Bx(n){let e=[],t=new Set;for(let r of n){if(!Oq(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=Bx(r.children);e.push(new kn(r.value,i))}return e.filter(r=>!t.has(r))}function Fq(n){return n.data||{}}function Lq(n){return n.resolve||{}}function Vq(n,e,t,r,i,s){return Dt(o=>Nq(n,e,t,r,o.extractedUrl,i,s).pipe(ee(({state:a,tree:c})=>Je(Q({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function Uq(n,e){return Dt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return ne(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of $x(c))o.add(l);let a=0;return Ae(o).pipe($s(c=>s.has(c)?jq(c,r,n,e):(c.data=Cw(c,c.parent,n).resolve,ne(void 0))),bt(()=>a++),ga(1),Dt(c=>a===o.size?ne(t):cn))})}function $x(n){let e=n.children.map(t=>$x(t)).flat();return[n,...e]}function jq(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!kx(i)&&(s[ll]=i.title),Bq(s,n,e,r).pipe(ee(o=>(n._resolvedData=o,n.data=Cw(n,n.parent,t).resolve,null)))}function Bq(n,e,t,r){let i=Jv(n);if(i.length===0)return ne({});let s={};return Ae(i).pipe(Dt(o=>$q(n[o],e,t,r).pipe(Gn(),bt(a=>{s[o]=a}))),ga(1),Oy(s),Fi(o=>Ux(o)?cn:ha(o)))}function $q(n,e,t,r){let i=fl(e)??r,s=$a(n,i),o=s.resolve?s.resolve(e,t):hi(i,()=>s(e,t));return Yi(o)}function Zv(n){return ze(e=>{let t=n(e);return t?Ae(t).pipe(ee(()=>e)):ne(e)})}var qx=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===_e);return i}getResolvedTitleForRoute(r){return r.data[ll]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:()=>G(qq),providedIn:"root"});let n=e;return n})(),qq=(()=>{let e=class e extends qx{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(F(cx))},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),gl=new K("",{providedIn:"root",factory:()=>({})}),hp=new K(""),Aw=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=G(Gf)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return ne(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Yi(r.loadComponent()).pipe(ee(Hx),bt(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),Du(()=>{this.componentLoaders.delete(r)})),s=new ca(i,()=>new yt).pipe(aa());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return ne({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=Hq(i,this.compiler,r,this.onLoadEndListener).pipe(Du(()=>{this.childrenLoaders.delete(i)})),a=new ca(o,()=>new yt).pipe(aa());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Hq(n,e,t,r){return Yi(n.loadChildren()).pipe(ee(Hx),Dt(i=>i instanceof Uu||Array.isArray(i)?ne(i):Ae(e.compileModuleAsync(i))),ee(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(t).injector,o=s.get(hp,[],{optional:!0,self:!0}).flat()),{routes:o.map(bw),injector:s}}))}function zq(n){return n&&typeof n=="object"&&"default"in n}function Hx(n){return zq(n)?n.default:n}var Rw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:()=>G(Gq),providedIn:"root"});let n=e;return n})(),Gq=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),zx=new K(""),Gx=new K("");function Wq(n,e,t){let r=n.get(Gx),i=n.get(Sn);return n.get(De).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(l=>setTimeout(l));let s,o=new Promise(l=>{s=l}),a=i.startViewTransition(()=>(s(),Kq(n))),{onViewTransitionCreated:c}=r;return c&&hi(n,()=>c({transition:a,from:e,to:t})),o})}function Kq(n){return new Promise(e=>{Vf(e,{injector:n})})}var xw=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new yt,this.transitionAbortSubject=new yt,this.configLoader=G(Aw),this.environmentInjector=G(Dn),this.urlSerializer=G(dl),this.rootContexts=G(hl),this.location=G(Na),this.inputBindingEnabled=G(pp,{optional:!0})!==null,this.titleStrategy=G(qx),this.options=G(gl,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=G(Rw),this.createViewTransition=G(zx,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>ne(void 0),this.rootComponentType=null;let r=s=>this.events.next(new aw(s)),i=s=>this.events.next(new cw(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(Je(Q(Q({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Kt({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:el,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Qt(o=>o.id!==0),ee(o=>Je(Q({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),ze(o=>{let a=!1,c=!1;return ne(o).pipe(ze(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",On.SupersededByNewNavigation),cn;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?Je(Q({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),f=l.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!d&&f!=="reload"){let g="";return this.events.next(new Qi(l.id,this.urlSerializer.serialize(l.rawUrl),g,ip.IgnoredSameUrlNavigation)),l.resolve(null),cn}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return ne(l).pipe(ze(g=>{let y=this.transitions?.getValue();return this.events.next(new Ua(g.id,this.urlSerializer.serialize(g.extractedUrl),g.source,g.restoredState)),y!==this.transitions?.getValue()?cn:Promise.resolve(g)}),Vq(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),bt(g=>{o.targetSnapshot=g.targetSnapshot,o.urlAfterRedirects=g.urlAfterRedirects,this.currentNavigation=Je(Q({},this.currentNavigation),{finalUrl:g.urlAfterRedirects});let y=new sp(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(y)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:g,extractedUrl:y,source:v,restoredState:b,extras:C}=l,V=new Ua(g,this.urlSerializer.serialize(y),v,b);this.events.next(V);let B=Nx(this.rootComponentType).snapshot;return this.currentTransition=o=Je(Q({},l),{targetSnapshot:B,urlAfterRedirects:y,extras:Je(Q({},C),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=y,ne(o)}else{let g="";return this.events.next(new Qi(l.id,this.urlSerializer.serialize(l.extractedUrl),g,ip.IgnoredByUrlHandlingStrategy)),l.resolve(null),cn}}),bt(l=>{let d=new rw(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),ee(l=>(this.currentTransition=o=Je(Q({},l),{guards:nq(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),hq(this.environmentInjector,l=>this.events.next(l)),bt(l=>{if(o.guardsResult=l.guardsResult,Va(l.guardsResult))throw Fx(this.urlSerializer,l.guardsResult);let d=new iw(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(d)}),Qt(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",On.GuardRejected),!1)),Zv(l=>{if(l.guards.canActivateChecks.length)return ne(l).pipe(bt(d=>{let f=new sw(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(f)}),ze(d=>{let f=!1;return ne(d).pipe(Uq(this.paramsInheritanceStrategy,this.environmentInjector),bt({next:()=>f=!0,complete:()=>{f||this.cancelNavigationTransition(d,"",On.NoDataFromResolver)}}))}),bt(d=>{let f=new ow(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(f)}))}),Zv(l=>{let d=f=>{let g=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(f.routeConfig).pipe(bt(y=>{f.component=y}),ee(()=>{})));for(let y of f.children)g.push(...d(y));return g};return Tu(d(l.targetSnapshot.root)).pipe(Li(null),ui(1))}),Zv(()=>this.afterPreactivation()),ze(()=>{let{currentSnapshot:l,targetSnapshot:d}=o,f=this.createViewTransition?.(this.environmentInjector,l.root,d.root);return f?Ae(f).pipe(ee(()=>o)):ne(o)}),ee(l=>{let d=K$(r.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=Je(Q({},l),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,o}),bt(()=>{this.events.next(new sl)}),tq(this.rootContexts,r.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),ui(1),bt({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new mi(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),Uy(this.transitionAbortSubject.pipe(bt(l=>{throw l}))),Du(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",On.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Fi(l=>{if(c=!0,Vx(l))this.events.next(new Ki(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),Z$(l)?this.events.next(new ol(l.url)):o.resolve(!1);else{this.events.next(new il(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(l))}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return cn}))}))}cancelNavigationTransition(r,i,s){let o=new Ki(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function Qq(n){return n!==el}var Yq=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:()=>G(Zq),providedIn:"root"});let n=e;return n})(),Tw=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},Zq=(()=>{let e=class e extends Tw{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ev(e)))(s||e)}})(),e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Wx=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:()=>G(Xq),providedIn:"root"});let n=e;return n})(),Xq=(()=>{let e=class e extends Wx{constructor(){super(...arguments),this.location=G(Na),this.urlSerializer=G(dl),this.options=G(gl,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=G(Rw),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Wi,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Nx(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof Ua)this.stateMemento=this.createStateMemento();else if(r instanceof Qi)this.rawUrlTree=i.initialUrl;else if(r instanceof sp){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof sl?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Ki&&(r.code===On.GuardRejected||r.code===On.NoDataFromResolver)?this.restoreHistory(i):r instanceof il?this.restoreHistory(i,!0):r instanceof mi&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=Q(Q({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=Q(Q({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ev(e)))(s||e)}})(),e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Xu=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Xu||{});function Kx(n,e){n.events.pipe(Qt(t=>t instanceof mi||t instanceof Ki||t instanceof il||t instanceof Qi),ee(t=>t instanceof mi||t instanceof Qi?Xu.COMPLETE:(t instanceof Ki?t.code===On.Redirect||t.code===On.SupersededByNewNavigation:!1)?Xu.REDIRECTING:Xu.FAILED),Qt(t=>t!==Xu.REDIRECTING),ui(1)).subscribe(()=>{e()})}function Jq(n){throw n}var eH={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},tH={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},co=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=G($f),this.stateManager=G(Wx),this.options=G(gl,{optional:!0})||{},this.pendingTasks=G(jf),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=G(xw),this.urlSerializer=G(dl),this.location=G(Na),this.urlHandlingStrategy=G(Rw),this._events=new yt,this.errorHandler=this.options.errorHandler||Jq,this.navigated=!1,this.routeReuseStrategy=G(Yq),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=G(hp,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!G(pp,{optional:!0}),this.eventsSubscription=new mt,this.isNgZoneEnabled=G(De)instanceof De&&De.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Ki&&i.code!==On.Redirect&&i.code!==On.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof mi)this.navigated=!0;else if(i instanceof ol){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||Qq(s.source)};this.scheduleNavigation(a,el,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}rH(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),el,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=Q({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(bw),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,d=l?this.currentUrlTree.fragment:a,f=null;switch(c){case"merge":f=Q(Q({},this.currentUrlTree.queryParams),o);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=o||null}f!==null&&(f=this.removeEmptyProps(f));let g;try{let y=s?s.snapshot:this.routerState.snapshot.root;g=Ax(y)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),g=this.currentUrlTree.root}return Rx(g,r,f,d??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=Va(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,el,null,i)}navigate(r,i={skipLocationChange:!1}){return nH(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=Q({},eH):i===!1?s=Q({},tH):s=i,Va(r))return lx(this.currentUrlTree,r,s);let o=this.parseUrl(r);return lx(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,d;a?(c=a.resolve,l=a.reject,d=a.promise):d=new Promise((g,y)=>{c=g,l=y});let f=this.pendingTasks.add();return Kx(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:l,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(g=>Promise.reject(g))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function nH(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new se(4008,!1)}function rH(n){return!(n instanceof sl)&&!(n instanceof ol)}var fp=class{};var iH=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Qt(r=>r instanceof mi),$s(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=Uf(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return Ae(s).pipe(Oi())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=ne(null);let o=s.pipe(Dt(a=>a===null?ne(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return Ae([o,a]).pipe(Oi())}else return o})}};e.\u0275fac=function(i){return new(i||e)(F(co),F(Gf),F(Dn),F(fp),F(Aw))},e.\u0275prov=J({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})(),Qx=new K(""),sH=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=G(Dn),a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Ua?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof mi?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Qi&&r.code===ip.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof op&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>M(this,null,function*(){yield new Promise(s=>{setTimeout(()=>{s()}),Vf(()=>{s()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new op(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){JA()},e.\u0275prov=J({token:e,factory:e.\u0275fac});let n=e;return n})();function oH(n){return n.routerState.root}function ml(n,e){return{\u0275kind:n,\u0275providers:e}}function aH(){let n=G(Nr);return e=>{let t=n.get(Ma);if(e!==t.components[0])return;let r=n.get(co),i=n.get(Yx);n.get(Mw)===1&&r.initialNavigation(),n.get(Zx,null,Ce.Optional)?.setUpPreloading(),n.get(Qx,null,Ce.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var Yx=new K("",{factory:()=>new yt}),Mw=new K("",{providedIn:"root",factory:()=>1});function cH(){return ml(2,[{provide:Mw,useValue:0},{provide:zf,multi:!0,deps:[Nr],useFactory:e=>{let t=e.get(qR,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=e.get(co),s=e.get(Yx);Kx(i,()=>{r(!0)}),e.get(xw).afterPreactivation=()=>(r(!0),s.closed?ne(void 0):s),i.initialNavigation()}))}}])}function uH(){return ml(3,[{provide:zf,multi:!0,useFactory:()=>{let e=G(co);return()=>{e.setUpLocationChangeListener()}}},{provide:Mw,useValue:2}])}var Zx=new K("");function lH(n){return ml(0,[{provide:Zx,useExisting:iH},{provide:fp,useExisting:n}])}function dH(){return ml(8,[px,{provide:pp,useExisting:px}])}function hH(n){let e=[{provide:zx,useValue:Wq},{provide:Gx,useValue:Q({skipNextTransition:!!n?.skipInitialTransition},n)}];return ml(9,e)}var mx=new K("ROUTER_FORROOT_GUARD"),fH=[Na,{provide:dl,useClass:nl},co,hl,{provide:ja,useFactory:oH,deps:[co]},Aw,[]],Nw=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[fH,[],{provide:hp,multi:!0,useValue:r},{provide:mx,useFactory:yH,deps:[[co,new Xs,new Tf]]},{provide:gl,useValue:i||{}},i?.useHash?gH():mH(),pH(),i?.preloadingStrategy?lH(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?_H(i):[],i?.bindToComponentInputs?dH().\u0275providers:[],i?.enableViewTransitions?hH().\u0275providers:[],vH()]}}static forChild(r){return{ngModule:e,providers:[{provide:hp,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(F(mx,8))},e.\u0275mod=vt({type:e}),e.\u0275inj=_t({});let n=e;return n})();function pH(){return{provide:Qx,useFactory:()=>{let n=G(XR),e=G(De),t=G(gl),r=G(xw),i=G(dl);return t.scrollOffset&&n.setOffset(t.scrollOffset),new sH(i,r,n,e,t)}}}function gH(){return{provide:io,useClass:zR}}function mH(){return{provide:io,useClass:Vv}}function yH(n){return"guarded"}function _H(n){return[n.initialNavigation==="disabled"?uH().\u0275providers:[],n.initialNavigation==="enabledBlocking"?cH().\u0275providers:[]]}var yx=new K("");function vH(){return[{provide:yx,useFactory:aH},{provide:Tv,multi:!0,useExisting:yx}]}var wH=[],Xx=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=vt({type:e}),e.\u0275inj=_t({imports:[Nw.forRoot(wH),Nw]});let n=e;return n})();var Pw={};(function n(e,t,r,i){var s=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),o=typeof Path2D=="function"&&typeof DOMMatrix=="function",a=function(){if(!e.OffscreenCanvas)return!1;var N=new OffscreenCanvas(1,1),D=N.getContext("2d");D.fillRect(0,0,1,1);var X=N.transferToImageBitmap();try{D.createPattern(X,"no-repeat")}catch{return!1}return!0}();function c(){}function l(N){var D=t.exports.Promise,X=D!==void 0?D:e.Promise;return typeof X=="function"?new X(N):(N(c,c),null)}var d=function(N,D){return{transform:function(X){if(N)return X;if(D.has(X))return D.get(X);var Y=new OffscreenCanvas(X.width,X.height),ye=Y.getContext("2d");return ye.drawImage(X,0,0),D.set(X,Y),Y},clear:function(){D.clear()}}}(a,new Map),f=function(){var N=Math.floor(16.666666666666668),D,X,Y={},ye=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(D=function(fe){var Ie=Math.random();return Y[Ie]=requestAnimationFrame(function oe(Te){ye===Te||ye+N-1<Te?(ye=Te,delete Y[Ie],fe()):Y[Ie]=requestAnimationFrame(oe)}),Ie},X=function(fe){Y[fe]&&cancelAnimationFrame(Y[fe])}):(D=function(fe){return setTimeout(fe,N)},X=function(fe){return clearTimeout(fe)}),{frame:D,cancel:X}}(),g=function(){var N,D,X={};function Y(ye){function fe(Ie,oe){ye.postMessage({options:Ie||{},callback:oe})}ye.init=function(oe){var Te=oe.transferControlToOffscreen();ye.postMessage({canvas:Te},[Te])},ye.fire=function(oe,Te,$e){if(D)return fe(oe,null),D;var qe=Math.random().toString(36).slice(2);return D=l(function(Ue){function Qe(gt){gt.data.callback===qe&&(delete X[qe],ye.removeEventListener("message",Qe),D=null,d.clear(),$e(),Ue())}ye.addEventListener("message",Qe),fe(oe,qe),X[qe]=Qe.bind(null,{data:{callback:qe}})}),D},ye.reset=function(){ye.postMessage({reset:!0});for(var oe in X)X[oe](),delete X[oe]}}return function(){if(N)return N;if(!r&&s){var ye=["var CONFETTI, SIZE = {}, module = {};","("+n.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{N=new Worker(URL.createObjectURL(new Blob([ye])))}catch(fe){return typeof console!==void 0&&typeof console.warn=="function"&&console.warn("\u{1F38A} Could not load worker",fe),null}Y(N)}return N}}(),y={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function v(N,D){return D?D(N):N}function b(N){return N!=null}function C(N,D,X){return v(N&&b(N[D])?N[D]:y[D],X)}function V(N){return N<0?0:Math.floor(N)}function B(N,D){return Math.floor(Math.random()*(D-N))+N}function O(N){return parseInt(N,16)}function z(N){return N.map(re)}function re(N){var D=String(N).replace(/[^0-9a-f]/gi,"");return D.length<6&&(D=D[0]+D[0]+D[1]+D[1]+D[2]+D[2]),{r:O(D.substring(0,2)),g:O(D.substring(2,4)),b:O(D.substring(4,6))}}function Z(N){var D=C(N,"origin",Object);return D.x=C(D,"x",Number),D.y=C(D,"y",Number),D}function I(N){N.width=document.documentElement.clientWidth,N.height=document.documentElement.clientHeight}function _(N){var D=N.getBoundingClientRect();N.width=D.width,N.height=D.height}function w(N){var D=document.createElement("canvas");return D.style.position="fixed",D.style.top="0px",D.style.left="0px",D.style.pointerEvents="none",D.style.zIndex=N,D}function T(N,D,X,Y,ye,fe,Ie,oe,Te){N.save(),N.translate(D,X),N.rotate(fe),N.scale(Y,ye),N.arc(0,0,1,Ie,oe,Te),N.restore()}function S(N){var D=N.angle*(Math.PI/180),X=N.spread*(Math.PI/180);return{x:N.x,y:N.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:N.startVelocity*.5+Math.random()*N.startVelocity,angle2D:-D+(.5*X-Math.random()*X),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:N.color,shape:N.shape,tick:0,totalTicks:N.ticks,decay:N.decay,drift:N.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:N.gravity*3,ovalScalar:.6,scalar:N.scalar,flat:N.flat}}function R(N,D){D.x+=Math.cos(D.angle2D)*D.velocity+D.drift,D.y+=Math.sin(D.angle2D)*D.velocity+D.gravity,D.velocity*=D.decay,D.flat?(D.wobble=0,D.wobbleX=D.x+10*D.scalar,D.wobbleY=D.y+10*D.scalar,D.tiltSin=0,D.tiltCos=0,D.random=1):(D.wobble+=D.wobbleSpeed,D.wobbleX=D.x+10*D.scalar*Math.cos(D.wobble),D.wobbleY=D.y+10*D.scalar*Math.sin(D.wobble),D.tiltAngle+=.1,D.tiltSin=Math.sin(D.tiltAngle),D.tiltCos=Math.cos(D.tiltAngle),D.random=Math.random()+2);var X=D.tick++/D.totalTicks,Y=D.x+D.random*D.tiltCos,ye=D.y+D.random*D.tiltSin,fe=D.wobbleX+D.random*D.tiltCos,Ie=D.wobbleY+D.random*D.tiltSin;if(N.fillStyle="rgba("+D.color.r+", "+D.color.g+", "+D.color.b+", "+(1-X)+")",N.beginPath(),o&&D.shape.type==="path"&&typeof D.shape.path=="string"&&Array.isArray(D.shape.matrix))N.fill(xs(D.shape.path,D.shape.matrix,D.x,D.y,Math.abs(fe-Y)*.1,Math.abs(Ie-ye)*.1,Math.PI/10*D.wobble));else if(D.shape.type==="bitmap"){var oe=Math.PI/10*D.wobble,Te=Math.abs(fe-Y)*.1,$e=Math.abs(Ie-ye)*.1,qe=D.shape.bitmap.width*D.scalar,Ue=D.shape.bitmap.height*D.scalar,Qe=new DOMMatrix([Math.cos(oe)*Te,Math.sin(oe)*Te,-Math.sin(oe)*$e,Math.cos(oe)*$e,D.x,D.y]);Qe.multiplySelf(new DOMMatrix(D.shape.matrix));var gt=N.createPattern(d.transform(D.shape.bitmap),"no-repeat");gt.setTransform(Qe),N.globalAlpha=1-X,N.fillStyle=gt,N.fillRect(D.x-qe/2,D.y-Ue/2,qe,Ue),N.globalAlpha=1}else if(D.shape==="circle")N.ellipse?N.ellipse(D.x,D.y,Math.abs(fe-Y)*D.ovalScalar,Math.abs(Ie-ye)*D.ovalScalar,Math.PI/10*D.wobble,0,2*Math.PI):T(N,D.x,D.y,Math.abs(fe-Y)*D.ovalScalar,Math.abs(Ie-ye)*D.ovalScalar,Math.PI/10*D.wobble,0,2*Math.PI);else if(D.shape==="star")for(var Se=Math.PI/2*3,Lt=4*D.scalar,_n=8*D.scalar,vn=D.x,rr=D.y,wr=5,Rn=Math.PI/wr;wr--;)vn=D.x+Math.cos(Se)*_n,rr=D.y+Math.sin(Se)*_n,N.lineTo(vn,rr),Se+=Rn,vn=D.x+Math.cos(Se)*Lt,rr=D.y+Math.sin(Se)*Lt,N.lineTo(vn,rr),Se+=Rn;else N.moveTo(Math.floor(D.x),Math.floor(D.y)),N.lineTo(Math.floor(D.wobbleX),Math.floor(ye)),N.lineTo(Math.floor(fe),Math.floor(Ie)),N.lineTo(Math.floor(Y),Math.floor(D.wobbleY));return N.closePath(),N.fill(),D.tick<D.totalTicks}function E(N,D,X,Y,ye){var fe=D.slice(),Ie=N.getContext("2d"),oe,Te,$e=l(function(qe){function Ue(){oe=Te=null,Ie.clearRect(0,0,Y.width,Y.height),d.clear(),ye(),qe()}function Qe(){r&&!(Y.width===i.width&&Y.height===i.height)&&(Y.width=N.width=i.width,Y.height=N.height=i.height),!Y.width&&!Y.height&&(X(N),Y.width=N.width,Y.height=N.height),Ie.clearRect(0,0,Y.width,Y.height),fe=fe.filter(function(gt){return R(Ie,gt)}),fe.length?oe=f.frame(Qe):Ue()}oe=f.frame(Qe),Te=Ue});return{addFettis:function(qe){return fe=fe.concat(qe),$e},canvas:N,promise:$e,reset:function(){oe&&f.cancel(oe),Te&&Te()}}}function qn(N,D){var X=!N,Y=!!C(D||{},"resize"),ye=!1,fe=C(D,"disableForReducedMotion",Boolean),Ie=s&&!!C(D||{},"useWorker"),oe=Ie?g():null,Te=X?I:_,$e=N&&oe?!!N.__confetti_initialized:!1,qe=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,Ue;function Qe(Se,Lt,_n){for(var vn=C(Se,"particleCount",V),rr=C(Se,"angle",Number),wr=C(Se,"spread",Number),Rn=C(Se,"startVelocity",Number),nu=C(Se,"decay",Number),Jd=C(Se,"gravity",Number),Km=C(Se,"drift",Number),Wo=C(Se,"colors",z),ru=C(Se,"ticks",Number),Ko=C(Se,"shapes"),Vt=C(Se,"scalar"),Ht=!!C(Se,"flat"),Ns=Z(Se),iu=vn,Qo=[],Qm=N.width*Ns.x,Ps=N.height*Ns.y;iu--;)Qo.push(S({x:Qm,y:Ps,angle:rr,spread:wr,startVelocity:Rn,color:Wo[iu%Wo.length],shape:Ko[B(0,Ko.length)],ticks:ru,decay:nu,gravity:Jd,drift:Km,scalar:Vt,flat:Ht}));return Ue?Ue.addFettis(Qo):(Ue=E(N,Qo,Te,Lt,_n),Ue.promise)}function gt(Se){var Lt=fe||C(Se,"disableForReducedMotion",Boolean),_n=C(Se,"zIndex",Number);if(Lt&&qe)return l(function(Rn){Rn()});X&&Ue?N=Ue.canvas:X&&!N&&(N=w(_n),document.body.appendChild(N)),Y&&!$e&&Te(N);var vn={width:N.width,height:N.height};oe&&!$e&&oe.init(N),$e=!0,oe&&(N.__confetti_initialized=!0);function rr(){if(oe){var Rn={getBoundingClientRect:function(){if(!X)return N.getBoundingClientRect()}};Te(Rn),oe.postMessage({resize:{width:Rn.width,height:Rn.height}});return}vn.width=vn.height=null}function wr(){Ue=null,Y&&(ye=!1,e.removeEventListener("resize",rr)),X&&N&&(document.body.contains(N)&&document.body.removeChild(N),N=null,$e=!1)}return Y&&!ye&&(ye=!0,e.addEventListener("resize",rr,!1)),oe?oe.fire(Se,vn,wr):Qe(Se,vn,wr)}return gt.reset=function(){oe&&oe.reset(),Ue&&Ue.reset()},gt}var ni;function Xd(){return ni||(ni=qn(null,{useWorker:!0,resize:!0})),ni}function xs(N,D,X,Y,ye,fe,Ie){var oe=new Path2D(N),Te=new Path2D;Te.addPath(oe,new DOMMatrix(D));var $e=new Path2D;return $e.addPath(Te,new DOMMatrix([Math.cos(Ie)*ye,Math.sin(Ie)*ye,-Math.sin(Ie)*fe,Math.cos(Ie)*fe,X,Y])),$e}function Ms(N){if(!o)throw new Error("path confetti are not supported in this browser");var D,X;typeof N=="string"?D=N:(D=N.path,X=N.matrix);var Y=new Path2D(D),ye=document.createElement("canvas"),fe=ye.getContext("2d");if(!X){for(var Ie=1e3,oe=Ie,Te=Ie,$e=0,qe=0,Ue,Qe,gt=0;gt<Ie;gt+=2)for(var Se=0;Se<Ie;Se+=2)fe.isPointInPath(Y,gt,Se,"nonzero")&&(oe=Math.min(oe,gt),Te=Math.min(Te,Se),$e=Math.max($e,gt),qe=Math.max(qe,Se));Ue=$e-oe,Qe=qe-Te;var Lt=10,_n=Math.min(Lt/Ue,Lt/Qe);X=[_n,0,0,_n,-Math.round(Ue/2+oe)*_n,-Math.round(Qe/2+Te)*_n]}return{type:"path",path:D,matrix:X}}function tu(N){var D,X=1,Y="#000000",ye='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof N=="string"?D=N:(D=N.text,X="scalar"in N?N.scalar:X,ye="fontFamily"in N?N.fontFamily:ye,Y="color"in N?N.color:Y);var fe=10*X,Ie=""+fe+"px "+ye,oe=new OffscreenCanvas(fe,fe),Te=oe.getContext("2d");Te.font=Ie;var $e=Te.measureText(D),qe=Math.ceil($e.actualBoundingBoxRight+$e.actualBoundingBoxLeft),Ue=Math.ceil($e.actualBoundingBoxAscent+$e.actualBoundingBoxDescent),Qe=2,gt=$e.actualBoundingBoxLeft+Qe,Se=$e.actualBoundingBoxAscent+Qe;qe+=Qe+Qe,Ue+=Qe+Qe,oe=new OffscreenCanvas(qe,Ue),Te=oe.getContext("2d"),Te.font=Ie,Te.fillStyle=Y,Te.fillText(D,gt,Se);var Lt=1/X;return{type:"bitmap",bitmap:oe.transferToImageBitmap(),matrix:[Lt,0,0,Lt,-qe*Lt/2,-Ue*Lt/2]}}t.exports=function(){return Xd().apply(this,arguments)},t.exports.reset=function(){Xd().reset()},t.exports.create=qn,t.exports.shapeFromPath=Ms,t.exports.shapeFromText=tu})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),Pw,!1);var kw=Pw.exports,IJ=Pw.exports.create;var EH="firebase",IH="10.13.1";En(EH,IH,"app");var Fr=new Hi("ANGULARFIRE2_VERSION");var TH=(n,e)=>{let t=e?[e]:gb(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},dr=class{constructor(){return TH(CH)}},CH="app-check";function Ow(){}var mp=class{zone;delegate;constructor(e,t=My){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,t,r)}},Fw=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ow,{},Ow,Ow)),t.pipe(bt({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Zi=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new mp(Zone.current)),this.insideAngular=t.run(()=>new mp(Zone.current,ai)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(F(De))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Jx(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function Lw(n){return n.pipe(Mn(Jx().outsideAngular))}function it(n){return DH(Jx())(n)}function DH(n){return function(t){return t=t.lift(new Fw(n.ngZone)),t.pipe(or(n.outsideAngular),Mn(n.insideAngular))}}var bH=new Map,SH={activated:!1,tokenObservers:[]},AH={initialized:!1,enabled:!1};function hr(n){return bH.get(n)||Object.assign({},SH)}function iM(){return AH}var RH="https://content-firebaseappcheck.googleapis.com/v1";var xH="exchangeDebugToken",eM={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},jJ=24*60*60*1e3;var Uw=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return M(this,null,function*(){this.stop();try{this.pending=new Ut,this.pending.promise.catch(t=>{}),yield MH(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Ut,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function MH(n){return new Promise(e=>{setTimeout(e,n)})}var NH={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Xi=new ub("appCheck","AppCheck",NH);function sM(n){if(!hr(n).activated)throw Xi.create("use-before-activation",{appName:n.name})}function oM(r,i){return M(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},o=t.getImmediate({optional:!0});if(o){let y=yield o.getHeartbeatsHeader();y&&(s["X-Firebase-Client"]=y)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(n,a)}catch(y){throw Xi.create("fetch-network-error",{originalErrorMessage:y?.message})}if(c.status!==200)throw Xi.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(y){throw Xi.create("fetch-parse-error",{originalErrorMessage:y?.message})}let d=l.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw Xi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let f=Number(d[1])*1e3,g=Date.now();return{token:l.token,expireTimeMillis:g+f,issuedAtTimeMillis:g}})}function aM(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${RH}/projects/${t}/apps/${r}:${xH}?key=${i}`,body:{debug_token:e}}}var PH="firebase-app-check-database",kH=1,jw="firebase-app-check-store";var _p=null;function OH(){return _p||(_p=new Promise((n,e)=>{try{let t=indexedDB.open(PH,kH);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(Xi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(jw,{keyPath:"compositeKey"})}}}catch(t){e(Xi.create("storage-open",{originalErrorMessage:t?.message}))}}),_p)}function FH(n,e){return LH(VH(n),e)}function LH(n,e){return M(this,null,function*(){let r=(yield OH()).transaction(jw,"readwrite"),s=r.objectStore(jw).put({compositeKey:n,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var l;a(Xi.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function VH(n){return`${n.options.appId}-${n.name}`}var Bw=new ki("@firebase/app-check");function Vw(n,e){return mh()?FH(n,e).catch(t=>{Bw.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function cM(){return iM().enabled}function uM(){return M(this,null,function*(){let n=iM();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var UH={error:"UNKNOWN_ERROR"};function jH(n){return gh.encodeString(JSON.stringify(n),!1)}function $w(n,e=!1){return M(this,null,function*(){let t=n.app;sM(t);let r=hr(t),i=r.token,s;if(i&&!yl(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(yl(c)?i=c:yield Vw(t,void 0))}if(!e&&i&&yl(i))return{token:i.token};let o=!1;if(cM()){r.exchangeTokenPromise||(r.exchangeTokenPromise=oM(aM(t,yield uM()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let c=yield r.exchangeTokenPromise;return yield Vw(t,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield hr(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Bw.warn(c.message):Bw.error(c),s=c}let a;return i?s?yl(i)?a={token:i.token,internalError:s}:a=nM(s):(a={token:i.token},r.token=i,yield Vw(t,i)):a=nM(s),o&&HH(t,a),a})}function BH(n){return M(this,null,function*(){let e=n.app;sM(e);let{provider:t}=hr(e);if(cM()){let r=yield uM(),{token:i}=yield oM(aM(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function $H(n,e,t,r){let{app:i}=n,s=hr(i),o={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&yl(s.token)){let a=s.token;Promise.resolve().then(()=>{t({token:a.token}),tM(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>tM(n))}function lM(n,e){let t=hr(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function tM(n){let{app:e}=n,t=hr(e),r=t.tokenRefresher;r||(r=qH(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function qH(n){let{app:e}=n;return new Uw(()=>M(this,null,function*(){let t=hr(e),r;if(t.token?r=yield $w(n,!0):r=yield $w(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=hr(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},eM.RETRIAL_MIN_WAIT,eM.RETRIAL_MAX_WAIT)}function HH(n,e){let t=hr(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function yl(n){return n.expireTimeMillis-Date.now()>0}function nM(n){return{token:jH(UH),error:n}}var qw=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=hr(this.app);for(let t of e)lM(this.app,t.next);return Promise.resolve()}};function zH(n,e){return new qw(n,e)}function GH(n){return{getToken:e=>$w(n,e),getLimitedUseToken:()=>BH(n),addTokenListener:e=>$H(n,"INTERNAL",e),removeTokenListener:e=>lM(n.app,e)}}var WH="@firebase/app-check",KH="0.8.7";var QH="app-check",rM="app-check-internal";function YH(){si(new Gt(QH,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return zH(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(rM).initialize()})),si(new Gt(rM,n=>{let e=n.getProvider("app-check").getImmediate();return GH(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),En(WH,KH)}YH();var ZH=["localhost","0.0.0.0","127.0.0.1"],XJ=typeof window<"u"&&ZH.includes(window.location.hostname);var XH="firebase",JH="10.13.1";ft.registerVersion(XH,JH,"app-compat");var e4=["ngOnDestroy"],hM=(n,e,t,r={})=>new Proxy(n,{get:(i,s)=>t.runOutsideAngular(()=>{if(n[s])return r?.spy?.get&&r.spy.get(s,n[s]),n[s];if(e4.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let c=a?.[s];return typeof c=="function"?c.bind(a):c?.then?c.then(l=>t.run(()=>l)):t.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>o[c],apply:(a,c,l)=>o.then(d=>{let f=d?.(...l);return r?.spy?.apply&&r.spy.apply(s,l,f),f})})})});var wp=class{constructor(e){return e}},Lr=new K("angularfire2.app.options"),Vr=new K("angularfire2.app.name");function yi(n,e,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let o=ft.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>ft.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){let a=!!module.hot;t4("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new wp(o)}var t4=(n,...e)=>{bv()&&typeof console<"u"&&console[n](...e)},n4={provide:wp,useFactory:yi,deps:[Lr,De,[new Xs,Vr]]},fM=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:Lr,useValue:t},{provide:Vr,useValue:r}]}}constructor(t){ft.registerVersion("angularfire",Fr.full,"core"),ft.registerVersion("angularfire",Fr.full,"app-compat"),ft.registerVersion("angular",SR.full,t.toString())}static \u0275fac=function(r){return new(r||n)(F(jt))};static \u0275mod=vt({type:n});static \u0275inj=_t({providers:[n4]})}return n})();function Ji(n,e,t,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(s)return r4(i,o)||(dM("error",`${e} was already initialized on the ${t} Firebase App with different settings.${i4?" You may need to reload as Firebase is not HMR aware.":""}`),dM("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}function r4(n,e){try{return n.toString()===e.toString()}catch{return n===e}}var i4=typeof module<"u"&&!!module.hot,dM=(n,...e)=>{bv()&&typeof console<"u"&&console[n](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var _l=new K("angularfire2.auth.use-emulator"),vl=new K("angularfire2.auth.settings"),wl=new K("angularfire2.auth.tenant-id"),El=new K("angularfire2.auth.langugage-code"),Il=new K("angularfire2.auth.use-device-language"),Tl=new K("angularfire.auth.persistence"),Cl=(n,e,t,r,i,s,o,a)=>Ji(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let c=e.runOutsideAngular(()=>n.auth());if(t&&c.useEmulator(...t),r&&(c.tenantId=r),c.languageCode=i,s&&c.useDeviceLanguage(),o)for(let[l,d]of Object.entries(o))c.settings[l]=d;return a&&c.setPersistence(a),c},[t,r,i,s,o,a]),Ep=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,s,o,a,c,l,d,f,g,y){let v=new yt,b=ne(void 0).pipe(Mn(o.outsideAngular),ze(()=>s.runOutsideAngular(()=>import("./chunk-LQGYCLSZ.js"))),ee(()=>yi(t,s,r)),ee(C=>Cl(C,s,a,l,d,f,c,g)),Hh({bufferSize:1,refCount:!1}));if(so(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=ne(null);else{b.pipe(Gn()).subscribe();let C=b.pipe(ze(O=>O.getRedirectResult().then(z=>z,()=>null)),it,Hh({bufferSize:1,refCount:!1})),V=b.pipe(ze(O=>new ve(z=>({unsubscribe:s.runOutsideAngular(()=>O.onAuthStateChanged(re=>z.next(re),re=>z.error(re),()=>z.complete()))})))),B=b.pipe(ze(O=>new ve(z=>({unsubscribe:s.runOutsideAngular(()=>O.onIdTokenChanged(re=>z.next(re),re=>z.error(re),()=>z.complete()))}))));this.authState=C.pipe(zh(V),or(o.outsideAngular),Mn(o.insideAngular)),this.user=C.pipe(zh(B),or(o.outsideAngular),Mn(o.insideAngular)),this.idToken=this.user.pipe(ze(O=>O?Ae(O.getIdToken()):ne(null))),this.idTokenResult=this.user.pipe(ze(O=>O?Ae(O.getIdTokenResult()):ne(null))),this.credential=pa(C,v,this.authState.pipe(Qt(O=>!O))).pipe(ee(O=>O?.user?O:null),or(o.outsideAngular),Mn(o.insideAngular))}return hM(this,b,s,{spy:{apply:(C,V,B)=>{(C.startsWith("signIn")||C.startsWith("createUser"))&&B.then(O=>v.next(O))}}})}static \u0275fac=function(r){return new(r||n)(F(Lr),F(Vr,8),F(jt),F(De),F(Zi),F(_l,8),F(vl,8),F(wl,8),F(El,8),F(Il,8),F(Tl,8),F(dr,8))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var gM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},mM={};var es,Gw;(function(){var n;function e(I,_){function w(){}w.prototype=_.prototype,I.D=_.prototype,I.prototype=new w,I.prototype.constructor=I,I.C=function(T,S,R){for(var E=Array(arguments.length-2),qn=2;qn<arguments.length;qn++)E[qn-2]=arguments[qn];return _.prototype[S].apply(T,E)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,_,w){w||(w=0);var T=Array(16);if(typeof _=="string")for(var S=0;16>S;++S)T[S]=_.charCodeAt(w++)|_.charCodeAt(w++)<<8|_.charCodeAt(w++)<<16|_.charCodeAt(w++)<<24;else for(S=0;16>S;++S)T[S]=_[w++]|_[w++]<<8|_[w++]<<16|_[w++]<<24;_=I.g[0],w=I.g[1],S=I.g[2];var R=I.g[3],E=_+(R^w&(S^R))+T[0]+3614090360&4294967295;_=w+(E<<7&4294967295|E>>>25),E=R+(S^_&(w^S))+T[1]+3905402710&4294967295,R=_+(E<<12&4294967295|E>>>20),E=S+(w^R&(_^w))+T[2]+606105819&4294967295,S=R+(E<<17&4294967295|E>>>15),E=w+(_^S&(R^_))+T[3]+3250441966&4294967295,w=S+(E<<22&4294967295|E>>>10),E=_+(R^w&(S^R))+T[4]+4118548399&4294967295,_=w+(E<<7&4294967295|E>>>25),E=R+(S^_&(w^S))+T[5]+1200080426&4294967295,R=_+(E<<12&4294967295|E>>>20),E=S+(w^R&(_^w))+T[6]+2821735955&4294967295,S=R+(E<<17&4294967295|E>>>15),E=w+(_^S&(R^_))+T[7]+4249261313&4294967295,w=S+(E<<22&4294967295|E>>>10),E=_+(R^w&(S^R))+T[8]+1770035416&4294967295,_=w+(E<<7&4294967295|E>>>25),E=R+(S^_&(w^S))+T[9]+2336552879&4294967295,R=_+(E<<12&4294967295|E>>>20),E=S+(w^R&(_^w))+T[10]+4294925233&4294967295,S=R+(E<<17&4294967295|E>>>15),E=w+(_^S&(R^_))+T[11]+2304563134&4294967295,w=S+(E<<22&4294967295|E>>>10),E=_+(R^w&(S^R))+T[12]+1804603682&4294967295,_=w+(E<<7&4294967295|E>>>25),E=R+(S^_&(w^S))+T[13]+4254626195&4294967295,R=_+(E<<12&4294967295|E>>>20),E=S+(w^R&(_^w))+T[14]+2792965006&4294967295,S=R+(E<<17&4294967295|E>>>15),E=w+(_^S&(R^_))+T[15]+1236535329&4294967295,w=S+(E<<22&4294967295|E>>>10),E=_+(S^R&(w^S))+T[1]+4129170786&4294967295,_=w+(E<<5&4294967295|E>>>27),E=R+(w^S&(_^w))+T[6]+3225465664&4294967295,R=_+(E<<9&4294967295|E>>>23),E=S+(_^w&(R^_))+T[11]+643717713&4294967295,S=R+(E<<14&4294967295|E>>>18),E=w+(R^_&(S^R))+T[0]+3921069994&4294967295,w=S+(E<<20&4294967295|E>>>12),E=_+(S^R&(w^S))+T[5]+3593408605&4294967295,_=w+(E<<5&4294967295|E>>>27),E=R+(w^S&(_^w))+T[10]+38016083&4294967295,R=_+(E<<9&4294967295|E>>>23),E=S+(_^w&(R^_))+T[15]+3634488961&4294967295,S=R+(E<<14&4294967295|E>>>18),E=w+(R^_&(S^R))+T[4]+3889429448&4294967295,w=S+(E<<20&4294967295|E>>>12),E=_+(S^R&(w^S))+T[9]+568446438&4294967295,_=w+(E<<5&4294967295|E>>>27),E=R+(w^S&(_^w))+T[14]+3275163606&4294967295,R=_+(E<<9&4294967295|E>>>23),E=S+(_^w&(R^_))+T[3]+4107603335&4294967295,S=R+(E<<14&4294967295|E>>>18),E=w+(R^_&(S^R))+T[8]+1163531501&4294967295,w=S+(E<<20&4294967295|E>>>12),E=_+(S^R&(w^S))+T[13]+2850285829&4294967295,_=w+(E<<5&4294967295|E>>>27),E=R+(w^S&(_^w))+T[2]+4243563512&4294967295,R=_+(E<<9&4294967295|E>>>23),E=S+(_^w&(R^_))+T[7]+1735328473&4294967295,S=R+(E<<14&4294967295|E>>>18),E=w+(R^_&(S^R))+T[12]+2368359562&4294967295,w=S+(E<<20&4294967295|E>>>12),E=_+(w^S^R)+T[5]+4294588738&4294967295,_=w+(E<<4&4294967295|E>>>28),E=R+(_^w^S)+T[8]+2272392833&4294967295,R=_+(E<<11&4294967295|E>>>21),E=S+(R^_^w)+T[11]+1839030562&4294967295,S=R+(E<<16&4294967295|E>>>16),E=w+(S^R^_)+T[14]+4259657740&4294967295,w=S+(E<<23&4294967295|E>>>9),E=_+(w^S^R)+T[1]+2763975236&4294967295,_=w+(E<<4&4294967295|E>>>28),E=R+(_^w^S)+T[4]+1272893353&4294967295,R=_+(E<<11&4294967295|E>>>21),E=S+(R^_^w)+T[7]+4139469664&4294967295,S=R+(E<<16&4294967295|E>>>16),E=w+(S^R^_)+T[10]+3200236656&4294967295,w=S+(E<<23&4294967295|E>>>9),E=_+(w^S^R)+T[13]+681279174&4294967295,_=w+(E<<4&4294967295|E>>>28),E=R+(_^w^S)+T[0]+3936430074&4294967295,R=_+(E<<11&4294967295|E>>>21),E=S+(R^_^w)+T[3]+3572445317&4294967295,S=R+(E<<16&4294967295|E>>>16),E=w+(S^R^_)+T[6]+76029189&4294967295,w=S+(E<<23&4294967295|E>>>9),E=_+(w^S^R)+T[9]+3654602809&4294967295,_=w+(E<<4&4294967295|E>>>28),E=R+(_^w^S)+T[12]+3873151461&4294967295,R=_+(E<<11&4294967295|E>>>21),E=S+(R^_^w)+T[15]+530742520&4294967295,S=R+(E<<16&4294967295|E>>>16),E=w+(S^R^_)+T[2]+3299628645&4294967295,w=S+(E<<23&4294967295|E>>>9),E=_+(S^(w|~R))+T[0]+4096336452&4294967295,_=w+(E<<6&4294967295|E>>>26),E=R+(w^(_|~S))+T[7]+1126891415&4294967295,R=_+(E<<10&4294967295|E>>>22),E=S+(_^(R|~w))+T[14]+2878612391&4294967295,S=R+(E<<15&4294967295|E>>>17),E=w+(R^(S|~_))+T[5]+4237533241&4294967295,w=S+(E<<21&4294967295|E>>>11),E=_+(S^(w|~R))+T[12]+1700485571&4294967295,_=w+(E<<6&4294967295|E>>>26),E=R+(w^(_|~S))+T[3]+2399980690&4294967295,R=_+(E<<10&4294967295|E>>>22),E=S+(_^(R|~w))+T[10]+4293915773&4294967295,S=R+(E<<15&4294967295|E>>>17),E=w+(R^(S|~_))+T[1]+2240044497&4294967295,w=S+(E<<21&4294967295|E>>>11),E=_+(S^(w|~R))+T[8]+1873313359&4294967295,_=w+(E<<6&4294967295|E>>>26),E=R+(w^(_|~S))+T[15]+4264355552&4294967295,R=_+(E<<10&4294967295|E>>>22),E=S+(_^(R|~w))+T[6]+2734768916&4294967295,S=R+(E<<15&4294967295|E>>>17),E=w+(R^(S|~_))+T[13]+1309151649&4294967295,w=S+(E<<21&4294967295|E>>>11),E=_+(S^(w|~R))+T[4]+4149444226&4294967295,_=w+(E<<6&4294967295|E>>>26),E=R+(w^(_|~S))+T[11]+3174756917&4294967295,R=_+(E<<10&4294967295|E>>>22),E=S+(_^(R|~w))+T[2]+718787259&4294967295,S=R+(E<<15&4294967295|E>>>17),E=w+(R^(S|~_))+T[9]+3951481745&4294967295,I.g[0]=I.g[0]+_&4294967295,I.g[1]=I.g[1]+(S+(E<<21&4294967295|E>>>11))&4294967295,I.g[2]=I.g[2]+S&4294967295,I.g[3]=I.g[3]+R&4294967295}r.prototype.u=function(I,_){_===void 0&&(_=I.length);for(var w=_-this.blockSize,T=this.B,S=this.h,R=0;R<_;){if(S==0)for(;R<=w;)i(this,I,R),R+=this.blockSize;if(typeof I=="string"){for(;R<_;)if(T[S++]=I.charCodeAt(R++),S==this.blockSize){i(this,T),S=0;break}}else for(;R<_;)if(T[S++]=I[R++],S==this.blockSize){i(this,T),S=0;break}}this.h=S,this.o+=_},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var _=1;_<I.length-8;++_)I[_]=0;var w=8*this.o;for(_=I.length-8;_<I.length;++_)I[_]=w&255,w/=256;for(this.u(I),I=Array(16),_=w=0;4>_;++_)for(var T=0;32>T;T+=8)I[w++]=this.g[_]>>>T&255;return I};function s(I,_){var w=a;return Object.prototype.hasOwnProperty.call(w,I)?w[I]:w[I]=_(I)}function o(I,_){this.h=_;for(var w=[],T=!0,S=I.length-1;0<=S;S--){var R=I[S]|0;T&&R==_||(w[S]=R,T=!1)}this.g=w}var a={};function c(I){return-128<=I&&128>I?s(I,function(_){return new o([_|0],0>_?-1:0)}):new o([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return f;if(0>I)return C(l(-I));for(var _=[],w=1,T=0;I>=w;T++)_[T]=I/w|0,w*=4294967296;return new o(_,0)}function d(I,_){if(I.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(I.charAt(0)=="-")return C(d(I.substring(1),_));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=l(Math.pow(_,8)),T=f,S=0;S<I.length;S+=8){var R=Math.min(8,I.length-S),E=parseInt(I.substring(S,S+R),_);8>R?(R=l(Math.pow(_,R)),T=T.j(R).add(l(E))):(T=T.j(w),T=T.add(l(E)))}return T}var f=c(0),g=c(1),y=c(16777216);n=o.prototype,n.m=function(){if(b(this))return-C(this).m();for(var I=0,_=1,w=0;w<this.g.length;w++){var T=this.i(w);I+=(0<=T?T:4294967296+T)*_,_*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(v(this))return"0";if(b(this))return"-"+C(this).toString(I);for(var _=l(Math.pow(I,6)),w=this,T="";;){var S=z(w,_).g;w=V(w,S.j(_));var R=((0<w.g.length?w.g[0]:w.h)>>>0).toString(I);if(w=S,v(w))return R+T;for(;6>R.length;)R="0"+R;T=R+T}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function v(I){if(I.h!=0)return!1;for(var _=0;_<I.g.length;_++)if(I.g[_]!=0)return!1;return!0}function b(I){return I.h==-1}n.l=function(I){return I=V(this,I),b(I)?-1:v(I)?0:1};function C(I){for(var _=I.g.length,w=[],T=0;T<_;T++)w[T]=~I.g[T];return new o(w,~I.h).add(g)}n.abs=function(){return b(this)?C(this):this},n.add=function(I){for(var _=Math.max(this.g.length,I.g.length),w=[],T=0,S=0;S<=_;S++){var R=T+(this.i(S)&65535)+(I.i(S)&65535),E=(R>>>16)+(this.i(S)>>>16)+(I.i(S)>>>16);T=E>>>16,R&=65535,E&=65535,w[S]=E<<16|R}return new o(w,w[w.length-1]&-2147483648?-1:0)};function V(I,_){return I.add(C(_))}n.j=function(I){if(v(this)||v(I))return f;if(b(this))return b(I)?C(this).j(C(I)):C(C(this).j(I));if(b(I))return C(this.j(C(I)));if(0>this.l(y)&&0>I.l(y))return l(this.m()*I.m());for(var _=this.g.length+I.g.length,w=[],T=0;T<2*_;T++)w[T]=0;for(T=0;T<this.g.length;T++)for(var S=0;S<I.g.length;S++){var R=this.i(T)>>>16,E=this.i(T)&65535,qn=I.i(S)>>>16,ni=I.i(S)&65535;w[2*T+2*S]+=E*ni,B(w,2*T+2*S),w[2*T+2*S+1]+=R*ni,B(w,2*T+2*S+1),w[2*T+2*S+1]+=E*qn,B(w,2*T+2*S+1),w[2*T+2*S+2]+=R*qn,B(w,2*T+2*S+2)}for(T=0;T<_;T++)w[T]=w[2*T+1]<<16|w[2*T];for(T=_;T<2*_;T++)w[T]=0;return new o(w,0)};function B(I,_){for(;(I[_]&65535)!=I[_];)I[_+1]+=I[_]>>>16,I[_]&=65535,_++}function O(I,_){this.g=I,this.h=_}function z(I,_){if(v(_))throw Error("division by zero");if(v(I))return new O(f,f);if(b(I))return _=z(C(I),_),new O(C(_.g),C(_.h));if(b(_))return _=z(I,C(_)),new O(C(_.g),_.h);if(30<I.g.length){if(b(I)||b(_))throw Error("slowDivide_ only works with positive integers.");for(var w=g,T=_;0>=T.l(I);)w=re(w),T=re(T);var S=Z(w,1),R=Z(T,1);for(T=Z(T,2),w=Z(w,2);!v(T);){var E=R.add(T);0>=E.l(I)&&(S=S.add(w),R=E),T=Z(T,1),w=Z(w,1)}return _=V(I,S.j(_)),new O(S,_)}for(S=f;0<=I.l(_);){for(w=Math.max(1,Math.floor(I.m()/_.m())),T=Math.ceil(Math.log(w)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),R=l(w),E=R.j(_);b(E)||0<E.l(I);)w-=T,R=l(w),E=R.j(_);v(R)&&(R=g),S=S.add(R),I=V(I,E)}return new O(S,I)}n.A=function(I){return z(this,I).h},n.and=function(I){for(var _=Math.max(this.g.length,I.g.length),w=[],T=0;T<_;T++)w[T]=this.i(T)&I.i(T);return new o(w,this.h&I.h)},n.or=function(I){for(var _=Math.max(this.g.length,I.g.length),w=[],T=0;T<_;T++)w[T]=this.i(T)|I.i(T);return new o(w,this.h|I.h)},n.xor=function(I){for(var _=Math.max(this.g.length,I.g.length),w=[],T=0;T<_;T++)w[T]=this.i(T)^I.i(T);return new o(w,this.h^I.h)};function re(I){for(var _=I.g.length+1,w=[],T=0;T<_;T++)w[T]=I.i(T)<<1|I.i(T-1)>>>31;return new o(w,I.h)}function Z(I,_){var w=_>>5;_%=32;for(var T=I.g.length-w,S=[],R=0;R<T;R++)S[R]=0<_?I.i(R+w)>>>_|I.i(R+w+1)<<32-_:I.i(R+w);return new o(S,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Gw=mM.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=d,es=mM.Integer=o}).apply(typeof gM<"u"?gM:typeof self<"u"?self:typeof window<"u"?window:{});var Ip=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},_i={};var Ww,Kw,qa,Qw,Dl,Tp,Yw,Zw,Xw;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,h,p){return u==Array.prototype||u==Object.prototype||(u[h]=p.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ip=="object"&&Ip];for(var h=0;h<u.length;++h){var p=u[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function i(u,h){if(h)e:{var p=r;u=u.split(".");for(var m=0;m<u.length-1;m++){var A=u[m];if(!(A in p))break e;p=p[A]}u=u[u.length-1],m=p[u],h=h(m),h!=m&&h!=null&&e(p,u,{configurable:!0,writable:!0,value:h})}}function s(u,h){u instanceof String&&(u+="");var p=0,m=!1,A={next:function(){if(!m&&p<u.length){var k=p++;return{value:h(k,u[k]),done:!1}}return m=!0,{done:!0,value:void 0}}};return A[Symbol.iterator]=function(){return A},A}i("Array.prototype.values",function(u){return u||function(){return s(this,function(h,p){return p})}});var o=o||{},a=this||self;function c(u){var h=typeof u;return h=h!="object"?h:u?Array.isArray(u)?"array":h:"null",h=="array"||h=="object"&&typeof u.length=="number"}function l(u){var h=typeof u;return h=="object"&&u!=null||h=="function"}function d(u,h,p){return u.call.apply(u.bind,arguments)}function f(u,h,p){if(!u)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var A=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(A,m),u.apply(h,A)}}return function(){return u.apply(h,arguments)}}function g(u,h,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,g.apply(null,arguments)}function y(u,h){var p=Array.prototype.slice.call(arguments,1);return function(){var m=p.slice();return m.push.apply(m,arguments),u.apply(this,m)}}function v(u,h){function p(){}p.prototype=h.prototype,u.aa=h.prototype,u.prototype=new p,u.prototype.constructor=u,u.Qb=function(m,A,k){for(var $=Array(arguments.length-2),He=2;He<arguments.length;He++)$[He-2]=arguments[He];return h.prototype[A].apply(m,$)}}function b(u){let h=u.length;if(0<h){let p=Array(h);for(let m=0;m<h;m++)p[m]=u[m];return p}return[]}function C(u,h){for(let p=1;p<arguments.length;p++){let m=arguments[p];if(c(m)){let A=u.length||0,k=m.length||0;u.length=A+k;for(let $=0;$<k;$++)u[A+$]=m[$]}else u.push(m)}}class V{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function B(u){return/^[\s\xa0]*$/.test(u)}function O(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function z(u){return z[" "](u),u}z[" "]=function(){};var re=O().indexOf("Gecko")!=-1&&!(O().toLowerCase().indexOf("webkit")!=-1&&O().indexOf("Edge")==-1)&&!(O().indexOf("Trident")!=-1||O().indexOf("MSIE")!=-1)&&O().indexOf("Edge")==-1;function Z(u,h,p){for(let m in u)h.call(p,u[m],m,u)}function I(u,h){for(let p in u)h.call(void 0,u[p],p,u)}function _(u){let h={};for(let p in u)h[p]=u[p];return h}let w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(u,h){let p,m;for(let A=1;A<arguments.length;A++){m=arguments[A];for(p in m)u[p]=m[p];for(let k=0;k<w.length;k++)p=w[k],Object.prototype.hasOwnProperty.call(m,p)&&(u[p]=m[p])}}function S(u){var h=1;u=u.split(":");let p=[];for(;0<h&&u.length;)p.push(u.shift()),h--;return u.length&&p.push(u.join(":")),p}function R(u){a.setTimeout(()=>{throw u},0)}function E(){var u=tu;let h=null;return u.g&&(h=u.g,u.g=u.g.next,u.g||(u.h=null),h.next=null),h}class qn{constructor(){this.h=this.g=null}add(h,p){let m=ni.get();m.set(h,p),this.h?this.h.next=m:this.g=m,this.h=m}}var ni=new V(()=>new Xd,u=>u.reset());class Xd{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let xs,Ms=!1,tu=new qn,N=()=>{let u=a.Promise.resolve(void 0);xs=()=>{u.then(D)}};var D=()=>{for(var u;u=E();){try{u.h.call(u.g)}catch(p){R(p)}var h=ni;h.j(u),100>h.h&&(h.h++,u.next=h.g,h.g=u)}Ms=!1};function X(){this.s=this.s,this.C=this.C}X.prototype.s=!1,X.prototype.ma=function(){this.s||(this.s=!0,this.N())},X.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Y(u,h){this.type=u,this.g=this.target=h,this.defaultPrevented=!1}Y.prototype.h=function(){this.defaultPrevented=!0};var ye=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,h=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let p=()=>{};a.addEventListener("test",p,h),a.removeEventListener("test",p,h)}catch{}return u}();function fe(u,h){if(Y.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var p=this.type=u.type,m=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=h,h=u.relatedTarget){if(re){e:{try{z(h.nodeName);var A=!0;break e}catch{}A=!1}A||(h=null)}}else p=="mouseover"?h=u.fromElement:p=="mouseout"&&(h=u.toElement);this.relatedTarget=h,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:Ie[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&fe.aa.h.call(this)}}v(fe,Y);var Ie={2:"touch",3:"pen",4:"mouse"};fe.prototype.h=function(){fe.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var oe="closure_listenable_"+(1e6*Math.random()|0),Te=0;function $e(u,h,p,m,A){this.listener=u,this.proxy=null,this.src=h,this.type=p,this.capture=!!m,this.ha=A,this.key=++Te,this.da=this.fa=!1}function qe(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Ue(u){this.src=u,this.g={},this.h=0}Ue.prototype.add=function(u,h,p,m,A){var k=u.toString();u=this.g[k],u||(u=this.g[k]=[],this.h++);var $=gt(u,h,m,A);return-1<$?(h=u[$],p||(h.fa=!1)):(h=new $e(h,this.src,k,!!m,A),h.fa=p,u.push(h)),h};function Qe(u,h){var p=h.type;if(p in u.g){var m=u.g[p],A=Array.prototype.indexOf.call(m,h,void 0),k;(k=0<=A)&&Array.prototype.splice.call(m,A,1),k&&(qe(h),u.g[p].length==0&&(delete u.g[p],u.h--))}}function gt(u,h,p,m){for(var A=0;A<u.length;++A){var k=u[A];if(!k.da&&k.listener==h&&k.capture==!!p&&k.ha==m)return A}return-1}var Se="closure_lm_"+(1e6*Math.random()|0),Lt={};function _n(u,h,p,m,A){if(m&&m.once)return wr(u,h,p,m,A);if(Array.isArray(h)){for(var k=0;k<h.length;k++)_n(u,h[k],p,m,A);return null}return p=Ko(p),u&&u[oe]?u.K(h,p,l(m)?!!m.capture:!!m,A):vn(u,h,p,!1,m,A)}function vn(u,h,p,m,A,k){if(!h)throw Error("Invalid event type");var $=l(A)?!!A.capture:!!A,He=Wo(u);if(He||(u[Se]=He=new Ue(u)),p=He.add(h,p,m,$,k),p.proxy)return p;if(m=rr(),p.proxy=m,m.src=u,m.listener=p,u.addEventListener)ye||(A=$),A===void 0&&(A=!1),u.addEventListener(h.toString(),m,A);else if(u.attachEvent)u.attachEvent(Jd(h.toString()),m);else if(u.addListener&&u.removeListener)u.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return p}function rr(){function u(p){return h.call(u.src,u.listener,p)}let h=Km;return u}function wr(u,h,p,m,A){if(Array.isArray(h)){for(var k=0;k<h.length;k++)wr(u,h[k],p,m,A);return null}return p=Ko(p),u&&u[oe]?u.L(h,p,l(m)?!!m.capture:!!m,A):vn(u,h,p,!0,m,A)}function Rn(u,h,p,m,A){if(Array.isArray(h))for(var k=0;k<h.length;k++)Rn(u,h[k],p,m,A);else m=l(m)?!!m.capture:!!m,p=Ko(p),u&&u[oe]?(u=u.i,h=String(h).toString(),h in u.g&&(k=u.g[h],p=gt(k,p,m,A),-1<p&&(qe(k[p]),Array.prototype.splice.call(k,p,1),k.length==0&&(delete u.g[h],u.h--)))):u&&(u=Wo(u))&&(h=u.g[h.toString()],u=-1,h&&(u=gt(h,p,m,A)),(p=-1<u?h[u]:null)&&nu(p))}function nu(u){if(typeof u!="number"&&u&&!u.da){var h=u.src;if(h&&h[oe])Qe(h.i,u);else{var p=u.type,m=u.proxy;h.removeEventListener?h.removeEventListener(p,m,u.capture):h.detachEvent?h.detachEvent(Jd(p),m):h.addListener&&h.removeListener&&h.removeListener(m),(p=Wo(h))?(Qe(p,u),p.h==0&&(p.src=null,h[Se]=null)):qe(u)}}}function Jd(u){return u in Lt?Lt[u]:Lt[u]="on"+u}function Km(u,h){if(u.da)u=!0;else{h=new fe(h,this);var p=u.listener,m=u.ha||u.src;u.fa&&nu(u),u=p.call(m,h)}return u}function Wo(u){return u=u[Se],u instanceof Ue?u:null}var ru="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ko(u){return typeof u=="function"?u:(u[ru]||(u[ru]=function(h){return u.handleEvent(h)}),u[ru])}function Vt(){X.call(this),this.i=new Ue(this),this.M=this,this.F=null}v(Vt,X),Vt.prototype[oe]=!0,Vt.prototype.removeEventListener=function(u,h,p,m){Rn(this,u,h,p,m)};function Ht(u,h){var p,m=u.F;if(m)for(p=[];m;m=m.F)p.push(m);if(u=u.M,m=h.type||h,typeof h=="string")h=new Y(h,u);else if(h instanceof Y)h.target=h.target||u;else{var A=h;h=new Y(m,u),T(h,A)}if(A=!0,p)for(var k=p.length-1;0<=k;k--){var $=h.g=p[k];A=Ns($,m,!0,h)&&A}if($=h.g=u,A=Ns($,m,!0,h)&&A,A=Ns($,m,!1,h)&&A,p)for(k=0;k<p.length;k++)$=h.g=p[k],A=Ns($,m,!1,h)&&A}Vt.prototype.N=function(){if(Vt.aa.N.call(this),this.i){var u=this.i,h;for(h in u.g){for(var p=u.g[h],m=0;m<p.length;m++)qe(p[m]);delete u.g[h],u.h--}}this.F=null},Vt.prototype.K=function(u,h,p,m){return this.i.add(String(u),h,!1,p,m)},Vt.prototype.L=function(u,h,p,m){return this.i.add(String(u),h,!0,p,m)};function Ns(u,h,p,m){if(h=u.i.g[String(h)],!h)return!0;h=h.concat();for(var A=!0,k=0;k<h.length;++k){var $=h[k];if($&&!$.da&&$.capture==p){var He=$.listener,zt=$.ha||$.src;$.fa&&Qe(u.i,$),A=He.call(zt,m)!==!1&&A}}return A&&!m.defaultPrevented}function iu(u,h,p){if(typeof u=="function")p&&(u=g(u,p));else if(u&&typeof u.handleEvent=="function")u=g(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(u,h||0)}function Qo(u){u.g=iu(()=>{u.g=null,u.i&&(u.i=!1,Qo(u))},u.l);let h=u.h;u.h=null,u.m.apply(null,h)}class Qm extends X{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Qo(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ps(u){X.call(this),this.h=u,this.g={}}v(Ps,X);var l0=[];function d0(u){Z(u.g,function(h,p){this.g.hasOwnProperty(p)&&nu(h)},u),u.g={}}Ps.prototype.N=function(){Ps.aa.N.call(this),d0(this)},Ps.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ym=a.JSON.stringify,dL=a.JSON.parse,hL=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Zm(){}Zm.prototype.h=null;function h0(u){return u.h||(u.h=u.i())}function f0(){}var su={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Xm(){Y.call(this,"d")}v(Xm,Y);function Jm(){Y.call(this,"c")}v(Jm,Y);var ks={},p0=null;function eh(){return p0=p0||new Vt}ks.La="serverreachability";function g0(u){Y.call(this,ks.La,u)}v(g0,Y);function ou(u){let h=eh();Ht(h,new g0(h))}ks.STAT_EVENT="statevent";function m0(u,h){Y.call(this,ks.STAT_EVENT,u),this.stat=h}v(m0,Y);function an(u){let h=eh();Ht(h,new m0(h,u))}ks.Ma="timingevent";function y0(u,h){Y.call(this,ks.Ma,u),this.size=h}v(y0,Y);function au(u,h){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},h)}function cu(){this.g=!0}cu.prototype.xa=function(){this.g=!1};function fL(u,h,p,m,A,k){u.info(function(){if(u.g)if(k)for(var $="",He=k.split("&"),zt=0;zt<He.length;zt++){var Oe=He[zt].split("=");if(1<Oe.length){var Xt=Oe[0];Oe=Oe[1];var Jt=Xt.split("_");$=2<=Jt.length&&Jt[1]=="type"?$+(Xt+"="+Oe+"&"):$+(Xt+"=redacted&")}}else $=null;else $=k;return"XMLHTTP REQ ("+m+") [attempt "+A+"]: "+h+`
`+p+`
`+$})}function pL(u,h,p,m,A,k,$){u.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+A+"]: "+h+`
`+p+`
`+k+" "+$})}function Yo(u,h,p,m){u.info(function(){return"XMLHTTP TEXT ("+h+"): "+mL(u,p)+(m?" "+m:"")})}function gL(u,h){u.info(function(){return"TIMEOUT: "+h})}cu.prototype.info=function(){};function mL(u,h){if(!u.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(u=0;u<p.length;u++)if(Array.isArray(p[u])){var m=p[u];if(!(2>m.length)){var A=m[1];if(Array.isArray(A)&&!(1>A.length)){var k=A[0];if(k!="noop"&&k!="stop"&&k!="close")for(var $=1;$<A.length;$++)A[$]=""}}}}return Ym(p)}catch{return h}}var th={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},_0={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ey;function nh(){}v(nh,Zm),nh.prototype.g=function(){return new XMLHttpRequest},nh.prototype.i=function(){return{}},ey=new nh;function xi(u,h,p,m){this.j=u,this.i=h,this.l=p,this.R=m||1,this.U=new Ps(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new v0}function v0(){this.i=null,this.g="",this.h=!1}var w0={},ty={};function ny(u,h,p){u.L=1,u.v=oh(ri(h)),u.m=p,u.P=!0,E0(u,null)}function E0(u,h){u.F=Date.now(),rh(u),u.A=ri(u.v);var p=u.A,m=u.R;Array.isArray(m)||(m=[String(m)]),O0(p.i,"t",m),u.C=0,p=u.j.J,u.h=new v0,u.g=J0(u.j,p?h:null,!u.m),0<u.O&&(u.M=new Qm(g(u.Y,u,u.g),u.O)),h=u.U,p=u.g,m=u.ca;var A="readystatechange";Array.isArray(A)||(A&&(l0[0]=A.toString()),A=l0);for(var k=0;k<A.length;k++){var $=_n(p,A[k],m||h.handleEvent,!1,h.h||h);if(!$)break;h.g[$.key]=$}h=u.H?_(u.H):{},u.m?(u.u||(u.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,h)):(u.u="GET",u.g.ea(u.A,u.u,null,h)),ou(),fL(u.i,u.u,u.A,u.l,u.R,u.m)}xi.prototype.ca=function(u){u=u.target;let h=this.M;h&&ii(u)==3?h.j():this.Y(u)},xi.prototype.Y=function(u){try{if(u==this.g)e:{let Jt=ii(this.g);var h=this.g.Ba();let Jo=this.g.Z();if(!(3>Jt)&&(Jt!=3||this.g&&(this.h.h||this.g.oa()||$0(this.g)))){this.J||Jt!=4||h==7||(h==8||0>=Jo?ou(3):ou(2)),ry(this);var p=this.g.Z();this.X=p;t:if(I0(this)){var m=$0(this.g);u="";var A=m.length,k=ii(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Os(this),uu(this);var $="";break t}this.h.i=new a.TextDecoder}for(h=0;h<A;h++)this.h.h=!0,u+=this.h.i.decode(m[h],{stream:!(k&&h==A-1)});m.length=0,this.h.g+=u,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=p==200,pL(this.i,this.u,this.A,this.l,this.R,Jt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var He,zt=this.g;if((He=zt.g?zt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(He)){var Oe=He;break t}}Oe=null}if(p=Oe)Yo(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,iy(this,p);else{this.o=!1,this.s=3,an(12),Os(this),uu(this);break e}}if(this.P){p=!0;let ir;for(;!this.J&&this.C<$.length;)if(ir=yL(this,$),ir==ty){Jt==4&&(this.s=4,an(14),p=!1),Yo(this.i,this.l,null,"[Incomplete Response]");break}else if(ir==w0){this.s=4,an(15),Yo(this.i,this.l,$,"[Invalid Chunk]"),p=!1;break}else Yo(this.i,this.l,ir,null),iy(this,ir);if(I0(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Jt!=4||$.length!=0||this.h.h||(this.s=1,an(16),p=!1),this.o=this.o&&p,!p)Yo(this.i,this.l,$,"[Invalid Chunked Response]"),Os(this),uu(this);else if(0<$.length&&!this.W){this.W=!0;var Xt=this.j;Xt.g==this&&Xt.ba&&!Xt.M&&(Xt.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),ly(Xt),Xt.M=!0,an(11))}}else Yo(this.i,this.l,$,null),iy(this,$);Jt==4&&Os(this),this.o&&!this.J&&(Jt==4?Q0(this.j,this):(this.o=!1,rh(this)))}else kL(this.g),p==400&&0<$.indexOf("Unknown SID")?(this.s=3,an(12)):(this.s=0,an(13)),Os(this),uu(this)}}}catch{}finally{}};function I0(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function yL(u,h){var p=u.C,m=h.indexOf(`
`,p);return m==-1?ty:(p=Number(h.substring(p,m)),isNaN(p)?w0:(m+=1,m+p>h.length?ty:(h=h.slice(m,m+p),u.C=m+p,h)))}xi.prototype.cancel=function(){this.J=!0,Os(this)};function rh(u){u.S=Date.now()+u.I,T0(u,u.I)}function T0(u,h){if(u.B!=null)throw Error("WatchDog timer not null");u.B=au(g(u.ba,u),h)}function ry(u){u.B&&(a.clearTimeout(u.B),u.B=null)}xi.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(gL(this.i,this.A),this.L!=2&&(ou(),an(17)),Os(this),this.s=2,uu(this)):T0(this,this.S-u)};function uu(u){u.j.G==0||u.J||Q0(u.j,u)}function Os(u){ry(u);var h=u.M;h&&typeof h.ma=="function"&&h.ma(),u.M=null,d0(u.U),u.g&&(h=u.g,u.g=null,h.abort(),h.ma())}function iy(u,h){try{var p=u.j;if(p.G!=0&&(p.g==u||sy(p.h,u))){if(!u.K&&sy(p.h,u)&&p.G==3){try{var m=p.Da.g.parse(h)}catch{m=null}if(Array.isArray(m)&&m.length==3){var A=m;if(A[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<u.F)dh(p),uh(p);else break e;uy(p),an(18)}}else p.za=A[1],0<p.za-p.T&&37500>A[2]&&p.F&&p.v==0&&!p.C&&(p.C=au(g(p.Za,p),6e3));if(1>=b0(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Ls(p,11)}else if((u.K||p.g==u)&&dh(p),!B(h))for(A=p.Da.g.parse(h),h=0;h<A.length;h++){let Oe=A[h];if(p.T=Oe[0],Oe=Oe[1],p.G==2)if(Oe[0]=="c"){p.K=Oe[1],p.ia=Oe[2];let Xt=Oe[3];Xt!=null&&(p.la=Xt,p.j.info("VER="+p.la));let Jt=Oe[4];Jt!=null&&(p.Aa=Jt,p.j.info("SVER="+p.Aa));let Jo=Oe[5];Jo!=null&&typeof Jo=="number"&&0<Jo&&(m=1.5*Jo,p.L=m,p.j.info("backChannelRequestTimeoutMs_="+m)),m=p;let ir=u.g;if(ir){let fh=ir.g?ir.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(fh){var k=m.h;k.g||fh.indexOf("spdy")==-1&&fh.indexOf("quic")==-1&&fh.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(oy(k,k.h),k.h=null))}if(m.D){let dy=ir.g?ir.g.getResponseHeader("X-HTTP-Session-Id"):null;dy&&(m.ya=dy,Xe(m.I,m.D,dy))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-u.F,p.j.info("Handshake RTT: "+p.R+"ms")),m=p;var $=u;if(m.qa=X0(m,m.J?m.ia:null,m.W),$.K){S0(m.h,$);var He=$,zt=m.L;zt&&(He.I=zt),He.B&&(ry(He),rh(He)),m.g=$}else W0(m);0<p.i.length&&lh(p)}else Oe[0]!="stop"&&Oe[0]!="close"||Ls(p,7);else p.G==3&&(Oe[0]=="stop"||Oe[0]=="close"?Oe[0]=="stop"?Ls(p,7):cy(p):Oe[0]!="noop"&&p.l&&p.l.ta(Oe),p.v=0)}}ou(4)}catch{}}var _L=class{constructor(u,h){this.g=u,this.map=h}};function C0(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function D0(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function b0(u){return u.h?1:u.g?u.g.size:0}function sy(u,h){return u.h?u.h==h:u.g?u.g.has(h):!1}function oy(u,h){u.g?u.g.add(h):u.h=h}function S0(u,h){u.h&&u.h==h?u.h=null:u.g&&u.g.has(h)&&u.g.delete(h)}C0.prototype.cancel=function(){if(this.i=A0(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function A0(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let h=u.i;for(let p of u.g.values())h=h.concat(p.D);return h}return b(u.i)}function vL(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var h=[],p=u.length,m=0;m<p;m++)h.push(u[m]);return h}h=[],p=0;for(m in u)h[p++]=u[m];return h}function wL(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var h=[];u=u.length;for(var p=0;p<u;p++)h.push(p);return h}h=[],p=0;for(let m in u)h[p++]=m;return h}}}function R0(u,h){if(u.forEach&&typeof u.forEach=="function")u.forEach(h,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,h,void 0);else for(var p=wL(u),m=vL(u),A=m.length,k=0;k<A;k++)h.call(void 0,m[k],p&&p[k],u)}var x0=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function EL(u,h){if(u){u=u.split("&");for(var p=0;p<u.length;p++){var m=u[p].indexOf("="),A=null;if(0<=m){var k=u[p].substring(0,m);A=u[p].substring(m+1)}else k=u[p];h(k,A?decodeURIComponent(A.replace(/\+/g," ")):"")}}}function Fs(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Fs){this.h=u.h,ih(this,u.j),this.o=u.o,this.g=u.g,sh(this,u.s),this.l=u.l;var h=u.i,p=new hu;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),M0(this,p),this.m=u.m}else u&&(h=String(u).match(x0))?(this.h=!1,ih(this,h[1]||"",!0),this.o=lu(h[2]||""),this.g=lu(h[3]||"",!0),sh(this,h[4]),this.l=lu(h[5]||"",!0),M0(this,h[6]||"",!0),this.m=lu(h[7]||"")):(this.h=!1,this.i=new hu(null,this.h))}Fs.prototype.toString=function(){var u=[],h=this.j;h&&u.push(du(h,N0,!0),":");var p=this.g;return(p||h=="file")&&(u.push("//"),(h=this.o)&&u.push(du(h,N0,!0),"@"),u.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&u.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&u.push("/"),u.push(du(p,p.charAt(0)=="/"?CL:TL,!0))),(p=this.i.toString())&&u.push("?",p),(p=this.m)&&u.push("#",du(p,bL)),u.join("")};function ri(u){return new Fs(u)}function ih(u,h,p){u.j=p?lu(h,!0):h,u.j&&(u.j=u.j.replace(/:$/,""))}function sh(u,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);u.s=h}else u.s=null}function M0(u,h,p){h instanceof hu?(u.i=h,SL(u.i,u.h)):(p||(h=du(h,DL)),u.i=new hu(h,u.h))}function Xe(u,h,p){u.i.set(h,p)}function oh(u){return Xe(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function lu(u,h){return u?h?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function du(u,h,p){return typeof u=="string"?(u=encodeURI(u).replace(h,IL),p&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function IL(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var N0=/[#\/\?@]/g,TL=/[#\?:]/g,CL=/[#\?]/g,DL=/[#\?@]/g,bL=/#/g;function hu(u,h){this.h=this.g=null,this.i=u||null,this.j=!!h}function Mi(u){u.g||(u.g=new Map,u.h=0,u.i&&EL(u.i,function(h,p){u.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=hu.prototype,n.add=function(u,h){Mi(this),this.i=null,u=Zo(this,u);var p=this.g.get(u);return p||this.g.set(u,p=[]),p.push(h),this.h+=1,this};function P0(u,h){Mi(u),h=Zo(u,h),u.g.has(h)&&(u.i=null,u.h-=u.g.get(h).length,u.g.delete(h))}function k0(u,h){return Mi(u),h=Zo(u,h),u.g.has(h)}n.forEach=function(u,h){Mi(this),this.g.forEach(function(p,m){p.forEach(function(A){u.call(h,A,m,this)},this)},this)},n.na=function(){Mi(this);let u=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let m=0;m<h.length;m++){let A=u[m];for(let k=0;k<A.length;k++)p.push(h[m])}return p},n.V=function(u){Mi(this);let h=[];if(typeof u=="string")k0(this,u)&&(h=h.concat(this.g.get(Zo(this,u))));else{u=Array.from(this.g.values());for(let p=0;p<u.length;p++)h=h.concat(u[p])}return h},n.set=function(u,h){return Mi(this),this.i=null,u=Zo(this,u),k0(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[h]),this.h+=1,this},n.get=function(u,h){return u?(u=this.V(u),0<u.length?String(u[0]):h):h};function O0(u,h,p){P0(u,h),0<p.length&&(u.i=null,u.g.set(Zo(u,h),b(p)),u.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var m=h[p];let k=encodeURIComponent(String(m)),$=this.V(m);for(m=0;m<$.length;m++){var A=k;$[m]!==""&&(A+="="+encodeURIComponent(String($[m]))),u.push(A)}}return this.i=u.join("&")};function Zo(u,h){return h=String(h),u.j&&(h=h.toLowerCase()),h}function SL(u,h){h&&!u.j&&(Mi(u),u.i=null,u.g.forEach(function(p,m){var A=m.toLowerCase();m!=A&&(P0(this,m),O0(this,A,p))},u)),u.j=h}function AL(u,h){let p=new cu;if(a.Image){let m=new Image;m.onload=y(Ni,p,"TestLoadImage: loaded",!0,h,m),m.onerror=y(Ni,p,"TestLoadImage: error",!1,h,m),m.onabort=y(Ni,p,"TestLoadImage: abort",!1,h,m),m.ontimeout=y(Ni,p,"TestLoadImage: timeout",!1,h,m),a.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=u}else h(!1)}function RL(u,h){let p=new cu,m=new AbortController,A=setTimeout(()=>{m.abort(),Ni(p,"TestPingServer: timeout",!1,h)},1e4);fetch(u,{signal:m.signal}).then(k=>{clearTimeout(A),k.ok?Ni(p,"TestPingServer: ok",!0,h):Ni(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(A),Ni(p,"TestPingServer: error",!1,h)})}function Ni(u,h,p,m,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),m(p)}catch{}}function xL(){this.g=new hL}function ML(u,h,p){let m=p||"";try{R0(u,function(A,k){let $=A;l(A)&&($=Ym(A)),h.push(m+k+"="+encodeURIComponent($))})}catch(A){throw h.push(m+"type="+encodeURIComponent("_badmap")),A}}function fu(u){this.l=u.Ub||null,this.j=u.eb||!1}v(fu,Zm),fu.prototype.g=function(){return new ah(this.l,this.j)},fu.prototype.i=function(u){return function(){return u}}({});function ah(u,h){Vt.call(this),this.D=u,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(ah,Vt),n=ah.prototype,n.open=function(u,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=h,this.readyState=1,gu(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(h.body=u),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,pu(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,gu(this)),this.g&&(this.readyState=3,gu(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;F0(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function F0(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var h=u.value?u.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!u.done}))&&(this.response=this.responseText+=h)}u.done?pu(this):gu(this),this.readyState==3&&F0(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,pu(this))},n.Qa=function(u){this.g&&(this.response=u,pu(this))},n.ga=function(){this.g&&pu(this)};function pu(u){u.readyState=4,u.l=null,u.j=null,u.v=null,gu(u)}n.setRequestHeader=function(u,h){this.u.append(u,h)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,u.push(p[0]+": "+p[1]),p=h.next();return u.join(`\r
`)};function gu(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(ah.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function L0(u){let h="";return Z(u,function(p,m){h+=m,h+=":",h+=p,h+=`\r
`}),h}function ay(u,h,p){e:{for(m in p){var m=!1;break e}m=!0}m||(p=L0(p),typeof u=="string"?p!=null&&encodeURIComponent(String(p)):Xe(u,h,p))}function ht(u){Vt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(ht,Vt);var NL=/^https?$/i,PL=["POST","PUT"];n=ht.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,h,p,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);h=h?h.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ey.g(),this.v=this.o?h0(this.o):h0(ey),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(h,String(u),!0),this.B=!1}catch(k){V0(this,k);return}if(u=p||"",p=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var A in m)p.set(A,m[A]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(let k of m.keys())p.set(k,m.get(k));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(p.keys()).find(k=>k.toLowerCase()=="content-type"),A=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(PL,h,void 0))||m||A||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[k,$]of p)this.g.setRequestHeader(k,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{B0(this),this.u=!0,this.g.send(u),this.u=!1}catch(k){V0(this,k)}};function V0(u,h){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=h,u.m=5,U0(u),ch(u)}function U0(u){u.A||(u.A=!0,Ht(u,"complete"),Ht(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Ht(this,"complete"),Ht(this,"abort"),ch(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ch(this,!0)),ht.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?j0(this):this.bb())},n.bb=function(){j0(this)};function j0(u){if(u.h&&typeof o<"u"&&(!u.v[1]||ii(u)!=4||u.Z()!=2)){if(u.u&&ii(u)==4)iu(u.Ea,0,u);else if(Ht(u,"readystatechange"),ii(u)==4){u.h=!1;try{let $=u.Z();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var m;if(m=$===0){var A=String(u.D).match(x0)[1]||null;!A&&a.self&&a.self.location&&(A=a.self.location.protocol.slice(0,-1)),m=!NL.test(A?A.toLowerCase():"")}p=m}if(p)Ht(u,"complete"),Ht(u,"success");else{u.m=6;try{var k=2<ii(u)?u.g.statusText:""}catch{k=""}u.l=k+" ["+u.Z()+"]",U0(u)}}finally{ch(u)}}}}function ch(u,h){if(u.g){B0(u);let p=u.g,m=u.v[0]?()=>{}:null;u.g=null,u.v=null,h||Ht(u,"ready");try{p.onreadystatechange=m}catch{}}}function B0(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function ii(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<ii(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var h=this.g.responseText;return u&&h.indexOf(u)==0&&(h=h.substring(u.length)),dL(h)}};function $0(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function kL(u){let h={};u=(u.g&&2<=ii(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<u.length;m++){if(B(u[m]))continue;var p=S(u[m]);let A=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();let k=h[A]||[];h[A]=k,k.push(p)}I(h,function(m){return m.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function mu(u,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[u]||h}function q0(u){this.Aa=0,this.i=[],this.j=new cu,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=mu("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=mu("baseRetryDelayMs",5e3,u),this.cb=mu("retryDelaySeedMs",1e4,u),this.Wa=mu("forwardChannelMaxRetries",2,u),this.wa=mu("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new C0(u&&u.concurrentRequestLimit),this.Da=new xL,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=q0.prototype,n.la=8,n.G=1,n.connect=function(u,h,p,m){an(0),this.W=u,this.H=h||{},p&&m!==void 0&&(this.H.OSID=p,this.H.OAID=m),this.F=this.X,this.I=X0(this,null,this.W),lh(this)};function cy(u){if(H0(u),u.G==3){var h=u.U++,p=ri(u.I);if(Xe(p,"SID",u.K),Xe(p,"RID",h),Xe(p,"TYPE","terminate"),yu(u,p),h=new xi(u,u.j,h),h.L=2,h.v=oh(ri(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=h.v,p=!0),p||(h.g=J0(h.j,null),h.g.ea(h.v)),h.F=Date.now(),rh(h)}Z0(u)}function uh(u){u.g&&(ly(u),u.g.cancel(),u.g=null)}function H0(u){uh(u),u.u&&(a.clearTimeout(u.u),u.u=null),dh(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function lh(u){if(!D0(u.h)&&!u.s){u.s=!0;var h=u.Ga;xs||N(),Ms||(xs(),Ms=!0),tu.add(h,u),u.B=0}}function OL(u,h){return b0(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=h.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=au(g(u.Ga,u,h),Y0(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let A=new xi(this,this.j,u),k=this.o;if(this.S&&(k?(k=_(k),T(k,this.S)):k=this.S),this.m!==null||this.O||(A.H=k,k=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var m=this.i[p];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(h+=m,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=G0(this,A,h),p=ri(this.I),Xe(p,"RID",u),Xe(p,"CVER",22),this.D&&Xe(p,"X-HTTP-Session-Id",this.D),yu(this,p),k&&(this.O?h="headers="+encodeURIComponent(String(L0(k)))+"&"+h:this.m&&ay(p,this.m,k)),oy(this.h,A),this.Ua&&Xe(p,"TYPE","init"),this.P?(Xe(p,"$req",h),Xe(p,"SID","null"),A.T=!0,ny(A,p,null)):ny(A,p,h),this.G=2}}else this.G==3&&(u?z0(this,u):this.i.length==0||D0(this.h)||z0(this))};function z0(u,h){var p;h?p=h.l:p=u.U++;let m=ri(u.I);Xe(m,"SID",u.K),Xe(m,"RID",p),Xe(m,"AID",u.T),yu(u,m),u.m&&u.o&&ay(m,u.m,u.o),p=new xi(u,u.j,p,u.B+1),u.m===null&&(p.H=u.o),h&&(u.i=h.D.concat(u.i)),h=G0(u,p,1e3),p.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),oy(u.h,p),ny(p,m,h)}function yu(u,h){u.H&&Z(u.H,function(p,m){Xe(h,m,p)}),u.l&&R0({},function(p,m){Xe(h,m,p)})}function G0(u,h,p){p=Math.min(u.i.length,p);var m=u.l?g(u.l.Na,u.l,u):null;e:{var A=u.i;let k=-1;for(;;){let $=["count="+p];k==-1?0<p?(k=A[0].g,$.push("ofs="+k)):k=0:$.push("ofs="+k);let He=!0;for(let zt=0;zt<p;zt++){let Oe=A[zt].g,Xt=A[zt].map;if(Oe-=k,0>Oe)k=Math.max(0,A[zt].g-100),He=!1;else try{ML(Xt,$,"req"+Oe+"_")}catch{m&&m(Xt)}}if(He){m=$.join("&");break e}}}return u=u.i.splice(0,p),h.D=u,m}function W0(u){if(!u.g&&!u.u){u.Y=1;var h=u.Fa;xs||N(),Ms||(xs(),Ms=!0),tu.add(h,u),u.v=0}}function uy(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=au(g(u.Fa,u),Y0(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,K0(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=au(g(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,an(10),uh(this),K0(this))};function ly(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function K0(u){u.g=new xi(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var h=ri(u.qa);Xe(h,"RID","rpc"),Xe(h,"SID",u.K),Xe(h,"AID",u.T),Xe(h,"CI",u.F?"0":"1"),!u.F&&u.ja&&Xe(h,"TO",u.ja),Xe(h,"TYPE","xmlhttp"),yu(u,h),u.m&&u.o&&ay(h,u.m,u.o),u.L&&(u.g.I=u.L);var p=u.g;u=u.ia,p.L=1,p.v=oh(ri(h)),p.m=null,p.P=!0,E0(p,u)}n.Za=function(){this.C!=null&&(this.C=null,uh(this),uy(this),an(19))};function dh(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Q0(u,h){var p=null;if(u.g==h){dh(u),ly(u),u.g=null;var m=2}else if(sy(u.h,h))p=h.D,S0(u.h,h),m=1;else return;if(u.G!=0){if(h.o)if(m==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var A=u.B;m=eh(),Ht(m,new y0(m,p)),lh(u)}else W0(u);else if(A=h.s,A==3||A==0&&0<h.X||!(m==1&&OL(u,h)||m==2&&uy(u)))switch(p&&0<p.length&&(h=u.h,h.i=h.i.concat(p)),A){case 1:Ls(u,5);break;case 4:Ls(u,10);break;case 3:Ls(u,6);break;default:Ls(u,2)}}}function Y0(u,h){let p=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(p*=2),p*h}function Ls(u,h){if(u.j.info("Error code "+h),h==2){var p=g(u.fb,u),m=u.Xa;let A=!m;m=new Fs(m||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||ih(m,"https"),oh(m),A?AL(m.toString(),p):RL(m.toString(),p)}else an(2);u.G=0,u.l&&u.l.sa(h),Z0(u),H0(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),an(2)):(this.j.info("Failed to ping google.com"),an(1))};function Z0(u){if(u.G=0,u.ka=[],u.l){let h=A0(u.h);(h.length!=0||u.i.length!=0)&&(C(u.ka,h),C(u.ka,u.i),u.h.i.length=0,b(u.i),u.i.length=0),u.l.ra()}}function X0(u,h,p){var m=p instanceof Fs?ri(p):new Fs(p);if(m.g!="")h&&(m.g=h+"."+m.g),sh(m,m.s);else{var A=a.location;m=A.protocol,h=h?h+"."+A.hostname:A.hostname,A=+A.port;var k=new Fs(null);m&&ih(k,m),h&&(k.g=h),A&&sh(k,A),p&&(k.l=p),m=k}return p=u.D,h=u.ya,p&&h&&Xe(m,p,h),Xe(m,"VER",u.la),yu(u,m),m}function J0(u,h,p){if(h&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=u.Ca&&!u.pa?new ht(new fu({eb:p})):new ht(u.pa),h.Ha(u.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function eb(){}n=eb.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function hh(){}hh.prototype.g=function(u,h){return new xn(u,h)};function xn(u,h){Vt.call(this),this.g=new q0(h),this.l=u,this.h=h&&h.messageUrlParams||null,u=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(u?u["X-WebChannel-Content-Type"]=h.messageContentType:u={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(u?u["X-WebChannel-Client-Profile"]=h.va:u={"X-WebChannel-Client-Profile":h.va}),this.g.S=u,(u=h&&h.Sb)&&!B(u)&&(this.g.m=u),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!B(h)&&(this.g.D=h,u=this.h,u!==null&&h in u&&(u=this.h,h in u&&delete u[h])),this.j=new Xo(this)}v(xn,Vt),xn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},xn.prototype.close=function(){cy(this.g)},xn.prototype.o=function(u){var h=this.g;if(typeof u=="string"){var p={};p.__data__=u,u=p}else this.u&&(p={},p.__data__=Ym(u),u=p);h.i.push(new _L(h.Ya++,u)),h.G==3&&lh(h)},xn.prototype.N=function(){this.g.l=null,delete this.j,cy(this.g),delete this.g,xn.aa.N.call(this)};function tb(u){Xm.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var h=u.__sm__;if(h){e:{for(let p in h){u=p;break e}u=void 0}(this.i=u)&&(u=this.i,h=h!==null&&u in h?h[u]:void 0),this.data=h}else this.data=u}v(tb,Xm);function nb(){Jm.call(this),this.status=1}v(nb,Jm);function Xo(u){this.g=u}v(Xo,eb),Xo.prototype.ua=function(){Ht(this.g,"a")},Xo.prototype.ta=function(u){Ht(this.g,new tb(u))},Xo.prototype.sa=function(u){Ht(this.g,new nb)},Xo.prototype.ra=function(){Ht(this.g,"b")},hh.prototype.createWebChannel=hh.prototype.g,xn.prototype.send=xn.prototype.o,xn.prototype.open=xn.prototype.m,xn.prototype.close=xn.prototype.close,Xw=_i.createWebChannelTransport=function(){return new hh},Zw=_i.getStatEventTarget=function(){return eh()},Yw=_i.Event=ks,Tp=_i.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},th.NO_ERROR=0,th.TIMEOUT=8,th.HTTP_ERROR=6,Dl=_i.ErrorCode=th,_0.COMPLETE="complete",Qw=_i.EventType=_0,f0.EventType=su,su.OPEN="a",su.CLOSE="b",su.ERROR="c",su.MESSAGE="d",Vt.prototype.listen=Vt.prototype.K,qa=_i.WebChannel=f0,Kw=_i.FetchXmlHttpFactory=fu,ht.prototype.listenOnce=ht.prototype.L,ht.prototype.getLastError=ht.prototype.Ka,ht.prototype.getLastErrorCode=ht.prototype.Ba,ht.prototype.getStatus=ht.prototype.Z,ht.prototype.getResponseJson=ht.prototype.Oa,ht.prototype.getResponseText=ht.prototype.oa,ht.prototype.send=ht.prototype.ea,ht.prototype.setWithCredentials=ht.prototype.Ha,Ww=_i.XhrIo=ht}).apply(typeof Ip<"u"?Ip:typeof self<"u"?self:typeof window<"u"?window:{});var yM="@firebase/firestore";var xt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};xt.UNAUTHENTICATED=new xt(null),xt.GOOGLE_CREDENTIALS=new xt("google-credentials-uid"),xt.FIRST_PARTY=new xt("first-party-uid"),xt.MOCK_USER=new xt("mock-user");var wc="10.13.1";var as=new ki("@firebase/firestore");function Ka(){return as.logLevel}function wN(n){as.setLogLevel(n)}function U(n,...e){if(as.logLevel<=zn.DEBUG){let t=e.map(rT);as.debug(`Firestore (${wc}): ${n}`,...t)}}function wt(n,...e){if(as.logLevel<=zn.ERROR){let t=e.map(rT);as.error(`Firestore (${wc}): ${n}`,...t)}}function Zn(n,...e){if(as.logLevel<=zn.WARN){let t=e.map(rT);as.warn(`Firestore (${wc}): ${n}`,...t)}}function rT(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function W(n="Unexpected state"){let e=`FIRESTORE (${wc}) INTERNAL ASSERTION FAILED: `+n;throw wt(e),new Error(e)}function te(n,e){n||W()}function EN(n,e){n||W()}function q(n,e){return n}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},L=class extends yh{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Mt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var kp=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},rE=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(xt.UNAUTHENTICATED))}shutdown(){}},iE=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},sE=class{constructor(e){this.t=e,this.currentUser=xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new Mt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Mt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>M(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{U("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(U("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Mt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(U("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(te(typeof r.accessToken=="string"),new kp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return te(e===null||typeof e=="string"),new xt(e)}},oE=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=xt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},aE=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new oE(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},cE=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},uE=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){let r=s=>{s.error!=null&&U("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,U("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{U("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):U("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(te(typeof t.token=="string"),this.R=t.token,new cE(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function s4(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Op=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=s4(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function pe(n,e){return n<e?-1:n>e?1:0}function rc(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function IN(n){return n+"\0"}var ut=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new L(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?pe(this.nanoseconds,e.nanoseconds):pe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var ie=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new ut(0,0))}static max(){return new n(new ut(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Fp=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&W(),r===void 0?r=e.length-t:r>e.length-t&&W(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},Pe=class n extends Fp{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new L(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},o4=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Et=class n extends Fp{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return o4.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new L(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new L(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new L(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new L(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var H=class n{constructor(e){this.path=e}static fromPath(e){return new n(Pe.fromString(e))}static fromName(e){return new n(Pe.fromString(e).popFirst(5))}static empty(){return new n(Pe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Pe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Pe.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new Pe(e.slice()))}};var ic=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function lE(n){return n.fields.find(e=>e.kind===2)}function lo(n){return n.fields.filter(e=>e.kind!==2)}ic.UNKNOWN_ID=-1;var ec=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var Ll=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Xn.min())}};function TN(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=ie.fromTimestamp(r===1e9?new ut(t+1,0):new ut(t,r));return new Xn(i,H.empty(),e)}function CN(n){return new Xn(n.readTime,n.key,-1)}var Xn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(ie.min(),H.empty(),-1)}static max(){return new n(ie.max(),H.empty(),-1)}};function iT(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=H.comparator(n.documentKey,e.documentKey),t!==0?t:pe(n.largestBatchId,e.largestBatchId))}var DN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Lp=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function ys(n){return M(this,null,function*(){if(n.code!==P.FAILED_PRECONDITION||n.message!==DN)throw n;U("LocalStore","Unexpectedly lost primary lease")})}var x=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&W(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;t(e[l]).next(d=>{o[l]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var Vp=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Mt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new yo(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=sT(r.target.error);this.V.reject(new yo(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new yo(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(U("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new hE(t)}},cs=class n{constructor(e,t,r){this.name=e,this.version=t,this.p=r,n.S(_u())===12.2&&wt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return U("SimpleDb","Removing database:",e),ho(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!mh())return!1;if(n.v())return!0;let e=_u(),t=n.S(e),r=0<t&&t<10,i=bN(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return M(this,null,function*(){return this.db||(U("SimpleDb","Opening database:",this.name),this.db=yield new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new yo(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new L(P.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new L(P.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new yo(e,o))},i.onupgradeneeded=s=>{U("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{U("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){return M(this,null,function*(){let s=t==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=Vp.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),x.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<3;if(U("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function bN(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var dE=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ho(this.B.delete())}},yo=class extends L{constructor(e,t){super(P.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function _s(n){return n.name==="IndexedDbTransactionError"}var hE=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(U("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(U("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ho(r)}add(e){return U("SimpleDb","ADD",this.store.name,e,e),ho(this.store.add(e))}get(e){return ho(this.store.get(e)).next(t=>(t===void 0&&(t=null),U("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return U("SimpleDb","DELETE",this.store.name,e),ho(this.store.delete(e))}count(){return U("SimpleDb","COUNT",this.store.name),ho(this.store.count())}U(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new x((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new x((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){U("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Y(e){let t=this.cursor({});return new x((r,i)=>{t.onerror=s=>{let o=sT(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){let r=[];return new x((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new dE(a),l=t(a.primaryKey,a.value,c);if(l instanceof x){let d=l.catch(f=>(c.done(),x.reject(f)));r.push(d)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>x.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function ho(n){return new x((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=sT(r.target.error);t(i)}})}var _M=!1;function sT(n){let e=cs.S(_u());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new L("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return _M||(_M=!0,setTimeout(()=>{throw r},0)),r}}return n}var fE=class{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){U("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>M(this,null,function*(){this.task=null;try{U("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(t){_s(t)?U("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):yield ys(t)}yield this.X(6e4)}))}},pE=class{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){return M(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))})}te(e,t){let r=new Set,i=t,s=!0;return x.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return U("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(U("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=CN(s);iT(o,r)>0&&(r=o)}),new Xn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Fn=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function od(n){return n==null}function Vl(n){return n===0&&1/n==-1/0}function SN(n){return typeof n=="number"&&Number.isInteger(n)&&!Vl(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function dn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=vM(e)),e=a4(n.get(t),e);return vM(e)}function a4(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function vM(n){return n+""}function Ur(n){let e=n.length;if(te(e>=2),e===2)return te(n.charAt(0)===""&&n.charAt(1)===""),Pe.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&W(),n.charAt(o+1)){case"":let a=n.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:W()}s=o+2}return new Pe(r)}var wM=["userId","batchId"];function Ap(n,e){return[n,dn(e)]}function AN(n,e,t){return[n,dn(e),t]}var c4={},u4=["prefixPath","collectionGroup","readTime","documentId"],l4=["prefixPath","collectionGroup","documentId"],d4=["collectionGroup","readTime","prefixPath","documentId"],h4=["canonicalId","targetId"],f4=["targetId","path"],p4=["path","targetId"],g4=["collectionId","parent"],m4=["indexId","uid"],y4=["uid","sequenceNumber"],_4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],v4=["indexId","uid","orderedDocumentKey"],w4=["userId","collectionPath","documentId"],E4=["userId","collectionPath","largestBatchId"],I4=["userId","collectionGroup","largestBatchId"],RN=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],T4=[...RN,"documentOverlays"],xN=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],MN=xN,oT=[...MN,"indexConfiguration","indexState","indexEntries"],C4=oT,D4=[...oT,"globals"];var Ul=class extends Lp{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}};function Ot(n,e){let t=q(n);return cs.F(t._e,e)}function EM(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ro(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function NN(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var nt=class n{constructor(e,t){this.comparator=e,this.root=t||Br.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Br.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Br.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ja(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ja(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ja(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ja(this.root,e,this.comparator,!0)}},Ja=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Br=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw W();let e=this.left.check();if(e!==this.right.check())throw W();return e+(this.isRed()?0:1)}};Br.EMPTY=null,Br.RED=!0,Br.BLACK=!1;Br.EMPTY=new class{constructor(){this.size=0}get key(){throw W()}get value(){throw W()}get color(){throw W()}get left(){throw W()}get right(){throw W()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Br(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var We=class n{constructor(e){this.comparator=e,this.data=new nt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Up(this.data.getIterator())}getIteratorFrom(e){return new Up(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Up=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Ha(n){return n.hasNext()?n.getNext():void 0}var Ln=class n{constructor(e){this.fields=e,e.sort(Et.comparator)}static empty(){return new n([])}unionWith(e){let t=new We(Et.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return rc(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var jp=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function PN(){return typeof atob<"u"}var Tt=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new jp("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return pe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Tt.EMPTY_BYTE_STRING=new Tt("");var b4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ei(n){if(te(!!n),typeof n=="string"){let e=0,t=b4.exec(n);if(te(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:st(n.seconds),nanos:st(n.nanos)}}function st(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function us(n){return typeof n=="string"?Tt.fromBase64String(n):Tt.fromUint8Array(n)}function xg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function aT(n){let e=n.mapValue.fields.__previous_value__;return xg(e)?aT(e):e}function jl(n){let e=Ei(n.mapValue.fields.__local_write_time__.timestampValue);return new ut(e.seconds,e.nanos)}var gE=class{constructor(e,t,r,i,s,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},ls=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var ss={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Rp={nullValue:"NULL_VALUE"};function _o(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?xg(n)?4:kN(n)?9007199254740991:Mg(n)?10:11:W()}function Hr(n,e){if(n===e)return!0;let t=_o(n);if(t!==_o(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return jl(n).isEqual(jl(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Ei(i.timestampValue),a=Ei(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return us(i.bytesValue).isEqual(us(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return st(i.geoPointValue.latitude)===st(s.geoPointValue.latitude)&&st(i.geoPointValue.longitude)===st(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return st(i.integerValue)===st(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=st(i.doubleValue),a=st(s.doubleValue);return o===a?Vl(o)===Vl(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return rc(n.arrayValue.values||[],e.arrayValue.values||[],Hr);case 10:case 11:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(EM(o)!==EM(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Hr(o[c],a[c])))return!1;return!0}(n,e);default:return W()}}function Bl(n,e){return(n.values||[]).find(t=>Hr(t,e))!==void 0}function ds(n,e){if(n===e)return 0;let t=_o(n),r=_o(e);if(t!==r)return pe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return pe(n.booleanValue,e.booleanValue);case 2:return function(s,o){let a=st(s.integerValue||s.doubleValue),c=st(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return IM(n.timestampValue,e.timestampValue);case 4:return IM(jl(n),jl(e));case 5:return pe(n.stringValue,e.stringValue);case 6:return function(s,o){let a=us(s),c=us(o);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let d=pe(a[l],c[l]);if(d!==0)return d}return pe(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){let a=pe(st(s.latitude),st(o.latitude));return a!==0?a:pe(st(s.longitude),st(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return TM(n.arrayValue,e.arrayValue);case 10:return function(s,o){var a,c,l,d;let f=s.fields||{},g=o.fields||{},y=(a=f.value)===null||a===void 0?void 0:a.arrayValue,v=(c=g.value)===null||c===void 0?void 0:c.arrayValue,b=pe(((l=y?.values)===null||l===void 0?void 0:l.length)||0,((d=v?.values)===null||d===void 0?void 0:d.length)||0);return b!==0?b:TM(y,v)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===ss.mapValue&&o===ss.mapValue)return 0;if(s===ss.mapValue)return 1;if(o===ss.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},d=Object.keys(l);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){let g=pe(c[f],d[f]);if(g!==0)return g;let y=ds(a[c[f]],l[d[f]]);if(y!==0)return y}return pe(c.length,d.length)}(n.mapValue,e.mapValue);default:throw W()}}function IM(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return pe(n,e);let t=Ei(n),r=Ei(e),i=pe(t.seconds,r.seconds);return i!==0?i:pe(t.nanos,r.nanos)}function TM(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=ds(t[i],r[i]);if(s)return s}return pe(t.length,r.length)}function sc(n){return mE(n)}function mE(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Ei(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return us(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return H.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=mE(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${mE(t.fields[o])}`;return i+"}"}(n.mapValue):W()}function vo(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function yE(n){return!!n&&"integerValue"in n}function $l(n){return!!n&&"arrayValue"in n}function CM(n){return!!n&&"nullValue"in n}function DM(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function xp(n){return!!n&&"mapValue"in n}function Mg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function Nl(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Ro(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Nl(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Nl(n.arrayValue.values[t]);return e}return Object.assign({},n)}function kN(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var ON={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function S4(n){return"nullValue"in n?Rp:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?vo(ls.empty(),H.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Mg(n)?ON:{mapValue:{}}:W()}function A4(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?vo(ls.empty(),H.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?ON:"mapValue"in n?Mg(n)?{mapValue:{}}:ss:W()}function bM(n,e){let t=ds(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function SM(n,e){let t=ds(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var rn=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!xp(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nl(t)}setAll(e){let t=Et.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Nl(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());xp(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Hr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];xp(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Ro(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Nl(this.value))}};function FN(n){let e=[];return Ro(n.fields,(t,r)=>{let i=new Et([t]);if(xp(r)){let s=FN(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Ln(e)}var Nt=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,ie.min(),ie.min(),ie.min(),rn.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,ie.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,ie.min(),ie.min(),rn.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,ie.min(),ie.min(),rn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var zr=class{constructor(e,t){this.position=e,this.inclusive=t}};function AM(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=H.comparator(H.fromName(o.referenceValue),t.key):r=ds(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function RM(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Hr(n.position[t],e.position[t]))return!1;return!0}var wo=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function R4(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Bp=class{},Re=class n extends Bp{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new wE(e,t,r):t==="array-contains"?new TE(e,r):t==="in"?new $p(e,r):t==="not-in"?new CE(e,r):t==="array-contains-any"?new DE(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new EE(e,r):new IE(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ds(t,this.value)):t!==null&&_o(this.value)===_o(t)&&this.matchesComparison(ds(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return W()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Be=class n extends Bp{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return oc(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function oc(n){return n.op==="and"}function _E(n){return n.op==="or"}function cT(n){return LN(n)&&oc(n)}function LN(n){for(let e of n.filters)if(e instanceof Be)return!1;return!0}function vE(n){if(n instanceof Re)return n.field.canonicalString()+n.op.toString()+sc(n.value);if(cT(n))return n.filters.map(e=>vE(e)).join(",");{let e=n.filters.map(t=>vE(t)).join(",");return`${n.op}(${e})`}}function VN(n,e){return n instanceof Re?function(r,i){return i instanceof Re&&r.op===i.op&&r.field.isEqual(i.field)&&Hr(r.value,i.value)}(n,e):n instanceof Be?function(r,i){return i instanceof Be&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&VN(o,i.filters[a]),!0):!1}(n,e):void W()}function UN(n,e){let t=n.filters.concat(e);return Be.create(t,n.op)}function jN(n){return n instanceof Re?function(t){return`${t.field.canonicalString()} ${t.op} ${sc(t.value)}`}(n):n instanceof Be?function(t){return t.op.toString()+" {"+t.getFilters().map(jN).join(" ,")+"}"}(n):"Filter"}var wE=class extends Re{constructor(e,t,r){super(e,t,r),this.key=H.fromName(r.referenceValue)}matches(e){let t=H.comparator(e.key,this.key);return this.matchesComparison(t)}},EE=class extends Re{constructor(e,t){super(e,"in",t),this.keys=BN("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},IE=class extends Re{constructor(e,t){super(e,"not-in",t),this.keys=BN("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function BN(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>H.fromName(r.referenceValue))}var TE=class extends Re{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return $l(t)&&Bl(t.arrayValue,this.value)}},$p=class extends Re{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Bl(this.value.arrayValue,t)}},CE=class extends Re{constructor(e,t){super(e,"not-in",t)}matches(e){if(Bl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Bl(this.value.arrayValue,t)}},DE=class extends Re{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!$l(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Bl(this.value.arrayValue,r))}};var bE=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function SE(n,e=null,t=[],r=[],i=null,s=null,o=null){return new bE(n,e,t,r,i,s,o)}function Eo(n){let e=q(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>vE(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),od(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>sc(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>sc(r)).join(",")),e.ue=t}return e.ue}function ad(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!R4(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!VN(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!RM(n.startAt,e.startAt)&&RM(n.endAt,e.endAt)}function qp(n){return H.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Hp(n,e){return n.filters.filter(t=>t instanceof Re&&t.field.isEqual(e))}function xM(n,e,t){let r=Rp,i=!0;for(let s of Hp(n,e)){let o=Rp,a=!0;switch(s.op){case"<":case"<=":o=S4(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Rp}bM({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];bM({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function MM(n,e,t){let r=ss,i=!0;for(let s of Hp(n,e)){let o=ss,a=!0;switch(s.op){case">=":case">":o=A4(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=ss}SM({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];SM({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var fr=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function $N(n,e,t,r,i,s,o,a){return new fr(n,e,t,r,i,s,o,a)}function Ec(n){return new fr(n)}function NM(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function uT(n){return n.collectionGroup!==null}function tc(n){let e=q(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new We(Et.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new wo(s,r))}),t.has(Et.keyField().canonicalString())||e.ce.push(new wo(Et.keyField(),r))}return e.ce}function hn(n){let e=q(n);return e.le||(e.le=x4(e,tc(n))),e.le}function x4(n,e){if(n.limitType==="F")return SE(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new wo(i.field,s)});let t=n.endAt?new zr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new zr(n.startAt.position,n.startAt.inclusive):null;return SE(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function AE(n,e){let t=n.filters.concat([e]);return new fr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function zp(n,e,t){return new fr(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function cd(n,e){return ad(hn(n),hn(e))&&n.limitType===e.limitType}function qN(n){return`${Eo(hn(n))}|lt:${n.limitType}`}function Qa(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>jN(i)).join(", ")}]`),od(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>sc(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>sc(i)).join(",")),`Target(${r})`}(hn(n))}; limitType=${n.limitType})`}function ud(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):H.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of tc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let l=AM(o,a,c);return o.inclusive?l<=0:l<0}(r.startAt,tc(r),i)||r.endAt&&!function(o,a,c){let l=AM(o,a,c);return o.inclusive?l>=0:l>0}(r.endAt,tc(r),i))}(n,e)}function HN(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function zN(n){return(e,t)=>{let r=!1;for(let i of tc(n)){let s=M4(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function M4(n,e,t){let r=n.field.isKeyField()?H.comparator(e.key,t.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?ds(c,l):W()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return W()}}var Gr=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ro(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return NN(this.inner)}size(){return this.innerSize}};var N4=new nt(H.comparator);function An(){return N4}var GN=new nt(H.comparator);function xl(...n){let e=GN;for(let t of n)e=e.insert(t.key,t);return e}function WN(n){let e=GN;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function jr(){return Pl()}function KN(){return Pl()}function Pl(){return new Gr(n=>n.toString(),(n,e)=>n.isEqual(e))}var P4=new nt(H.comparator),k4=new We(H.comparator);function me(...n){let e=k4;for(let t of n)e=e.add(t);return e}var O4=new We(pe);function lT(){return O4}function dT(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vl(e)?"-0":e}}function QN(n){return{integerValue:""+n}}function YN(n,e){return SN(e)?QN(e):dT(n,e)}var ac=class{constructor(){this._=void 0}};function F4(n,e,t){return n instanceof hs?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&xg(s)&&(s=aT(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Ii?XN(n,e):n instanceof Ti?JN(n,e):function(i,s){let o=ZN(i,s),a=PM(o)+PM(i.Pe);return yE(o)&&yE(i.Pe)?QN(a):dT(i.serializer,a)}(n,e)}function L4(n,e,t){return n instanceof Ii?XN(n,e):n instanceof Ti?JN(n,e):t}function ZN(n,e){return n instanceof fs?function(r){return yE(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var hs=class extends ac{},Ii=class extends ac{constructor(e){super(),this.elements=e}};function XN(n,e){let t=eP(e);for(let r of n.elements)t.some(i=>Hr(i,r))||t.push(r);return{arrayValue:{values:t}}}var Ti=class extends ac{constructor(e){super(),this.elements=e}};function JN(n,e){let t=eP(e);for(let r of n.elements)t=t.filter(i=>!Hr(i,r));return{arrayValue:{values:t}}}var fs=class extends ac{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function PM(n){return st(n.integerValue||n.doubleValue)}function eP(n){return $l(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Io=class{constructor(e,t){this.field=e,this.transform=t}};function V4(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Ii&&i instanceof Ii||r instanceof Ti&&i instanceof Ti?rc(r.elements,i.elements,Hr):r instanceof fs&&i instanceof fs?Hr(r.Pe,i.Pe):r instanceof hs&&i instanceof hs}(n.transform,e.transform)}var RE=class{constructor(e,t){this.version=e,this.transformResults=t}},pt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Mp(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var cc=class{};function tP(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new gs(n.key,pt.none()):new ps(n.key,n.data,pt.none());{let t=n.data,r=rn.empty(),i=new We(Et.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new pr(n.key,r,new Ln(i.toArray()),pt.none())}}function U4(n,e,t){n instanceof ps?function(i,s,o){let a=i.value.clone(),c=OM(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof pr?function(i,s,o){if(!Mp(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=OM(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(nP(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function kl(n,e,t,r){return n instanceof ps?function(s,o,a,c){if(!Mp(s.precondition,o))return a;let l=s.value.clone(),d=FM(s.fieldTransforms,c,o);return l.setAll(d),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,e,t,r):n instanceof pr?function(s,o,a,c){if(!Mp(s.precondition,o))return a;let l=FM(s.fieldTransforms,c,o),d=o.data;return d.setAll(nP(s)),d.setAll(l),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(s,o,a){return Mp(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function j4(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=ZN(r.transform,i||null);s!=null&&(t===null&&(t=rn.empty()),t.set(r.field,s))}return t||null}function kM(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&rc(r,i,(s,o)=>V4(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var ps=class extends cc{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},pr=class extends cc{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function nP(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function OM(n,e,t){let r=new Map;te(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,L4(o,a,t[i]))}return r}function FM(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,F4(s,o,e))}return r}var gs=class extends cc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},ql=class extends cc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Hl=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&U4(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=kl(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=kl(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=KN();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=tP(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(ie.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),me())}isEqual(e){return this.batchId===e.batchId&&rc(this.mutations,e.mutations,(t,r)=>kM(t,r))&&rc(this.baseMutations,e.baseMutations,(t,r)=>kM(t,r))}},xE=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){te(e.mutations.length===r.length);let i=function(){return P4}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var zl=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var ME=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var At,Ne;function rP(n){switch(n){default:return W();case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0}}function iP(n){if(n===void 0)return wt("GRPC error has no .code"),P.UNKNOWN;switch(n){case At.OK:return P.OK;case At.CANCELLED:return P.CANCELLED;case At.UNKNOWN:return P.UNKNOWN;case At.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case At.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case At.INTERNAL:return P.INTERNAL;case At.UNAVAILABLE:return P.UNAVAILABLE;case At.UNAUTHENTICATED:return P.UNAUTHENTICATED;case At.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case At.NOT_FOUND:return P.NOT_FOUND;case At.ALREADY_EXISTS:return P.ALREADY_EXISTS;case At.PERMISSION_DENIED:return P.PERMISSION_DENIED;case At.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case At.ABORTED:return P.ABORTED;case At.OUT_OF_RANGE:return P.OUT_OF_RANGE;case At.UNIMPLEMENTED:return P.UNIMPLEMENTED;case At.DATA_LOSS:return P.DATA_LOSS;default:return W()}}(Ne=At||(At={}))[Ne.OK=0]="OK",Ne[Ne.CANCELLED=1]="CANCELLED",Ne[Ne.UNKNOWN=2]="UNKNOWN",Ne[Ne.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ne[Ne.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ne[Ne.NOT_FOUND=5]="NOT_FOUND",Ne[Ne.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ne[Ne.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ne[Ne.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ne[Ne.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ne[Ne.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ne[Ne.ABORTED=10]="ABORTED",Ne[Ne.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ne[Ne.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ne[Ne.INTERNAL=13]="INTERNAL",Ne[Ne.UNAVAILABLE=14]="UNAVAILABLE",Ne[Ne.DATA_LOSS=15]="DATA_LOSS";var LM=null;function sP(){return new TextEncoder}var B4=new es([4294967295,4294967295],0);function VM(n){let e=sP().encode(n),t=new Gw;return t.update(e),new Uint8Array(t.digest())}function UM(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new es([t,r],0),new es([i,s],0)]}var NE=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new mo(`Invalid padding: ${t}`);if(r<0)throw new mo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new mo(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new mo(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=es.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(es.fromNumber(r)));return i.compare(B4)===1&&(i=new es([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=VM(e),[r,i]=UM(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let t=VM(e),[r,i]=UM(t);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},mo=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Gl=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Wl.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(ie.min(),i,new nt(pe),An(),me())}},Wl=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,me(),me(),me())}};var nc=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Gp=class{constructor(e,t){this.targetId=e,this.me=t}},Wp=class{constructor(e,t,r=Tt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Kp=class{constructor(){this.fe=0,this.ge=BM(),this.pe=Tt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=me(),t=me(),r=me();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:W()}}),new Wl(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=BM()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,te(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},PE=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=An(),this.qe=jM(),this.Qe=new nt(pe)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:W()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(qp(s))if(r===0){let o=new H(s.path);this.Ue(t,o,Nt.newNoDocument(o,ie.min()))}else te(r===1);else{let o=this.Ye(t);if(o!==r){let a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(t);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,l)}LM?.et(function(d,f,g,y,v){var b,C,V,B,O,z;let re={localCacheCount:d,existenceFilterCount:f.count,databaseId:g.database,projectId:g.projectId},Z=f.unchangedNames;return Z&&(re.bloomFilter={applied:v===0,hashCount:(b=Z?.hashCount)!==null&&b!==void 0?b:0,bitmapLength:(B=(V=(C=Z?.bits)===null||C===void 0?void 0:C.bitmap)===null||V===void 0?void 0:V.length)!==null&&B!==void 0?B:0,padding:(z=(O=Z?.bits)===null||O===void 0?void 0:O.padding)!==null&&z!==void 0?z:0,mightContain:I=>{var _;return(_=y?.mightContain(I))!==null&&_!==void 0&&_}}),re}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=us(r).toUint8Array()}catch(c){if(c instanceof jp)return Zn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new NE(o,i,s)}catch(c){return Zn(c instanceof mo?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&qp(a.target)){let c=new H(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Nt.newNoDocument(c,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=me();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new Gl(e,t,this.Qe,this.ke,r);return this.ke=An(),this.qe=jM(),this.Qe=new nt(pe),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Kp,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new We(pe),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||U("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Kp),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function jM(){return new nt(H.comparator)}function BM(){return new nt(H.comparator)}var $4={asc:"ASCENDING",desc:"DESCENDING"},q4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},H4={and:"AND",or:"OR"},kE=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function OE(n,e){return n.useProto3Json||od(e)?e:{value:e}}function uc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function oP(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function z4(n,e){return uc(n,e.toTimestamp())}function It(n){return te(!!n),ie.fromTimestamp(function(t){let r=Ei(t);return new ut(r.seconds,r.nanos)}(n))}function hT(n,e){return FE(n,e).canonicalString()}function FE(n,e){let t=function(i){return new Pe(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function aP(n){let e=Pe.fromString(n);return te(yP(e)),e}function Kl(n,e){return hT(n.databaseId,e.path)}function $r(n,e){let t=aP(e);if(t.get(1)!==n.databaseId.projectId)throw new L(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new L(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new H(lP(t))}function cP(n,e){return hT(n.databaseId,e)}function uP(n){let e=aP(n);return e.length===4?Pe.emptyPath():lP(e)}function LE(n){return new Pe(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function lP(n){return te(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function $M(n,e,t){return{name:Kl(n,e),fields:t.value.mapValue.fields}}function dP(n,e,t){let r=$r(n,e.name),i=It(e.updateTime),s=e.createTime?It(e.createTime):ie.min(),o=new rn({mapValue:{fields:e.fields}}),a=Nt.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function G4(n,e){return"found"in e?function(r,i){te(!!i.found),i.found.name,i.found.updateTime;let s=$r(r,i.found.name),o=It(i.found.updateTime),a=i.found.createTime?It(i.found.createTime):ie.min(),c=new rn({mapValue:{fields:i.found.fields}});return Nt.newFoundDocument(s,o,a,c)}(n,e):"missing"in e?function(r,i){te(!!i.missing),te(!!i.readTime);let s=$r(r,i.missing),o=It(i.readTime);return Nt.newNoDocument(s,o)}(n,e):W()}function W4(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:W()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(l,d){return l.useProto3Json?(te(d===void 0||typeof d=="string"),Tt.fromBase64String(d||"")):(te(d===void 0||d instanceof Buffer||d instanceof Uint8Array),Tt.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(l){let d=l.code===void 0?P.UNKNOWN:iP(l.code);return new L(d,l.message||"")}(o);t=new Wp(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=$r(n,r.document.name),s=It(r.document.updateTime),o=r.document.createTime?It(r.document.createTime):ie.min(),a=new rn({mapValue:{fields:r.document.fields}}),c=Nt.newFoundDocument(i,s,o,a),l=r.targetIds||[],d=r.removedTargetIds||[];t=new nc(l,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=$r(n,r.document),s=r.readTime?It(r.readTime):ie.min(),o=Nt.newNoDocument(i,s),a=r.removedTargetIds||[];t=new nc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=$r(n,r.document),s=r.removedTargetIds||[];t=new nc([],s,i,null)}else{if(!("filter"in e))return W();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new ME(i,s),a=r.targetId;t=new Gp(a,o)}}return t}function Ql(n,e){let t;if(e instanceof ps)t={update:$M(n,e.key,e.value)};else if(e instanceof gs)t={delete:Kl(n,e.key)};else if(e instanceof pr)t={update:$M(n,e.key,e.data),updateMask:J4(e.fieldMask)};else{if(!(e instanceof ql))return W();t={verify:Kl(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof hs)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ii)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ti)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof fs)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw W()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:z4(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:W()}(n,e.precondition)),t}function VE(n,e){let t=e.currentDocument?function(s){return s.updateTime!==void 0?pt.updateTime(It(s.updateTime)):s.exists!==void 0?pt.exists(s.exists):pt.none()}(e.currentDocument):pt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)te(a.setToServerValue==="REQUEST_TIME"),c=new hs;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];c=new Ii(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];c=new Ti(d)}else"increment"in a?c=new fs(o,a.increment):W();let l=Et.fromServerFormat(a.fieldPath);return new Io(l,c)}(n,i)):[];if(e.update){e.update.name;let i=$r(n,e.update.name),s=new rn({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let l=c.fieldPaths||[];return new Ln(l.map(d=>Et.fromServerFormat(d)))}(e.updateMask);return new pr(i,s,o,t,r)}return new ps(i,s,t,r)}if(e.delete){let i=$r(n,e.delete);return new gs(i,t)}if(e.verify){let i=$r(n,e.verify);return new ql(i,t)}return W()}function K4(n,e){return n&&n.length>0?(te(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?It(i.updateTime):It(s);return o.isEqual(ie.min())&&(o=It(s)),new RE(o,i.transformResults||[])}(t,e))):[]}function hP(n,e){return{documents:[cP(n,e.path)]}}function fP(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=cP(n,i);let s=function(l){if(l.length!==0)return mP(Be.create(l,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(d=>function(g){return{field:Ya(g.field),direction:Y4(g.dir)}}(d))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=OE(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(e.endAt)),{_t:t,parent:i}}function pP(n){let e=uP(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){te(r===1);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(f){let g=gP(f);return g instanceof Be&&cT(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(g=>function(v){return new wo(Za(v.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(f){let g;return g=typeof f=="object"?f.value:f,od(g)?null:g}(t.limit));let c=null;t.startAt&&(c=function(f){let g=!!f.before,y=f.values||[];return new zr(y,g)}(t.startAt));let l=null;return t.endAt&&(l=function(f){let g=!f.before,y=f.values||[];return new zr(y,g)}(t.endAt)),$N(e,i,o,s,a,"F",c,l)}function Q4(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return W()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function gP(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Za(t.unaryFilter.field);return Re.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Za(t.unaryFilter.field);return Re.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Za(t.unaryFilter.field);return Re.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Za(t.unaryFilter.field);return Re.create(o,"!=",{nullValue:"NULL_VALUE"});default:return W()}}(n):n.fieldFilter!==void 0?function(t){return Re.create(Za(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return W()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Be.create(t.compositeFilter.filters.map(r=>gP(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return W()}}(t.compositeFilter.op))}(n):W()}function Y4(n){return $4[n]}function Z4(n){return q4[n]}function X4(n){return H4[n]}function Ya(n){return{fieldPath:n.canonicalString()}}function Za(n){return Et.fromServerFormat(n.fieldPath)}function mP(n){return n instanceof Re?function(t){if(t.op==="=="){if(DM(t.value))return{unaryFilter:{field:Ya(t.field),op:"IS_NAN"}};if(CM(t.value))return{unaryFilter:{field:Ya(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(DM(t.value))return{unaryFilter:{field:Ya(t.field),op:"IS_NOT_NAN"}};if(CM(t.value))return{unaryFilter:{field:Ya(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ya(t.field),op:Z4(t.op),value:t.value}}}(n):n instanceof Be?function(t){let r=t.getFilters().map(i=>mP(i));return r.length===1?r[0]:{compositeFilter:{op:X4(t.op),filters:r}}}(n):W()}function J4(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function yP(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var lc=class n{constructor(e,t,r,i,s=ie.min(),o=ie.min(),a=Tt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Qp=class{constructor(e){this.ct=e}};function ez(n,e){let t;if(e.document)t=dP(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=H.fromSegments(e.noDocument.path),i=Co(e.noDocument.readTime);t=Nt.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return W();{let r=H.fromSegments(e.unknownDocument.path),i=Co(e.unknownDocument.version);t=Nt.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){let s=new ut(i[0],i[1]);return ie.fromTimestamp(s)}(e.readTime)),t}function qM(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Yp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Kl(s,o.key),fields:o.data.value.mapValue.fields,updateTime:uc(s,o.version.toTimestamp()),createTime:uc(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:To(e.version)};else{if(!e.isUnknownDocument())return W();r.unknownDocument={path:t.path.toArray(),version:To(e.version)}}return r}function Yp(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function To(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Co(n){let e=new ut(n.seconds,n.nanoseconds);return ie.fromTimestamp(e)}function fo(n,e){let t=(e.baseMutations||[]).map(s=>VE(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>VE(n.ct,s)),i=ut.fromMillis(e.localWriteTimeMs);return new Hl(e.batchId,i,t,r)}function Ml(n){let e=Co(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Co(n.lastLimboFreeSnapshotVersion):ie.min(),r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return te(s.documents.length===1),hn(Ec(uP(s.documents[0])))}(n.query):function(s){return hn(pP(s))}(n.query),new lc(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Tt.fromBase64String(n.resumeToken))}function _P(n,e){let t=To(e.snapshotVersion),r=To(e.lastLimboFreeSnapshotVersion),i;i=qp(e.target)?hP(n.ct,e.target):fP(n.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Eo(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function fT(n){let e=pP({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?zp(e,e.limit,"L"):e}function Jw(n,e){return new zl(e.largestBatchId,VE(n.ct,e.overlayMutation))}function HM(n,e){let t=e.path.lastSegment();return[n,dn(e.path.popLast()),t]}function zM(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:To(r.readTime),documentKey:dn(r.documentKey.path),largestBatchId:r.largestBatchId}}var UE=class{getBundleMetadata(e,t){return GM(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:Co(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return GM(e).put(function(i){return{bundleId:i.id,createTime:To(It(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return WM(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:fT(s.bundledQuery),readTime:Co(s.readTime)}}(r)})}saveNamedQuery(e,t){return WM(e).put(function(i){return{name:i.name,readTime:To(It(i.readTime)),bundledQuery:i.bundledQuery}}(t))}};function GM(n){return Ot(n,"bundles")}function WM(n){return Ot(n,"namedQueries")}var Zp=class n{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return bl(e).get(HM(this.userId,t)).next(r=>r?Jw(this.serializer,r):null)}getOverlays(e,t){let r=jr();return x.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new zl(t,o);i.push(this.ht(e,a))}),x.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(dn(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(bl(e).j("collectionPathOverlayIndex",a))}),x.waitFor(s)}getOverlaysForCollection(e,t,r){let i=jr(),s=dn(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return bl(e).U("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let l=Jw(this.serializer,c);i.set(l.getKey(),l)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=jr(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return bl(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,d)=>{let f=Jw(this.serializer,l);s.size()<i||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return bl(e).put(function(i,s,o){let[a,c,l]=HM(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Ql(i.ct,o.mutation)}}(this.serializer,this.userId,t))}};function bl(n){return Ot(n,"documentOverlays")}var jE=class{Pt(e){return Ot(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{let r=t?.value;return r?Tt.fromUint8Array(r):Tt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var vi=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(st(e.integerValue));else if("doubleValue"in e){let r=st(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Vl(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Ei(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(us(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?kN(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Mg(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):W()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let s=e.fields||{};this.dt(t,53);let o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(st(a)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),H.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};vi.vt=new vi;function tz(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function KM(n){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=tz(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}var BE=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{let i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{let i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){let t=this.qt(e),r=KM(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){let t=this.qt(e),r=KM(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){let t=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){let t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){let t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},$E=class{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}},qE=class{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}},po=class{constructor(){this.jt=new BE,this.Ht=new $E(this.jt),this.Jt=new qE(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}};var go=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function ts(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=QM(n.arrayValue,e.arrayValue),t!==0?t:(t=QM(n.directionalValue,e.directionalValue),t!==0?t:H.comparator(n.documentKey,e.documentKey)))}function QM(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var Xp=class{constructor(e){this.Xt=new We((t,r)=>Et.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(let t of e.filters){let r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(te(e.collectionGroup===this.collectionId),this.nn)return!1;let t=lE(e);if(t!==void 0&&!this.sn(t))return!1;let r=lo(e),i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){let a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.on(a,c)||!this._n(this.en[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new We(Et.comparator),t=[];for(let r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new ec(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new ec(r.field,0))}for(let r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new ec(r.field,r.dir==="asc"?0:1)));return new ic(ic.UNKNOWN_ID,this.collectionId,t,Ll.empty())}sn(e){for(let t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function vP(n){var e,t;if(te(n instanceof Re||n instanceof Be),n instanceof Re){if(n instanceof $p){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>Re.create(n.field,"==",s)))||[];return Be.create(i,"or")}return n}let r=n.filters.map(i=>vP(i));return Be.create(r,n.op)}function nz(n){if(n.getFilters().length===0)return[];let e=GE(vP(n));return te(wP(e)),HE(e)||zE(e)?[e]:e.getFilters()}function HE(n){return n instanceof Re}function zE(n){return n instanceof Be&&cT(n)}function wP(n){return HE(n)||zE(n)||function(t){if(t instanceof Be&&_E(t)){for(let r of t.getFilters())if(!HE(r)&&!zE(r))return!1;return!0}return!1}(n)}function GE(n){if(te(n instanceof Re||n instanceof Be),n instanceof Re)return n;if(n.filters.length===1)return GE(n.filters[0]);let e=n.filters.map(r=>GE(r)),t=Be.create(e,n.op);return t=Jp(t),wP(t)?t:(te(t instanceof Be),te(oc(t)),te(t.filters.length>1),t.filters.reduce((r,i)=>pT(r,i)))}function pT(n,e){let t;return te(n instanceof Re||n instanceof Be),te(e instanceof Re||e instanceof Be),t=n instanceof Re?e instanceof Re?function(i,s){return Be.create([i,s],"and")}(n,e):YM(n,e):e instanceof Re?YM(e,n):function(i,s){if(te(i.filters.length>0&&s.filters.length>0),oc(i)&&oc(s))return UN(i,s.getFilters());let o=_E(i)?i:s,a=_E(i)?s:i,c=o.filters.map(l=>pT(l,a));return Be.create(c,"or")}(n,e),Jp(t)}function YM(n,e){if(oc(e))return UN(e,n.getFilters());{let t=e.filters.map(r=>pT(n,r));return Be.create(t,"or")}}function Jp(n){if(te(n instanceof Re||n instanceof Be),n instanceof Re)return n;let e=n.getFilters();if(e.length===1)return Jp(e[0]);if(LN(n))return n;let t=e.map(i=>Jp(i)),r=[];return t.forEach(i=>{i instanceof Re?r.push(i):i instanceof Be&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Be.create(r,n.op)}var WE=class{constructor(){this.un=new Yl}addToCollectionParentIndex(e,t){return this.un.add(t),x.resolve()}getCollectionParents(e,t){return x.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return x.resolve()}deleteFieldIndex(e,t){return x.resolve()}deleteAllFieldIndexes(e){return x.resolve()}createTargetIndexes(e,t){return x.resolve()}getDocumentsMatchingTarget(e,t){return x.resolve(null)}getIndexType(e,t){return x.resolve(0)}getFieldIndexes(e,t){return x.resolve([])}getNextCollectionGroupToUpdate(e){return x.resolve(null)}getMinOffset(e,t){return x.resolve(Xn.min())}getMinOffsetFromCollectionGroup(e,t){return x.resolve(Xn.min())}updateCollectionGroup(e,t,r){return x.resolve()}updateIndexEntries(e,t){return x.resolve()}},Yl=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new We(Pe.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new We(Pe.comparator)).toArray()}};var Cp=new Uint8Array(0),KE=class{constructor(e,t){this.databaseId=t,this.cn=new Yl,this.ln=new Gr(r=>Eo(r),(r,i)=>ad(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});let s={collectionId:r,parent:dn(i)};return ZM(e).put(s)}return x.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[IN(t),""],!1,!0);return ZM(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(Ur(o.parent))}return r})}addFieldIndex(e,t){let r=Sl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=Ga(e);return s.next(a=>{o.put(zM(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=Sl(e),i=Ga(e),s=za(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let t=Sl(e),r=za(e),i=Ga(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return x.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Xp(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){let r=za(e),i=!0,s=new Map;return x.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=me(),a=[];return x.forEach(s,(c,l)=>{U("IndexedDbIndexManager",`Using index ${function(O){return`id=${O.indexId}|cg=${O.collectionGroup}|f=${O.fields.map(z=>`${z.fieldPath}:${z.kind}`).join(",")}`}(c)} to execute ${Eo(t)}`);let d=function(O,z){let re=lE(z);if(re===void 0)return null;for(let Z of Hp(O,re.fieldPath))switch(Z.op){case"array-contains-any":return Z.value.arrayValue.values||[];case"array-contains":return[Z.value]}return null}(l,c),f=function(O,z){let re=new Map;for(let Z of lo(z))for(let I of Hp(O,Z.fieldPath))switch(I.op){case"==":case"in":re.set(Z.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return re.set(Z.fieldPath.canonicalString(),I.value),Array.from(re.values())}return null}(l,c),g=function(O,z){let re=[],Z=!0;for(let I of lo(z)){let _=I.kind===0?xM(O,I.fieldPath,O.startAt):MM(O,I.fieldPath,O.startAt);re.push(_.value),Z&&(Z=_.inclusive)}return new zr(re,Z)}(l,c),y=function(O,z){let re=[],Z=!0;for(let I of lo(z)){let _=I.kind===0?MM(O,I.fieldPath,O.endAt):xM(O,I.fieldPath,O.endAt);re.push(_.value),Z&&(Z=_.inclusive)}return new zr(re,Z)}(l,c),v=this.In(c,l,g),b=this.In(c,l,y),C=this.Tn(c,l,f),V=this.En(c.indexId,d,v,g.inclusive,b,y.inclusive,C);return x.forEach(V,B=>r.G(B,t.limit).next(O=>{O.forEach(z=>{let re=H.fromSegments(z.documentKey);o.has(re)||(o=o.add(re),a.push(re))})}))}).next(()=>a)}return x.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=nz(Be.create(e.filters,"and")).map(r=>SE(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,s,o,a){let c=(t!=null?t.length:1)*Math.max(r.length,s.length),l=c/(t!=null?t.length:1),d=[];for(let f=0;f<c;++f){let g=t?this.dn(t[f/l]):Cp,y=this.An(e,g,r[f%l],i),v=this.Rn(e,g,s[f%l],o),b=a.map(C=>this.An(e,g,C,!0));d.push(...this.createRange(y,v,b))}return d}An(e,t,r,i){let s=new go(e,H.empty(),t,r);return i?s:s.Zt()}Rn(e,t,r,i){let s=new go(e,H.empty(),t,r);return i?s.Zt():s}Pn(e,t){let r=new Xp(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.hn(t);return x.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let l=new We(Et.comparator),d=!1;for(let f of c.filters)for(let g of f.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:l=l.add(g.field));for(let f of c.orderBy)f.field.isKeyField()||(l=l.add(f.field));return l.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){let r=new po;for(let i of lo(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Yt(i.kind);vi.vt.It(s,o)}return r.zt()}dn(e){let t=new po;return vi.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){let r=new po;return vi.vt.It(vo(this.databaseId,t),r.Yt(function(s){let o=lo(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new po);let s=0;for(let o of lo(e)){let a=r[s++];for(let c of i)if(this.fn(t,o.fieldPath)&&$l(a))i=this.gn(i,o,a);else{let l=c.Yt(o.kind);vi.vt.It(a,l)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new po;c.seed(a.zt()),vi.vt.It(o,c.Yt(t.kind)),s.push(c)}return s}fn(e,t){return!!e.filters.find(r=>r instanceof Re&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Sl(e),i=Ga(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{let o=[];return x.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(d,f){let g=f?new Ll(f.sequenceNumber,new Xn(Co(f.readTime),new H(Ur(f.documentKey)),f.largestBatchId)):Ll.empty(),y=d.fields.map(([v,b])=>new ec(Et.fromServerFormat(v),b));return new ic(d.indexId,d.collectionGroup,y,g)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:pe(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Sl(e),s=Ga(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>x.forEach(a,c=>s.put(zM(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){let r=new Map;return x.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?x.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),x.forEach(a,c=>this.wn(e,i,c).next(l=>{let d=this.Sn(s,c);return l.isEqual(d)?x.resolve():this.bn(e,s,c,l,d)}))))})}Dn(e,t,r,i){return za(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return za(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){let i=za(e),s=new We(ts);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{s=s.add(new go(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(e,t){let r=new We(ts),i=this.Vn(t,e);if(i==null)return r;let s=lE(t);if(s!=null){let o=e.data.field(s.fieldPath);if($l(o))for(let a of o.arrayValue.values||[])r=r.add(new go(t.indexId,e.key,this.dn(a),i))}else r=r.add(new go(t.indexId,e.key,Cp,i));return r}bn(e,t,r,i,s){U("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(c,l,d,f,g){let y=c.getIterator(),v=l.getIterator(),b=Ha(y),C=Ha(v);for(;b||C;){let V=!1,B=!1;if(b&&C){let O=d(b,C);O<0?B=!0:O>0&&(V=!0)}else b!=null?B=!0:V=!0;V?(f(C),C=Ha(v)):B?(g(b),b=Ha(y)):(b=Ha(y),C=Ha(v))}}(i,s,ts,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),x.waitFor(o)}yn(e){let t=1;return Ga(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>ts(o,a)).filter((o,a,c)=>!a||ts(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=ts(o,e),c=ts(o,t);if(a===0)i[0]=e.Zt();else if(a>0&&c<0)i.push(o),i.push(o.Zt());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Cp,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Cp,[]];s.push(IDBKeyRange.bound(a,c))}return s}Cn(e,t){return ts(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(XM)}getMinOffset(e,t){return x.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||W())).next(XM)}};function ZM(n){return Ot(n,"collectionParents")}function za(n){return Ot(n,"indexEntries")}function Sl(n){return Ot(n,"indexConfiguration")}function Ga(n){return Ot(n,"indexState")}function XM(n){te(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;iT(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Xn(e.readTime,e.documentKey,t)}var JM={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Yn=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function EP(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=r.J({range:o},(d,f,g)=>(a++,g.delete()));s.push(c.next(()=>{te(a===1)}));let l=[];for(let d of t.mutations){let f=AN(e,d.key.path,t.batchId);s.push(i.delete(f)),l.push(d.key)}return x.waitFor(s).next(()=>l)}function eg(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw W();e=n.noDocument}return JSON.stringify(e).length}Yn.DEFAULT_COLLECTION_PERCENTILE=10,Yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yn.DEFAULT=new Yn(41943040,Yn.DEFAULT_COLLECTION_PERCENTILE,Yn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yn.DISABLED=new Yn(-1,0,0);var tg=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){te(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ns(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=Xa(e),o=ns(e);return o.add({}).next(a=>{te(typeof a=="number");let c=new Hl(a,t,r,i),l=function(y,v,b){let C=b.baseMutations.map(B=>Ql(y.ct,B)),V=b.mutations.map(B=>Ql(y.ct,B));return{userId:v,batchId:b.batchId,localWriteTimeMs:b.localWriteTime.toMillis(),baseMutations:C,mutations:V}}(this.serializer,this.userId,c),d=[],f=new We((g,y)=>pe(g.canonicalString(),y.canonicalString()));for(let g of i){let y=AN(this.userId,g.key.path,a);f=f.add(g.key.path.popLast()),d.push(o.put(l)),d.push(s.put(y,c4))}return f.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Fn[a]=c.keys()}),x.waitFor(d).next(()=>c)})}lookupMutationBatch(e,t){return ns(e).get(t).next(r=>r?(te(r.userId===this.userId),fo(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?x.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return ns(e).J({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(te(a.batchId>=r),s=fo(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return ns(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ns(e).U("userMutationsIndex",t).next(r=>r.map(i=>fo(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=Ap(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Xa(e).J({range:i},(o,a,c)=>{let[l,d,f]=o,g=Ur(d);if(l===this.userId&&t.path.isEqual(g))return ns(e).get(f).next(y=>{if(!y)throw W();te(y.userId===this.userId),s.push(fo(this.serializer,y))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new We(pe),i=[];return t.forEach(s=>{let o=Ap(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=Xa(e).J({range:a},(l,d,f)=>{let[g,y,v]=l,b=Ur(y);g===this.userId&&s.path.isEqual(b)?r=r.add(v):f.done()});i.push(c)}),x.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=Ap(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new We(pe);return Xa(e).J({range:o},(c,l,d)=>{let[f,g,y]=c,v=Ur(g);f===this.userId&&r.isPrefixOf(v)?v.length===i&&(a=a.add(y)):d.done()}).next(()=>this.xn(e,a))}xn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(ns(e).get(s).next(o=>{if(o===null)throw W();te(o.userId===this.userId),r.push(fo(this.serializer,o))}))}),x.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return EP(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),x.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return x.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Xa(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=Ur(s[1]);i.push(c)}else a.done()}).next(()=>{te(i.length===0)})})}containsKey(e,t){return IP(e,this.userId,t)}Nn(e){return TP(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function IP(n,e,t){let r=Ap(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Xa(n).J({range:s,H:!0},(a,c,l)=>{let[d,f,g]=a;d===e&&f===i&&(o=!0),l.done()}).next(()=>o)}function ns(n){return Ot(n,"mutations")}function Xa(n){return Ot(n,"documentMutations")}function TP(n){return Ot(n,"mutationQueues")}var dc=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var QE=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{let r=new dc(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>ie.fromTimestamp(new ut(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Wa(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(te(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0,s=[];return Wa(e).J((o,a)=>{let c=Ml(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>x.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Wa(e).J((r,i)=>{let s=Ml(i);t(s)})}qn(e){return eN(e).get("targetGlobalKey").next(t=>(te(t!==null),t))}Qn(e,t){return eN(e).put("targetGlobalKey",t)}Kn(e,t){return Wa(e).put(_P(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){let r=Eo(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return Wa(e).J({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let l=Ml(a);ad(t,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=rs(e);return t.forEach(o=>{let a=dn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),x.waitFor(i)}removeMatchingKeys(e,t,r){let i=rs(e);return x.forEach(t,s=>{let o=dn(s.path);return x.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=rs(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=rs(e),s=me();return i.J({range:r,H:!0},(o,a,c)=>{let l=Ur(o[1]),d=new H(l);s=s.add(d)}).next(()=>s)}containsKey(e,t){let r=dn(t.path),i=IDBKeyRange.bound([r],[IN(r)],!1,!0),s=0;return rs(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ot(e,t){return Wa(e).get(t).next(r=>r?Ml(r):null)}};function Wa(n){return Ot(n,"targets")}function eN(n){return Ot(n,"targetGlobal")}function rs(n){return Ot(n,"targetDocuments")}function tN([n,e],[t,r]){let i=pe(n,t);return i===0?pe(e,r):i}var YE=class{constructor(e){this.Un=e,this.buffer=new We(tN),this.Wn=0}Gn(){return++this.Wn}zn(e){let t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();tN(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},ZE=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){U("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>M(this,null,function*(){this.jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){_s(t)?U("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):yield ys(t)}yield this.Hn(3e5)}))}},XE=class{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return x.resolve(Fn.oe);let r=new YE(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(U("LruGarbageCollector","Garbage collection skipped; disabled"),x.resolve(JM)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),JM):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,s,o,a,c,l,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(U("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(s=f,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(l=Date.now(),Ka()<=zn.DEBUG&&U("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${f} documents in `+(l-c)+`ms
Total Duration: ${l-d}ms`),x.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}};function rz(n,e){return new XE(n,e)}var JE=class{constructor(e,t){this.db=e,this.garbageCollector=rz(this,t)}Yn(e){let t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return Dp(e,r)}removeReference(e,t,r){return Dp(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Dp(e,t)}nr(e,t){return function(i,s){let o=!1;return TP(i).Y(a=>IP(i,a,s).next(c=>(c&&(o=!0),x.resolve(!c)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.tr(e,(o,a)=>{if(a<=t){let c=this.nr(e,o).next(l=>{if(!l)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ie.min()),rs(e).delete(function(f){return[0,dn(f.path)]}(o))))});i.push(c)}}).next(()=>x.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Dp(e,t)}tr(e,t){let r=rs(e),i,s=Fn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(s!==Fn.oe&&t(new H(Ur(i)),s),s=l,i=c):s=Fn.oe}).next(()=>{s!==Fn.oe&&t(new H(Ur(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Dp(n,e){return rs(n).put(function(r,i){return{targetId:0,path:dn(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}var ng=class{constructor(){this.changes=new Gr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Nt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?x.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var eI=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return uo(e).put(r)}removeEntry(e,t,r){return uo(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Yp(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=Nt.newInvalidDocument(t);return uo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Al(t))},(i,s)=>{r=this.ir(t,s)}).next(()=>r)}sr(e,t){let r={size:0,document:Nt.newInvalidDocument(t)};return uo(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Al(t))},(i,s)=>{r={document:this.ir(t,s),size:eg(s)}}).next(()=>r)}getEntries(e,t){let r=An();return this._r(e,t,(i,s)=>{let o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,t){let r=An(),i=new nt(H.comparator);return this._r(e,t,(s,o)=>{let a=this.ir(s,o);r=r.insert(s,a),i=i.insert(s,eg(o))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return x.resolve();let i=new We(iN);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(Al(i.first()),Al(i.last())),o=i.getIterator(),a=o.getNext();return uo(e).J({index:"documentKeyIndex",range:s},(c,l,d)=>{let f=H.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&iN(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,l),a=o.hasNext()?o.getNext():null),a?d.$(Al(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,a=[o.popLast().toArray(),o.lastSegment(),Yp(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return uo(e).U(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let d=An();for(let f of l){let g=this.ir(H.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);g.isFoundDocument()&&(ud(t,g)||i.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=An(),o=rN(t,r),a=rN(t,Xn.max());return uo(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,d)=>{let f=this.ir(H.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(f.key,f),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new tI(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return nN(e).get("remoteDocumentGlobalKey").next(t=>(te(!!t),t))}rr(e,t){return nN(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){let r=ez(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(ie.min())))return r}return Nt.newInvalidDocument(e)}};function CP(n){return new eI(n)}var tI=class extends ng{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Gr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new We((s,o)=>pe(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=qM(this.cr.serializer,o);i=i.add(s.path.popLast());let l=eg(c);r+=l-a.size,t.push(this.cr.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=qM(this.cr.serializer,o.convertToNoDocument(ie.min()));t.push(this.cr.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.cr.updateMetadata(e,r)),x.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function nN(n){return Ot(n,"remoteDocumentGlobal")}function uo(n){return Ot(n,"remoteDocumentsV14")}function Al(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function rN(n,e){let t=e.documentKey.path.toArray();return[n,Yp(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function iN(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=pe(t[s],r[s]),i)return i;return i=pe(t.length,r.length),i||(i=pe(t[t.length-2],r[r.length-2]),i||pe(t[t.length-1],r[r.length-1]))}var nI=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var rg=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&kl(r.mutation,i,Ln.empty(),ut.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,me()).next(()=>r))}getLocalViewOfDocuments(e,t,r=me()){let i=jr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=xl();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=jr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,me()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=An(),o=Pl(),a=function(){return Pl()}();return t.forEach((c,l)=>{let d=r.get(l.key);i.has(l.key)&&(d===void 0||d.mutation instanceof pr)?s=s.insert(l.key,l):d!==void 0?(o.set(l.key,d.mutation.getFieldMask()),kl(d.mutation,l,d.mutation.getFieldMask(),ut.now())):o.set(l.key,Ln.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,d)=>o.set(l,d)),t.forEach((l,d)=>{var f;return a.set(l,new nI(d,(f=o.get(l))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){let r=Pl(),i=new nt((o,a)=>o-a),s=me();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=t.get(c);if(l===null)return;let d=r.get(c)||Ln.empty();d=a.applyToLocalView(l,d),r.set(c,d);let f=(i.get(a.batchId)||me()).add(c);i=i.insert(a.batchId,f)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,d=c.value,f=KN();d.forEach(g=>{if(!s.has(g)){let y=tP(t.get(g),r.get(g));y!==null&&f.set(g,y),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,f))}return x.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return H.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):uT(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):x.resolve(jr()),a=-1,c=s;return o.next(l=>x.forEach(l,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(d)?x.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{c=c.insert(d,g)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,me())).next(d=>({batchId:a,changes:WN(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new H(t)).next(r=>{let i=xl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=xl();return this.indexManager.getCollectionParents(e,s).next(a=>x.forEach(a,c=>{let l=function(f,g){return new fr(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,r,i).next(d=>{d.forEach((f,g)=>{o=o.insert(f,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,l)=>{let d=l.getKey();o.get(d)===null&&(o=o.insert(d,Nt.newInvalidDocument(d)))});let a=xl();return o.forEach((c,l)=>{let d=s.get(c);d!==void 0&&kl(d.mutation,l,Ln.empty(),ut.now()),ud(t,l)&&(a=a.insert(c,l))}),a})}};var rI=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return x.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:It(i.createTime)}}(t)),x.resolve()}getNamedQuery(e,t){return x.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:fT(i.bundledQuery),readTime:It(i.readTime)}}(t)),x.resolve()}};var iI=class{constructor(){this.overlays=new nt(H.comparator),this.Ir=new Map}getOverlay(e,t){return x.resolve(this.overlays.get(t))}getOverlays(e,t){let r=jr();return x.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),x.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),x.resolve()}getOverlaysForCollection(e,t,r){let i=jr(),s=t.length+1,o=new H(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!t.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return x.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new nt((l,d)=>l-d),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===t&&l.largestBatchId>r){let d=s.get(l.largestBatchId);d===null&&(d=jr(),s=s.insert(l.largestBatchId,d)),d.set(l.getKey(),l)}}let a=jr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,d)=>a.set(l,d)),!(a.size()>=i)););return x.resolve(a)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new zl(t,r));let s=this.Ir.get(t);s===void 0&&(s=me(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}};var sI=class{constructor(){this.sessionToken=Tt.EMPTY_BYTE_STRING}getSessionToken(e){return x.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,x.resolve()}};var Zl=class{constructor(){this.Tr=new We(Rt.Er),this.dr=new We(Rt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new Rt(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new Rt(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new H(new Pe([])),r=new Rt(t,e),i=new Rt(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new H(new Pe([])),r=new Rt(t,e),i=new Rt(t,e+1),s=me();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Rt(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Rt=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return H.comparator(e.key,t.key)||pe(e.wr,t.wr)}static Ar(e,t){return pe(e.wr,t.wr)||H.comparator(e.key,t.key)}};var oI=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new We(Rt.Er)}checkEmpty(e){return x.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Hl(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.br=this.br.add(new Rt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return x.resolve(o)}lookupMutationBatch(e,t){return x.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),s=i<0?0:i;return x.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return x.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return x.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Rt(t,0),i=new Rt(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{let a=this.Dr(o.wr);s.push(a)}),x.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new We(pe);return t.forEach(i=>{let s=new Rt(i,0),o=new Rt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),x.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;H.isDocumentKey(s)||(s=s.child(""));let o=new Rt(new H(s),0),a=new We(pe);return this.br.forEachWhile(c=>{let l=c.key.path;return!!r.isPrefixOf(l)&&(l.length===i&&(a=a.add(c.wr)),!0)},o),x.resolve(this.Cr(a))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){te(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return x.forEach(t.mutations,i=>{let s=new Rt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new Rt(t,0),i=this.br.firstAfterOrEqual(r);return x.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,x.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var aI=class{constructor(e){this.Mr=e,this.docs=function(){return new nt(H.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return x.resolve(r?r.document.mutableCopy():Nt.newInvalidDocument(t))}getEntries(e,t){let r=An();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Nt.newInvalidDocument(i))}),x.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=An(),o=t.path,a=new H(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:d}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||iT(CN(d),r)<=0||(i.has(d.key)||ud(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return x.resolve(s)}getAllFromCollectionGroup(e,t,r,i){W()}Or(e,t){return x.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new cI(this)}getSize(e){return x.resolve(this.size)}},cI=class extends ng{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),x.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var uI=class{constructor(e){this.persistence=e,this.Nr=new Gr(t=>Eo(t),ad),this.lastRemoteSnapshotVersion=ie.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Zl,this.targetCount=0,this.kr=dc.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),x.resolve()}getLastRemoteSnapshotVersion(e){return x.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return x.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),x.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),x.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new dc(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,x.resolve()}updateTargetData(e,t){return this.Kn(t),x.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,x.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),x.waitFor(s).next(()=>i)}getTargetCount(e){return x.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return x.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),x.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),x.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),x.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return x.resolve(r)}containsKey(e,t){return x.resolve(this.Br.containsKey(t))}};var ig=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Fn(0),this.Kr=!1,this.Kr=!0,this.$r=new sI,this.referenceDelegate=e(this),this.Ur=new uI(this),this.indexManager=new WE,this.remoteDocumentCache=function(i){return new aI(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new Qp(t),this.Gr=new rI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new iI,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new oI(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){U("MemoryPersistence","Starting transaction:",e);let i=new lI(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return x.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},lI=class extends Lp{constructor(e){super(),this.currentSequenceNumber=e}},sg=class n{constructor(e){this.persistence=e,this.Jr=new Zl,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw W()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),x.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),x.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),x.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x.forEach(this.Xr,r=>{let i=H.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,ie.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return x.or([()=>x.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var dI=class{constructor(e){this.serializer=e}O(e,t,r,i){let s=new Vp("createOrUpgrade",t);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",wM,{unique:!0}),c.createObjectStore("documentMutations")}(e),sN(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=x.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),sN(e)),o=o.next(()=>function(c){let l=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ie.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",wM,{unique:!0});let f=l.store("mutations"),g=d.map(y=>f.put(y));return x.waitFor(g)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:w4});l.createIndex("collectionPathOverlayIndex",E4,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",I4,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:u4});l.createIndex("documentKeyIndex",l4),l.createIndex("collectionGroupIndex",d4)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:m4}).createIndex("sequenceNumberIndex",y4,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:_4}).createIndex("documentKeyIndex",v4,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=eg(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>x.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>x.forEach(a,c=>{te(c.userId===s.userId);let l=fo(this.serializer,c);return EP(e,s.userId,l).next(()=>{})}))}))}ii(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let c=new Pe(o),l=function(f){return[0,dn(f)]}(c);s.push(t.get(l).next(d=>d?x.resolve():(f=>t.put({targetId:0,path:dn(f),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>x.waitFor(s))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:g4});let r=t.store("collectionParents"),i=new Yl,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:dn(c)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{let c=new Pe(o);return s(c.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,c],l)=>{let d=Ur(a);return s(d.popLast())}))}oi(e){let t=e.store("targets");return t.J((r,i)=>{let s=Ml(i),o=_P(this.serializer,s);return t.put(o)})}_i(e,t){let r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=t.store("remoteDocumentsV14"),c=function(f){return f.document?new H(Pe.fromString(f.document.name).popFirst(5)):f.noDocument?H.fromSegments(f.noDocument.path):f.unknownDocument?H.fromSegments(f.unknownDocument.path):W()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>x.waitFor(i))}ai(e,t){let r=t.store("mutations"),i=CP(this.serializer),s=new ig(sg.Zr,this.serializer.ct);return r.U().next(o=>{let a=new Map;return o.forEach(c=>{var l;let d=(l=a.get(c.userId))!==null&&l!==void 0?l:me();fo(this.serializer,c).keys().forEach(f=>d=d.add(f)),a.set(c.userId,d)}),x.forEach(a,(c,l)=>{let d=new xt(l),f=Zp.lt(this.serializer,d),g=s.getIndexManager(d),y=tg.lt(d,this.serializer,g,s.referenceDelegate);return new rg(i,y,f,g).recalculateAndSaveOverlaysForDocumentKeys(new Ul(t,Fn.oe),c).next()})})}};function sN(n){n.createObjectStore("targetDocuments",{keyPath:f4}).createIndex("documentTargetsIndex",p4,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",h4,{unique:!0}),n.createObjectStore("targetGlobal")}var eE="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",hI=class n{constructor(e,t,r,i,s,o,a,c,l,d,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=s,this.window=o,this.document=a,this.ci=l,this.li=d,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=g=>Promise.resolve(),!n.D())throw new L(P.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new JE(this,i),this.Ai=t+"main",this.serializer=new Qp(c),this.Ri=new cs(this.Ai,this.hi,new dI(this.serializer)),this.$r=new jE,this.Ur=new QE(this.referenceDelegate,this.serializer),this.remoteDocumentCache=CP(this.serializer),this.Gr=new UE,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&wt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new L(P.FAILED_PRECONDITION,eE);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Fn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=t=>M(this,null,function*(){if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(t=>M(this,null,function*(){t.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(()=>M(this,null,function*(){this.started&&(yield this.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>bp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(_s(e))return U("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return U("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Rl(e).get("owner").next(t=>x.resolve(this.vi(t)))}Ci(e){return bp(e).delete(this.clientId)}Fi(){return M(this,null,function*(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Ot(t,"clientMetadata");return r.U().next(i=>{let s=this.xi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return x.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(let t of e)this.Vi.removeItem(this.Oi(t.clientId))}})}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?x.resolve(!0):Rl(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new L(P.FAILED_PRECONDITION,eE);return!1}}return!(!this.networkEnabled||!this.inForeground)||bp(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&U("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){return M(this,null,function*(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),yield this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new Ul(e,Fn.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()})}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>bp(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return tg.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new KE(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Zp.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){U("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=function(c){return c===17?D4:c===16?C4:c===15?oT:c===14?MN:c===13?xN:c===12?T4:c===11?RN:void W()}(this.hi),o;return this.Ri.runTransaction(e,i,s,a=>(o=new Ul(a,this.Qr?this.Qr.next():Fn.oe),t==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw wt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new L(P.FAILED_PRECONDITION,DN);return r(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return Rl(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new L(P.FAILED_PRECONDITION,eE)})}Di(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Rl(e).put("owner",t)}static D(){return cs.D()}bi(e){let t=Rl(e);return t.get("owner").next(r=>this.vi(r)?(U("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):x.resolve())}Mi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(wt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();let t=/(?:Version|Mobile)\/1[456]/;py()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{let r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return U("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return wt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){wt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Rl(n){return Ot(n,"owner")}function bp(n){return Ot(n,"clientMetadata")}function gT(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var fI=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=me(),i=me();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var pI=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var og=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return py()?8:bN(_u())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new pI;return this.Xi(e,t,o).next(a=>{if(s.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Ka()<=zn.DEBUG&&U("QueryEngine","SDK will not create cache indexes for query:",Qa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),x.resolve()):(Ka()<=zn.DEBUG&&U("QueryEngine","Query:",Qa(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Ka()<=zn.DEBUG&&U("QueryEngine","The SDK decides to create cache indexes for query:",Qa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,hn(t))):x.resolve())}Yi(e,t){if(NM(t))return x.resolve(null);let r=hn(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=zp(t,null,"F"),r=hn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=me(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let l=this.ts(t,a);return this.ns(t,l,o,c.readTime)?this.Yi(e,zp(t,null,"F")):this.rs(e,l,t,c)}))})))}Zi(e,t,r,i){return NM(t)||i.isEqual(ie.min())?x.resolve(null):this.Ji.getDocuments(e,r).next(s=>{let o=this.ts(t,s);return this.ns(t,o,r,i)?x.resolve(null):(Ka()<=zn.DEBUG&&U("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Qa(t)),this.rs(e,o,t,TN(i,-1)).next(a=>a))})}ts(e,t){let r=new We(zN(e));return t.forEach((i,s)=>{ud(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return Ka()<=zn.DEBUG&&U("QueryEngine","Using full collection scan to execute query:",Qa(t)),this.Ji.getDocumentsMatchingQuery(e,t,Xn.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var gI=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new nt(pe),this._s=new Gr(s=>Eo(s),ad),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new rg(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function DP(n,e,t,r){return new gI(n,e,t,r)}function bP(n,e){return M(this,null,function*(){let t=q(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=me();for(let l of i){o.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}for(let l of s){a.push(l.batchId);for(let d of l.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(l=>({hs:l,removedBatchIds:o,addedBatchIds:a}))})})})}function iz(n,e){let t=q(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,c,l,d){let f=l.batch,g=f.keys(),y=x.resolve();return g.forEach(v=>{y=y.next(()=>d.getEntry(c,v)).next(b=>{let C=l.docVersions.get(v);te(C!==null),b.version.compareTo(C)<0&&(f.applyToRemoteDocument(b,l),b.isValidDocument()&&(b.setReadTime(l.commitVersion),d.addEntry(b)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(c,f))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=me();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function SP(n){let e=q(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function sz(n,e){let t=q(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let a=[];e.targetChanges.forEach((d,f)=>{let g=i.get(f);if(!g)return;a.push(t.Ur.removeMatchingKeys(s,d.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(s,d.addedDocuments,f)));let y=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?y=y.withResumeToken(Tt.EMPTY_BYTE_STRING,ie.min()).withLastLimboFreeSnapshotVersion(ie.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,r)),i=i.insert(f,y),function(b,C,V){return b.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=3e8?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0}(g,y,d)&&a.push(t.Ur.updateTargetData(s,y))});let c=An(),l=me();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(AP(s,o,e.documentUpdates).next(d=>{c=d.Ps,l=d.Is})),!r.isEqual(ie.min())){let d=t.Ur.getLastRemoteSnapshotVersion(s).next(f=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return x.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(t.os=i,s))}function AP(n,e,t){let r=me(),i=me();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=An();return t.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(ie.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):U("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Ps:o,Is:i}})}function oz(n,e){let t=q(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function hc(n,e){let t=q(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,x.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new lc(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function fc(n,e,t){return M(this,null,function*(){let r=q(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!_s(o))throw o;U("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function ag(n,e,t){let r=q(n),i=ie.min(),s=me();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,d){let f=q(c),g=f._s.get(d);return g!==void 0?x.resolve(f.os.get(g)):f.Ur.getTargetData(l,d)}(r,o,hn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:ie.min(),t?s:me())).next(a=>(MP(r,HN(e),a),{documents:a,Ts:s})))}function RP(n,e){let t=q(n),r=q(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function xP(n,e){let t=q(n),r=t.us.get(e)||ie.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,TN(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(MP(t,e,i),i))}function MP(n,e,t){let r=n.us.get(e)||ie.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}function az(n,e,t,r){return M(this,null,function*(){let i=q(n),s=me(),o=An();for(let l of t){let d=e.Es(l.metadata.name);l.document&&(s=s.add(d));let f=e.ds(l);f.setReadTime(e.As(l.metadata.readTime)),o=o.insert(d,f)}let a=i.cs.newChangeBuffer({trackRemovals:!0}),c=yield hc(i,function(d){return hn(Ec(Pe.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",l=>AP(l,a,o).next(d=>(a.apply(l),d)).next(d=>i.Ur.removeMatchingKeysForTargetId(l,c.targetId).next(()=>i.Ur.addMatchingKeys(l,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(l,d.Ps,d.Is)).next(()=>d.Ps)))})}function cz(r,i){return M(this,arguments,function*(n,e,t=me()){let s=yield hc(n,hn(fT(e.bundledQuery))),o=q(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=It(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.Gr.saveNamedQuery(a,e);let l=s.withResumeToken(Tt.EMPTY_BYTE_STRING,c);return o.os=o.os.insert(l.targetId,l),o.Ur.updateTargetData(a,l).next(()=>o.Ur.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Ur.addMatchingKeys(a,t,s.targetId)).next(()=>o.Gr.saveNamedQuery(a,e))})})}function oN(n,e){return`firestore_clients_${n}_${e}`}function aN(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function tE(n,e){return`firestore_targets_${n}_${e}`}var cg=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Rs(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new L(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(wt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Ol=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new L(r.error.code,r.error.message))),s?new n(e,r.state,i):(wt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},ug=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=lT();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=SN(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(wt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},mI=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(wt("SharedClientState",`Failed to parse online state: ${e}`),null)}},Xl=class{constructor(){this.activeTargetIds=lT()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Fl=class{constructor(e,t,r,i,s){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new nt(pe),this.started=!1,this.bs=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=oN(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Xl),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}start(){return M(this,null,function*(){let e=yield this.syncEngine.Qi();for(let r of e){if(r===this.ps)continue;let i=this.getItem(oN(this.persistenceKey,r));if(i){let s=ug.Rs(r,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();let t=this.storage.getItem(this.xs);if(t){let r=this.Ls(t);r&&this.Bs(r)}for(let r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(tE(this.persistenceKey,e));if(r){let i=Ol.Rs(e,r);i&&(t=i.state)}}return this.Ks.fs(e),this.Ns(),t}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(tE(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return U("SharedClientState","READ",e,t),t}setItem(e,t){U("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){U("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){let t=e;if(t.storageArea===this.storage){if(U("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void wt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(()=>M(this,null,function*(){if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){let r=this.Gs(t.key);return this.zs(r,null)}{let r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){let r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){let r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){let r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){let r=function(s){let o=Fn.oe;if(s!=null)try{let a=JSON.parse(s);te(typeof a=="number"),o=a}catch(a){wt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==Fn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){let r=this.Xs(t.newValue);yield Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){let i=new cg(this.currentUser,e,t,r),s=aN(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){let t=aN(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){let t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){let i=tE(this.persistenceKey,e),s=new Ol(e,t,r);this.setItem(i,s.Vs())}Ws(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){let t=this.Cs.exec(e);return t?t[1]:null}js(e,t){let r=this.Gs(e);return ug.Rs(r,t)}Hs(e,t){let r=this.Fs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return cg.Rs(new xt(s),i,t)}Ys(e,t){let r=this.Ms.exec(e),i=Number(r[1]);return Ol.Rs(i,t)}Ls(e){return mI.Rs(e)}Xs(e){return JSON.parse(e)}Js(e){return M(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);U("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){let r=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=lT();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},lg=class{constructor(){this.so=new Xl,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Xl,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var yI=class{_o(e){}shutdown(){}};var dg=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){U("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){U("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Sp=null;function nE(){return Sp===null?Sp=function(){return 268435456+Math.round(2147483648*Math.random())}():Sp++,"0x"+Sp.toString(16)}var uz={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var _I=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var nn="WebChannelConnection",vI=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){let a=nE(),c=this.xo(t,r.toUriEncodedString());U("RestConnection",`Sending RPC '${t}' ${a}:`,c,i);let l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,s,o),this.No(t,c,l,i).then(d=>(U("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw Zn("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}Lo(t,r,i,s,o,a){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+wc}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){let i=uz[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let s=nE();return new Promise((o,a)=>{let c=new Ww;c.setWithCredentials(!0),c.listenOnce(Qw.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Dl.NO_ERROR:let d=c.getResponseJson();U(nn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Dl.TIMEOUT:U(nn,`RPC '${e}' ${s} timed out`),a(new L(P.DEADLINE_EXCEEDED,"Request time out"));break;case Dl.HTTP_ERROR:let f=c.getStatus();if(U(nn,`RPC '${e}' ${s} failed with status:`,f,"response text:",c.getResponseText()),f>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);let y=g?.error;if(y&&y.status&&y.message){let v=function(C){let V=C.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(V)>=0?V:P.UNKNOWN}(y.status);a(new L(v,y.message))}else a(new L(P.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new L(P.UNAVAILABLE,"Connection failed."));break;default:W()}}finally{U(nn,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);U(nn,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",l,r,15)})}Bo(e,t,r){let i=nE(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Xw(),a=Zw(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new Kw({})),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=s.join("");U(nn,`Creating RPC '${e}' stream ${i}: ${d}`,c);let f=o.createWebChannel(d,c),g=!1,y=!1,v=new _I({Io:C=>{y?U(nn,`Not sending because RPC '${e}' stream ${i} is closed:`,C):(g||(U(nn,`Opening RPC '${e}' stream ${i} transport.`),f.open(),g=!0),U(nn,`RPC '${e}' stream ${i} sending:`,C),f.send(C))},To:()=>f.close()}),b=(C,V,B)=>{C.listen(V,O=>{try{B(O)}catch(z){setTimeout(()=>{throw z},0)}})};return b(f,qa.EventType.OPEN,()=>{y||(U(nn,`RPC '${e}' stream ${i} transport opened.`),v.yo())}),b(f,qa.EventType.CLOSE,()=>{y||(y=!0,U(nn,`RPC '${e}' stream ${i} transport closed`),v.So())}),b(f,qa.EventType.ERROR,C=>{y||(y=!0,Zn(nn,`RPC '${e}' stream ${i} transport errored:`,C),v.So(new L(P.UNAVAILABLE,"The operation could not be completed")))}),b(f,qa.EventType.MESSAGE,C=>{var V;if(!y){let B=C.data[0];te(!!B);let O=B,z=O.error||((V=O[0])===null||V===void 0?void 0:V.error);if(z){U(nn,`RPC '${e}' stream ${i} received error:`,z);let re=z.status,Z=function(w){let T=At[w];if(T!==void 0)return iP(T)}(re),I=z.message;Z===void 0&&(Z=P.INTERNAL,I="Unknown error status: "+re+" with message "+z.message),y=!0,v.So(new L(Z,I)),f.close()}else U(nn,`RPC '${e}' stream ${i} received:`,B),v.bo(B)}}),b(a,Yw.STAT_EVENT,C=>{C.stat===Tp.PROXY?U(nn,`RPC '${e}' stream ${i} detected buffering proxy`):C.stat===Tp.NOPROXY&&U(nn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.wo()},0),v}};function NP(){return typeof window<"u"?window:null}function Np(){return typeof document<"u"?document:null}function ld(n){return new kE(n,!0)}var Jl=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&U("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var hg=class{constructor(e,t,r,i,s,o,a,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Jl(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return M(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return M(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return M(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(wt(t.toString()),wt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new L(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>M(this,null,function*(){this.state=0,this.start()}))}I_(e){return U("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(U("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},wI=class extends hg{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=W4(this.serializer,e),r=function(s){if(!("targetChange"in s))return ie.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?ie.min():o.readTime?It(o.readTime):ie.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=LE(this.serializer),t.addTarget=function(s,o){let a,c=o.target;if(a=qp(c)?{documents:hP(s,c)}:{query:fP(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=oP(s,o.resumeToken);let l=OE(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(ie.min())>0){a.readTime=uc(s,o.snapshotVersion.toTimestamp());let l=OE(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,e);let r=Q4(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=LE(this.serializer),t.removeTarget=e,this.a_(t)}},EI=class extends hg{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return te(!!e.streamToken),this.lastStreamToken=e.streamToken,te(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){te(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=K4(e.writeResults,e.commitTime),r=It(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=LE(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Ql(this.serializer,r))};this.a_(t)}};var II=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new L(P.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,FE(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new L(P.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,FE(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new L(P.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},TI=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(wt(t),this.D_=!1):U("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var CI=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(()=>M(this,null,function*(){vs(this)&&(U("RemoteStore","Restarting streams for network reachability change."),yield function(c){return M(this,null,function*(){let l=q(c);l.L_.add(4),yield Ic(l),l.q_.set("Unknown"),l.L_.delete(4),yield dd(l)})}(this))}))}),this.q_=new TI(r,i)}};function dd(n){return M(this,null,function*(){if(vs(n))for(let e of n.B_)yield e(!0)})}function Ic(n){return M(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Ng(n,e){let t=q(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),_T(t)?yT(t):Cc(t).r_()&&mT(t,e))}function pc(n,e){let t=q(n),r=Cc(t);t.N_.delete(e),r.r_()&&PP(t,e),t.N_.size===0&&(r.r_()?r.o_():vs(t)&&t.q_.set("Unknown"))}function mT(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ie.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Cc(n).A_(e)}function PP(n,e){n.Q_.xe(e),Cc(n).R_(e)}function yT(n){n.Q_=new PE({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Cc(n).start(),n.q_.v_()}function _T(n){return vs(n)&&!Cc(n).n_()&&n.N_.size>0}function vs(n){return q(n).L_.size===0}function kP(n){n.Q_=void 0}function lz(n){return M(this,null,function*(){n.q_.set("Online")})}function dz(n){return M(this,null,function*(){n.N_.forEach((e,t)=>{mT(n,e)})})}function hz(n,e){return M(this,null,function*(){kP(n),_T(n)?(n.q_.M_(e),yT(n)):n.q_.set("Unknown")})}function fz(n,e,t){return M(this,null,function*(){if(n.q_.set("Online"),e instanceof Wp&&e.state===2&&e.cause)try{yield function(i,s){return M(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.N_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))})}(n,e)}catch(r){U("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield fg(n,r)}else if(e instanceof nc?n.Q_.Ke(e):e instanceof Gp?n.Q_.He(e):n.Q_.We(e),!t.isEqual(ie.min()))try{let r=yield SP(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){let a=s.Q_.rt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.N_.get(l);d&&s.N_.set(l,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let d=s.N_.get(c);if(!d)return;s.N_.set(c,d.withResumeToken(Tt.EMPTY_BYTE_STRING,d.snapshotVersion)),PP(s,c);let f=new lc(d.target,c,l,d.sequenceNumber);mT(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){U("RemoteStore","Failed to raise snapshot:",r),yield fg(n,r)}})}function fg(n,e,t){return M(this,null,function*(){if(!_s(e))throw e;n.L_.add(1),yield Ic(n),n.q_.set("Offline"),t||(t=()=>SP(n.localStore)),n.asyncQueue.enqueueRetryable(()=>M(this,null,function*(){U("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield dd(n)}))})}function OP(n,e){return e().catch(t=>fg(n,t,e))}function Tc(n){return M(this,null,function*(){let e=q(n),t=ms(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;pz(e);)try{let i=yield oz(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,gz(e,i)}catch(i){yield fg(e,i)}FP(e)&&LP(e)})}function pz(n){return vs(n)&&n.O_.length<10}function gz(n,e){n.O_.push(e);let t=ms(n);t.r_()&&t.V_&&t.m_(e.mutations)}function FP(n){return vs(n)&&!ms(n).n_()&&n.O_.length>0}function LP(n){ms(n).start()}function mz(n){return M(this,null,function*(){ms(n).p_()})}function yz(n){return M(this,null,function*(){let e=ms(n);for(let t of n.O_)e.m_(t.mutations)})}function _z(n,e,t){return M(this,null,function*(){let r=n.O_.shift(),i=xE.from(r,e,t);yield OP(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Tc(n)})}function vz(n,e){return M(this,null,function*(){e&&ms(n).V_&&(yield function(r,i){return M(this,null,function*(){if(function(o){return rP(o)&&o!==P.ABORTED}(i.code)){let s=r.O_.shift();ms(r).s_(),yield OP(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Tc(r)}})}(n,e)),FP(n)&&LP(n)})}function cN(n,e){return M(this,null,function*(){let t=q(n);t.asyncQueue.verifyOperationInProgress(),U("RemoteStore","RemoteStore received new credentials");let r=vs(t);t.L_.add(3),yield Ic(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield dd(t)})}function DI(n,e){return M(this,null,function*(){let t=q(n);e?(t.L_.delete(2),yield dd(t)):e||(t.L_.add(2),yield Ic(t),t.q_.set("Unknown"))})}function Cc(n){return n.K_||(n.K_=function(t,r,i){let s=q(t);return s.w_(),new wI(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:lz.bind(null,n),Ro:dz.bind(null,n),mo:hz.bind(null,n),d_:fz.bind(null,n)}),n.B_.push(e=>M(this,null,function*(){e?(n.K_.s_(),_T(n)?yT(n):n.q_.set("Unknown")):(yield n.K_.stop(),kP(n))}))),n.K_}function ms(n){return n.U_||(n.U_=function(t,r,i){let s=q(t);return s.w_(),new EI(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:mz.bind(null,n),mo:vz.bind(null,n),f_:yz.bind(null,n),g_:_z.bind(null,n)}),n.B_.push(e=>M(this,null,function*(){e?(n.U_.s_(),yield Tc(n)):(yield n.U_.stop(),n.O_.length>0&&(U("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var bI=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Mt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Dc(n,e){if(wt("AsyncQueue",`${e}: ${n}`),_s(n))return new L(P.UNAVAILABLE,`${e}: ${n}`);throw n}var pg=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||H.comparator(t.key,r.key):(t,r)=>H.comparator(t.key,r.key),this.keyedMap=xl(),this.sortedSet=new nt(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var gg=class{constructor(){this.W_=new nt(H.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):W():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},gc=class n{constructor(e,t,r,i,s,o,a,c,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,pg.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&cd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var SI=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},AI=class{constructor(){this.queries=uN(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=q(t),s=i.queries;i.queries=uN(),s.forEach((o,a)=>{for(let c of a.j_)c.onError(r)})})(this,new L(P.ABORTED,"Firestore shutting down"))}};function uN(){return new Gr(n=>qN(n),cd)}function vT(n,e){return M(this,null,function*(){let t=q(n),r=3,i=e.query,s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new SI,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){let a=Dc(o,`Initialization of query '${Qa(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&ET(t)})}function wT(n,e){return M(this,null,function*(){let t=q(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function wz(n,e){let t=q(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&ET(t)}function Ez(n,e,t){let r=q(n),i=r.queries.get(e);if(i)for(let s of i.j_)s.onError(t);r.queries.delete(e)}function ET(n){n.Y_.forEach(e=>{e.next()})}var RI,lN;(lN=RI||(RI={})).ea="default",lN.Cache="cache";var ed=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new gc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=gc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==RI.Cache}};var xI=class{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}};var mg=class{constructor(e){this.serializer=e}Es(e){return $r(this.serializer,e)}ds(e){return e.metadata.exists?dP(this.serializer,e.document,!1):Nt.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return It(e)}},MI=class{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=VP(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;let r=Pe.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){let t=new Map,r=new mg(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Es(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||me()).add(s);t.set(o,a)}}return t}complete(){return M(this,null,function*(){let e=yield az(this.localStore,new mg(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(let r of this.queries)yield cz(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}})}};function VP(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var yg=class{constructor(e){this.key=e}},_g=class{constructor(e){this.key=e}},vg=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=me(),this.mutatedKeys=me(),this.Aa=zN(e),this.Ra=new pg(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new gg,i=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,l=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{let g=i.get(d),y=ud(this.query,f)?f:null,v=!!g&&this.mutatedKeys.has(g.key),b=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations),C=!1;g&&y?g.data.isEqual(y.data)?v!==b&&(r.track({type:3,doc:y}),C=!0):this.ga(g,y)||(r.track({type:2,doc:y}),C=!0,(c&&this.Aa(y,c)>0||l&&this.Aa(y,l)<0)&&(a=!0)):!g&&y?(r.track({type:0,doc:y}),C=!0):g&&!y&&(r.track({type:1,doc:g}),C=!0,(c||l)&&(a=!0)),C&&(y?(o=o.add(y),s=b?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let o=e.fa.G_();o.sort((d,f)=>function(y,v){let b=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W()}};return b(y)-b(v)}(d.type,f.type)||this.Aa(d.doc,f.doc)),this.pa(r),i=i!=null&&i;let a=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,l=c!==this.Ea;return this.Ea=c,o.length!==0||l?{snapshot:new gc(this.query,e.Ra,s,o,e.mutatedKeys,c===0,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new gg,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=me(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new _g(r))}),this.da.forEach(r=>{e.has(r)||t.push(new yg(r))}),t}ba(e){this.Ta=e.Ts,this.da=me();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return gc.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},NI=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},PI=class{constructor(e){this.key=e,this.va=!1}},kI=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Gr(a=>qN(a),cd),this.Ma=new Map,this.xa=new Set,this.Oa=new nt(H.comparator),this.Na=new Map,this.La=new Zl,this.Ba={},this.ka=new Map,this.qa=dc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function Iz(n,e,t=!0){return M(this,null,function*(){let r=Pg(n),i,s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield UP(r,e,t,!0),i})}function Tz(n,e){return M(this,null,function*(){let t=Pg(n);yield UP(t,e,!0,!1)})}function UP(n,e,t,r){return M(this,null,function*(){let i=yield hc(n.localStore,hn(e)),s=i.targetId,o=t?n.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield IT(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&Ng(n.remoteStore,i),a})}function IT(n,e,t,r,i){return M(this,null,function*(){n.Ka=(f,g,y)=>function(b,C,V,B){return M(this,null,function*(){let O=C.view.ma(V);O.ns&&(O=yield ag(b.localStore,C.query,!1).then(({documents:I})=>C.view.ma(I,O)));let z=B&&B.targetChanges.get(C.targetId),re=B&&B.targetMismatches.get(C.targetId)!=null,Z=C.view.applyChanges(O,b.isPrimaryClient,z,re);return OI(b,C.targetId,Z.wa),Z.snapshot})}(n,f,g,y);let s=yield ag(n.localStore,e,!0),o=new vg(e,s.Ts),a=o.ma(s.documents),c=Wl.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),l=o.applyChanges(a,n.isPrimaryClient,c);OI(n,t,l.wa);let d=new NI(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),l.snapshot})}function Cz(n,e,t){return M(this,null,function*(){let r=q(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!cd(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield fc(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&pc(r.remoteStore,i.targetId),mc(r,i.targetId)}).catch(ys))):(mc(r,i.targetId),yield fc(r.localStore,i.targetId,!0))})}function Dz(n,e){return M(this,null,function*(){let t=q(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),pc(t.remoteStore,r.targetId))})}function bz(n,e,t){return M(this,null,function*(){let r=bT(n);try{let i=yield function(o,a){let c=q(o),l=ut.now(),d=a.reduce((y,v)=>y.add(v.key),me()),f,g;return c.persistence.runTransaction("Locally write mutations","readwrite",y=>{let v=An(),b=me();return c.cs.getEntries(y,d).next(C=>{v=C,v.forEach((V,B)=>{B.isValidDocument()||(b=b.add(V))})}).next(()=>c.localDocuments.getOverlayedDocuments(y,v)).next(C=>{f=C;let V=[];for(let B of a){let O=j4(B,f.get(B.key).overlayedDocument);O!=null&&V.push(new pr(B.key,O,FN(O.value.mapValue),pt.exists(!0)))}return c.mutationQueue.addMutationBatch(y,l,V,a)}).next(C=>{g=C;let V=C.applyToLocalDocumentSet(f,b);return c.documentOverlayCache.saveOverlays(y,C.batchId,V)})}).then(()=>({batchId:g.batchId,changes:WN(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let l=o.Ba[o.currentUser.toKey()];l||(l=new nt(pe)),l=l.insert(a,c),o.Ba[o.currentUser.toKey()]=l}(r,i.batchId,t),yield bi(r,i.changes),yield Tc(r.remoteStore)}catch(i){let s=Dc(i,"Failed to persist write");t.reject(s)}})}function jP(n,e){return M(this,null,function*(){let t=q(n);try{let r=yield sz(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Na.get(s);o&&(te(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?te(o.va):i.removedDocuments.size>0&&(te(o.va),o.va=!1))}),yield bi(t,r,e)}catch(r){yield ys(r)}})}function dN(n,e,t){let r=q(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((s,o)=>{let a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=q(o);c.onlineState=a;let l=!1;c.queries.forEach((d,f)=>{for(let g of f.j_)g.Z_(a)&&(l=!0)}),l&&ET(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Sz(n,e,t){return M(this,null,function*(){let r=q(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),s=i&&i.key;if(s){let o=new nt(H.comparator);o=o.insert(s,Nt.newNoDocument(s,ie.min()));let a=me().add(s),c=new Gl(ie.min(),new Map,new nt(pe),o,a);yield jP(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),DT(r)}else yield fc(r.localStore,e,!1).then(()=>mc(r,e,t)).catch(ys)})}function Az(n,e){return M(this,null,function*(){let t=q(n),r=e.batch.batchId;try{let i=yield iz(t.localStore,e);CT(t,r,null),TT(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield bi(t,i)}catch(i){yield ys(i)}})}function Rz(n,e,t){return M(this,null,function*(){let r=q(n);try{let i=yield function(o,a){let c=q(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let d;return c.mutationQueue.lookupMutationBatch(l,a).next(f=>(te(f!==null),d=f.keys(),c.mutationQueue.removeMutationBatch(l,f))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,d)).next(()=>c.localDocuments.getDocuments(l,d))})}(r.localStore,e);CT(r,e,t),TT(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield bi(r,i)}catch(i){yield ys(i)}})}function xz(n,e){return M(this,null,function*(){let t=q(n);vs(t.remoteStore)||U("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=q(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(r===-1)return void e.resolve();let i=t.ka.get(r)||[];i.push(e),t.ka.set(r,i)}catch(r){let i=Dc(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function TT(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function CT(n,e,t){let r=q(n),i=r.Ba[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function mc(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||BP(n,r)})}function BP(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(pc(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),DT(n))}function OI(n,e,t){for(let r of t)r instanceof yg?(n.La.addReference(r.key,e),Mz(n,r)):r instanceof _g?(U("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||BP(n,r.key)):W()}function Mz(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(U("SyncEngine","New document in limbo: "+t),n.xa.add(r),DT(n))}function DT(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new H(Pe.fromString(e)),r=n.qa.next();n.Na.set(r,new PI(t)),n.Oa=n.Oa.insert(t,r),Ng(n.remoteStore,new lc(hn(Ec(t.path)),r,"TargetPurposeLimboResolution",Fn.oe))}}function bi(n,e,t){return M(this,null,function*(){let r=q(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,c)=>{o.push(r.Ka(c,e,t).then(l=>{var d;if((l||t)&&r.isPrimaryClient){let f=l?!l.fromCache:(d=t?.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(l){i.push(l);let f=fI.Wi(c.targetId,l);s.push(f)}}))}),yield Promise.all(o),r.Ca.d_(i),yield function(c,l){return M(this,null,function*(){let d=q(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>x.forEach(l,g=>x.forEach(g.$i,y=>d.persistence.referenceDelegate.addReference(f,g.targetId,y)).next(()=>x.forEach(g.Ui,y=>d.persistence.referenceDelegate.removeReference(f,g.targetId,y)))))}catch(f){if(!_s(f))throw f;U("LocalStore","Failed to update sequence numbers: "+f)}for(let f of l){let g=f.targetId;if(!f.fromCache){let y=d.os.get(g),v=y.snapshotVersion,b=y.withLastLimboFreeSnapshotVersion(v);d.os=d.os.insert(g,b)}}})}(r.localStore,s))})}function Nz(n,e){return M(this,null,function*(){let t=q(n);if(!t.currentUser.isEqual(e)){U("SyncEngine","User change. New user:",e.toKey());let r=yield bP(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(c=>{c.reject(new L(P.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield bi(t,r.hs)}})}function Pz(n,e){let t=q(n),r=t.Na.get(e);if(r&&r.va)return me().add(r.key);{let i=me(),s=t.Ma.get(e);if(!s)return i;for(let o of s){let a=t.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}function kz(n,e){return M(this,null,function*(){let t=q(n),r=yield ag(t.localStore,e.query,!0),i=e.view.ba(r);return t.isPrimaryClient&&OI(t,e.targetId,i.wa),i})}function Oz(n,e){return M(this,null,function*(){let t=q(n);return xP(t.localStore,e).then(r=>bi(t,r))})}function Fz(n,e,t,r){return M(this,null,function*(){let i=q(n),s=yield function(a,c){let l=q(a),d=q(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",f=>d.Mn(f,c).next(g=>g?l.localDocuments.getDocuments(f,g):x.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?yield Tc(i.remoteStore):t==="acknowledged"||t==="rejected"?(CT(i,e,r||null),TT(i,e),function(a,c){q(q(a).mutationQueue).On(c)}(i.localStore,e)):W(),yield bi(i,s)):U("SyncEngine","Cannot apply mutation batch with id: "+e)})}function Lz(n,e){return M(this,null,function*(){let t=q(n);if(Pg(t),bT(t),e===!0&&t.Qa!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=yield hN(t,r.toArray());t.Qa=!0,yield DI(t.remoteStore,!0);for(let s of i)Ng(t.remoteStore,s)}else if(e===!1&&t.Qa!==!1){let r=[],i=Promise.resolve();t.Ma.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(mc(t,o),fc(t.localStore,o,!0))),pc(t.remoteStore,o)}),yield i,yield hN(t,r),function(o){let a=q(o);a.Na.forEach((c,l)=>{pc(a.remoteStore,l)}),a.La.pr(),a.Na=new Map,a.Oa=new nt(H.comparator)}(t),t.Qa=!1,yield DI(t.remoteStore,!1)}})}function hN(n,e,t){return M(this,null,function*(){let r=q(n),i=[],s=[];for(let o of e){let a,c=r.Ma.get(o);if(c&&c.length!==0){a=yield hc(r.localStore,hn(c[0]));for(let l of c){let d=r.Fa.get(l),f=yield kz(r,d);f.snapshot&&s.push(f.snapshot)}}else{let l=yield RP(r.localStore,o);a=yield hc(r.localStore,l),yield IT(r,$P(l),o,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(s),i})}function $P(n){return $N(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Vz(n){return function(t){return q(q(t).persistence).Qi()}(q(n).localStore)}function Uz(n,e,t,r){return M(this,null,function*(){let i=q(n);if(i.Qa)return void U("SyncEngine","Ignoring unexpected query state notification.");let s=i.Ma.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=yield xP(i.localStore,HN(s[0])),a=Gl.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Tt.EMPTY_BYTE_STRING);yield bi(i,o,a);break}case"rejected":yield fc(i.localStore,e,!0),mc(i,e,r);break;default:W()}})}function jz(n,e,t){return M(this,null,function*(){let r=Pg(n);if(r.Qa){for(let i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){U("SyncEngine","Adding an already active target "+i);continue}let s=yield RP(r.localStore,i),o=yield hc(r.localStore,s);yield IT(r,$P(s),o.targetId,!1,o.resumeToken),Ng(r.remoteStore,o)}for(let i of t)r.Ma.has(i)&&(yield fc(r.localStore,i,!1).then(()=>{pc(r.remoteStore,i),mc(r,i)}).catch(ys))}})}function Pg(n){let e=q(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=jP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Pz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Sz.bind(null,e),e.Ca.d_=wz.bind(null,e.eventManager),e.Ca.$a=Ez.bind(null,e.eventManager),e}function bT(n){let e=q(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Az.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Rz.bind(null,e),e}function Bz(n,e,t){let r=q(n);(function(s,o,a){return M(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(y,v){let b=q(y),C=It(v.createTime);return b.persistence.runTransaction("hasNewerBundle","readonly",V=>b.Gr.getBundleMetadata(V,v.id)).then(V=>!!V&&V.createTime.compareTo(C)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(y){return{taskState:"Success",documentsLoaded:y.totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(VP(c));let l=new MI(c,s.localStore,o.serializer),d=yield o.Ua();for(;d;){let g=yield l.la(d);g&&a._updateProgress(g),d=yield o.Ua()}let f=yield l.complete();return yield bi(s,f.Ia,void 0),yield function(y,v){let b=q(y);return b.persistence.runTransaction("Save bundle","readwrite",C=>b.Gr.saveBundleMetadata(C,v))}(s.localStore,c),a._completeWith(f.progress),Promise.resolve(f.Pa)}catch(c){return Zn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var td=class{constructor(){this.synchronizeTabs=!1}initialize(e){return M(this,null,function*(){this.serializer=ld(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return DP(this.persistence,new og,e.initialUser,this.serializer)}createPersistence(e){return new ig(sg.Zr,this.serializer)}createSharedClientState(e){return new lg}terminate(){return M(this,null,function*(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var wg=class n extends td{constructor(e,t,r){super(),this.Wa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return M(this,null,function*(){yield hy(n.prototype,this,"initialize").call(this,e),yield this.Wa.initialize(this,e),yield bT(this.Wa.syncEngine),yield Tc(this.Wa.remoteStore),yield this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return DP(this.persistence,new og,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new ZE(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new pE(t,this.persistence);return new fE(e.asyncQueue,r)}createPersistence(e){let t=gT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Yn.withCacheSize(this.cacheSizeBytes):Yn.DEFAULT;return new hI(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,NP(),Np(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new lg}},FI=class n extends wg{constructor(e,t){super(e,t,!1),this.Wa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){return M(this,null,function*(){yield hy(n.prototype,this,"initialize").call(this,e);let t=this.Wa.syncEngine;this.sharedClientState instanceof Fl&&(this.sharedClientState.syncEngine={no:Fz.bind(null,t),ro:Uz.bind(null,t),io:jz.bind(null,t),Qi:Vz.bind(null,t),eo:Oz.bind(null,t)},yield this.sharedClientState.start()),yield this.persistence.yi(r=>M(this,null,function*(){yield Lz(this.Wa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let t=NP();if(!Fl.D(t))throw new L(P.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=gT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Fl(t,e.asyncQueue,r,e.clientId,e.initialUser)}},nd=class{initialize(e,t){return M(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>dN(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Nz.bind(null,this.syncEngine),yield DI(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new AI}()}createDatastore(e){let t=ld(e.databaseInfo.databaseId),r=function(s){return new vI(s)}(e.databaseInfo);return function(s,o,a,c){return new II(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new CI(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>dN(this.syncEngine,t,0),function(){return dg.D()?new dg:new yI}())}createSyncEngine(e,t){return function(i,s,o,a,c,l,d){let f=new kI(i,s,o,a,c,l);return d&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return M(this,null,function*(){var e,t;yield function(i){return M(this,null,function*(){let s=q(i);U("RemoteStore","RemoteStore shutting down."),s.L_.add(5),yield Ic(s),s.k_.shutdown(),s.q_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()})}};function fN(n,e=10240){let t=0;return{read(){return M(this,null,function*(){if(t<n.byteLength){let i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})},cancel(){return M(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var yc=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ga(this.observer.next,e)}error(e){this.observer.error?this.Ga(this.observer.error,e):wt("Uncaught Error in snapshot listener:",e.toString())}za(){this.muted=!0}Ga(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var LI=class{constructor(e,t){this.ja=e,this.serializer=t,this.metadata=new Mt,this.buffer=new Uint8Array,this.Ha=function(){return new TextDecoder("utf-8")}(),this.Ja().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.aa)}`))},r=>this.metadata.reject(r))}close(){return this.ja.cancel()}getMetadata(){return M(this,null,function*(){return this.metadata.promise})}Ua(){return M(this,null,function*(){return yield this.getMetadata(),this.Ja()})}Ja(){return M(this,null,function*(){let e=yield this.Ya();if(e===null)return null;let t=this.Ha.decode(e),r=Number(t);isNaN(r)&&this.Za(`length string (${t}) is not valid number`);let i=yield this.Xa(r);return new xI(JSON.parse(i),e.length+r)})}eu(){return this.buffer.findIndex(e=>e===123)}Ya(){return M(this,null,function*(){for(;this.eu()<0&&!(yield this.tu()););if(this.buffer.length===0)return null;let e=this.eu();e<0&&this.Za("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t})}Xa(e){return M(this,null,function*(){for(;this.buffer.length<e;)(yield this.tu())&&this.Za("Reached the end of bundle when more is expected.");let t=this.Ha.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t})}Za(e){throw this.ja.cancel(),new Error(`Invalid bundle format: ${e}`)}tu(){return M(this,null,function*(){let e=yield this.ja.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done})}};var VI=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return M(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new L(P.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=yield function(i,s){return M(this,null,function*(){let o=q(i),a={documents:s.map(f=>Kl(o.serializer,f))},c=yield o.Lo("BatchGetDocuments",o.serializer.databaseId,Pe.emptyPath(),a,s.length),l=new Map;c.forEach(f=>{let g=G4(o.serializer,f);l.set(g.key.toString(),g)});let d=[];return s.forEach(f=>{let g=l.get(f.toString());te(!!g),d.push(g)}),d})}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t})}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new gs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return M(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=H.fromPath(r);this.mutations.push(new ql(i,this.precondition(i)))}),yield function(r,i){return M(this,null,function*(){let s=q(r),o={writes:i.map(a=>Ql(s.serializer,a))};yield s.Mo("Commit",s.serializer.databaseId,Pe.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw W();t=ie.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new L(P.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ie.min())?pt.exists(!1):pt.updateTime(t):pt.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ie.min()))throw new L(P.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return pt.updateTime(t)}return pt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var UI=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.nu=r.maxAttempts,this.t_=new Jl(this.asyncQueue,"transaction_retry")}ru(){this.nu-=1,this.iu()}iu(){this.t_.Go(()=>M(this,null,function*(){let e=new VI(this.datastore),t=this.su(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ou(i)}))}).catch(r=>{this.ou(r)})}))}su(e){try{let t=this.updateFunction(e);return!od(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ou(e){this.nu>0&&this._u(e)?(this.nu-=1,this.asyncQueue.enqueueAndForget(()=>(this.iu(),Promise.resolve()))):this.deferred.reject(e)}_u(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!rP(t)}return!1}};var jI=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=xt.UNAUTHENTICATED,this.clientId=Op.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>M(this,null,function*(){U("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(U("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new L(P.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Mt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>M(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Dc(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Pp(n,e){return M(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),U("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>M(this,null,function*(){r.isEqual(i)||(yield bP(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function BI(n,e){return M(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield ST(n);U("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>cN(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>cN(e.remoteStore,i)),n._onlineComponents=e})}function qP(n){return n.name==="FirebaseError"?n.code===P.FAILED_PRECONDITION||n.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function ST(n){return M(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){U("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Pp(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!qP(t))throw t;Zn("Error using user provided cache. Falling back to memory cache: "+t),yield Pp(n,new td)}}else U("FirestoreClient","Using default OfflineComponentProvider"),yield Pp(n,new td);return n._offlineComponents})}function kg(n){return M(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(U("FirestoreClient","Using user provided OnlineComponentProvider"),yield BI(n,n._uninitializedComponentsProvider._online)):(U("FirestoreClient","Using default OnlineComponentProvider"),yield BI(n,new nd))),n._onlineComponents})}function HP(n){return ST(n).then(e=>e.persistence)}function AT(n){return ST(n).then(e=>e.localStore)}function zP(n){return kg(n).then(e=>e.remoteStore)}function RT(n){return kg(n).then(e=>e.syncEngine)}function $z(n){return kg(n).then(e=>e.datastore)}function _c(n){return M(this,null,function*(){let e=yield kg(n),t=e.eventManager;return t.onListen=Iz.bind(null,e.syncEngine),t.onUnlisten=Cz.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Tz.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Dz.bind(null,e.syncEngine),t})}function qz(n){return n.asyncQueue.enqueue(()=>M(this,null,function*(){let e=yield HP(n),t=yield zP(n);return e.setNetworkEnabled(!0),function(i){let s=q(i);return s.L_.delete(0),dd(s)}(t)}))}function Hz(n){return n.asyncQueue.enqueue(()=>M(this,null,function*(){let e=yield HP(n),t=yield zP(n);return e.setNetworkEnabled(!1),function(i){return M(this,null,function*(){let s=q(i);s.L_.add(0),yield Ic(s),s.q_.set("Offline")})}(t)}))}function zz(n,e){let t=new Mt;return n.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return function(i,s,o){return M(this,null,function*(){try{let a=yield function(l,d){let f=q(l);return f.persistence.runTransaction("read document","readonly",g=>f.localDocuments.getDocument(g,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new L(P.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=Dc(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield AT(n),e,t)})),t.promise}function GP(n,e,t={}){let r=new Mt;return n.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return function(s,o,a,c,l){let d=new yc({next:g=>{o.enqueueAndForget(()=>wT(s,f));let y=g.docs.has(a);!y&&g.fromCache?l.reject(new L(P.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&c&&c.source==="server"?l.reject(new L(P.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(g)},error:g=>l.reject(g)}),f=new ed(Ec(a.path),d,{includeMetadataChanges:!0,_a:!0});return vT(s,f)}(yield _c(n),n.asyncQueue,e,t,r)})),r.promise}function Gz(n,e){let t=new Mt;return n.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return function(i,s,o){return M(this,null,function*(){try{let a=yield ag(i,s,!0),c=new vg(s,a.Ts),l=c.ma(a.documents),d=c.applyChanges(l,!1);o.resolve(d.snapshot)}catch(a){let c=Dc(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield AT(n),e,t)})),t.promise}function WP(n,e,t={}){let r=new Mt;return n.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return function(s,o,a,c,l){let d=new yc({next:g=>{o.enqueueAndForget(()=>wT(s,f)),g.fromCache&&c.source==="server"?l.reject(new L(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(g)},error:g=>l.reject(g)}),f=new ed(a,d,{includeMetadataChanges:!0,_a:!0});return vT(s,f)}(yield _c(n),n.asyncQueue,e,t,r)})),r.promise}function Wz(n,e){let t=new yc(e);return n.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return function(i,s){q(i).Y_.add(s),s.next()}(yield _c(n),t)})),()=>{t.za(),n.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return function(i,s){q(i).Y_.delete(s)}(yield _c(n),t)}))}}function Kz(n,e,t,r){let i=function(o,a){let c;return c=typeof o=="string"?sP().encode(o):o,function(d,f){return new LI(d,f)}(function(d,f){if(d instanceof Uint8Array)return fN(d,f);if(d instanceof ArrayBuffer)return fN(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(t,ld(e));n.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){Bz(yield RT(n),i,r)}))}function Qz(n,e){return n.asyncQueue.enqueue(()=>M(this,null,function*(){return function(r,i){let s=q(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Gr.getNamedQuery(o,i))}(yield AT(n),e)}))}function KP(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var pN=new Map;function xT(n,e,t){if(!t)throw new L(P.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function MT(n,e,t,r){if(e===!0&&r===!0)throw new L(P.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function gN(n){if(!H.isDocumentKey(n))throw new L(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function mN(n){if(H.isDocumentKey(n))throw new L(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Og(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":W()}function ke(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new L(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Og(n);throw new L(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function QP(n,e){if(e<=0)throw new L(P.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var Eg=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new L(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new L(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}MT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=KP((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new L(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new L(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new L(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Do=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Eg({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new L(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new L(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Eg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new rE;switch(r.type){case"firstParty":return new aE(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new L(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=pN.get(t);r&&(U("ComponentProvider","Removing Datastore"),pN.delete(t),r.terminate())}(this),Promise.resolve()}};function YP(n,e,t,r={}){var i;let s=(n=ke(n,Do))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Zn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=xt.MOCK_USER;else{a=ta(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let l=r.mockUserToken.sub||r.mockUserToken.user_id;if(!l)throw new L(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new xt(l)}n._authCredentials=new iE(new kp(a,c))}}var Yt=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Ye=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},qr=class n extends Yt{constructor(e,t,r){super(e,t,Ec(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Ye(this.firestore,null,new H(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function NT(n,e,...t){if(n=ce(n),xT("collection","path",e),n instanceof Do){let r=Pe.fromString(e,...t);return mN(r),new qr(n,null,r)}{if(!(n instanceof Ye||n instanceof qr))throw new L(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Pe.fromString(e,...t));return mN(r),new qr(n.firestore,null,r)}}function ZP(n,e){if(n=ke(n,Do),xT("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new L(P.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Yt(n,null,function(r){return new fr(Pe.emptyPath(),r)}(e))}function hd(n,e,...t){if(n=ce(n),arguments.length===1&&(e=Op.newId()),xT("doc","path",e),n instanceof Do){let r=Pe.fromString(e,...t);return gN(r),new Ye(n,null,new H(r))}{if(!(n instanceof Ye||n instanceof qr))throw new L(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(Pe.fromString(e,...t));return gN(r),new Ye(n.firestore,n instanceof qr?n.converter:null,new H(r))}}function PT(n,e){return n=ce(n),e=ce(e),(n instanceof Ye||n instanceof qr)&&(e instanceof Ye||e instanceof qr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function kT(n,e){return n=ce(n),e=ce(e),n instanceof Yt&&e instanceof Yt&&n.firestore===e.firestore&&cd(n._query,e._query)&&n.converter===e.converter}var $I=class{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new Jl(this,"async_queue_retry"),this.Eu=()=>{let t=Np();t&&U("AsyncQueue","Visibility state changed to "+t.visibilityState),this.t_.jo()};let e=Np();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.du(),this.Au(e)}enterRestrictedMode(e){if(!this.cu){this.cu=!0,this.Iu=e||!1;let t=Np();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Eu)}}enqueue(e){if(this.du(),this.cu)return new Promise(()=>{});let t=new Mt;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.uu.push(e),this.Ru()))}Ru(){return M(this,null,function*(){if(this.uu.length!==0){try{yield this.uu[0](),this.uu.shift(),this.t_.reset()}catch(e){if(!_s(e))throw e;U("AsyncQueue","Operation failed with retryable error: "+e)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}})}Au(e){let t=this.au.then(()=>(this.Pu=!0,e().catch(r=>{this.hu=r,this.Pu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw wt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Pu=!1,r))));return this.au=t,t}enqueueAfterDelay(e,t,r){this.du(),this.Tu.indexOf(e)>-1&&(t=0);let i=bI.createAndSchedule(this,e,t,r,s=>this.Vu(s));return this.lu.push(i),i}du(){this.hu&&W()}verifyOperationInProgress(){}mu(){return M(this,null,function*(){let e;do e=this.au,yield e;while(e!==this.au)})}fu(e){for(let t of this.lu)if(t.timerId===e)return!0;return!1}gu(e){return this.mu().then(()=>{this.lu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.lu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.mu()})}pu(e){this.Tu.push(e)}Vu(e){let t=this.lu.indexOf(e);this.lu.splice(t,1)}};function qI(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var HI=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new Mt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var XP=-1,ot=class extends Do{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new $I}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||JP(this),this._firestoreClient.terminate()}};function Ft(n){return n._firestoreClient||JP(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function JP(n){var e,t,r;let i=n._freezeSettings(),s=function(a,c,l,d){return new gE(a,c,l,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,KP(d.experimentalLongPollingOptions),d.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new jI(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function ek(n,e){uk(n=ke(n,ot));let t=Ft(n);if(t._uninitializedComponentsProvider)throw new L(P.FAILED_PRECONDITION,"SDK cache is already specified.");Zn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=n._freezeSettings(),i=new nd;return nk(t,i,new wg(i,r.cacheSizeBytes,e?.forceOwnership))}function tk(n){uk(n=ke(n,ot));let e=Ft(n);if(e._uninitializedComponentsProvider)throw new L(P.FAILED_PRECONDITION,"SDK cache is already specified.");Zn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),r=new nd;return nk(e,r,new FI(r,t.cacheSizeBytes))}function nk(n,e,t){let r=new Mt;return n.asyncQueue.enqueue(()=>M(this,null,function*(){try{yield Pp(n,t),yield BI(n,e),r.resolve()}catch(i){let s=i;if(!qP(s))throw s;Zn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function rk(n){if(n._initialized&&!n._terminated)throw new L(P.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new Mt;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>M(this,null,function*(){try{yield function(r){return M(this,null,function*(){if(!cs.D())return Promise.resolve();let i=r+"main";yield cs.delete(i)})}(gT(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function ik(n){return function(t){let r=new Mt;return t.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return xz(yield RT(t),r)})),r.promise}(Ft(n=ke(n,ot)))}function sk(n){return qz(Ft(n=ke(n,ot)))}function ok(n){return Hz(Ft(n=ke(n,ot)))}function ak(n,e){let t=Ft(n=ke(n,ot)),r=new HI;return Kz(t,n._databaseId,e,r),r}function ck(n,e){return Qz(Ft(n=ke(n,ot)),e).then(t=>t?new Yt(n,null,t.query):null)}function uk(n){if(n._initialized||n._terminated)throw new L(P.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Wr=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Tt.fromBase64String(e))}catch(t){throw new L(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Tt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var gr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new L(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Et(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Ci=class{constructor(e){this._methodName=e}};var bo=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return pe(this._lat,e._lat)||pe(this._long,e._long)}};var rd=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var Yz=/^__.*__$/,zI=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new pr(e,this.data,this.fieldMask,t,this.fieldTransforms):new ps(e,this.data,t,this.fieldTransforms)}},Ig=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new pr(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function lk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W()}}var Tg=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.yu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.vu(e),i}Cu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.yu(),i}Fu(e){return this.Su({path:void 0,Du:!0})}Mu(e){return Cg(e,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}yu(){if(this.path)for(let e=0;e<this.path.length;e++)this.vu(this.path.get(e))}vu(e){if(e.length===0)throw this.Mu("Document fields must not be empty");if(lk(this.wu)&&Yz.test(e))throw this.Mu('Document fields cannot begin and end with "__"')}},GI=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||ld(e)}Nu(e,t,r,i=!1){return new Tg({wu:e,methodName:t,Ou:r,path:Et.emptyPath(),Du:!1,xu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function xo(n){let e=n._freezeSettings(),t=ld(n._databaseId);return new GI(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Fg(n,e,t,r,i,s={}){let o=n.Nu(s.merge||s.mergeFields?2:0,e,t,i);LT("Data must be an object, but it was:",o,r);let a=fk(r,o),c,l;if(s.merge)c=new Ln(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let f of s.mergeFields){let g=ZI(e,f,t);if(!o.contains(g))throw new L(P.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);gk(d,g)||d.push(g)}c=new Ln(d),l=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,l=o.fieldTransforms;return new zI(new rn(a),c,l)}var id=class n extends Ci{_toFieldTransform(e){if(e.wu!==2)throw e.wu===1?e.Mu(`${this._methodName}() can only appear at the top level of your update data`):e.Mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function dk(n,e,t){return new Tg({wu:3,Ou:e.settings.Ou,methodName:n._methodName,Du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var WI=class n extends Ci{_toFieldTransform(e){return new Io(e.path,new hs)}isEqual(e){return e instanceof n}},KI=class n extends Ci{constructor(e,t){super(e),this.Lu=t}_toFieldTransform(e){let t=dk(this,e,!0),r=this.Lu.map(s=>Mo(s,t)),i=new Ii(r);return new Io(e.path,i)}isEqual(e){return e instanceof n&&gy(this.Lu,e.Lu)}},QI=class n extends Ci{constructor(e,t){super(e),this.Lu=t}_toFieldTransform(e){let t=dk(this,e,!0),r=this.Lu.map(s=>Mo(s,t)),i=new Ti(r);return new Io(e.path,i)}isEqual(e){return e instanceof n&&gy(this.Lu,e.Lu)}},YI=class n extends Ci{constructor(e,t){super(e),this.Bu=t}_toFieldTransform(e){let t=new fs(e.serializer,YN(e.serializer,this.Bu));return new Io(e.path,t)}isEqual(e){return e instanceof n&&this.Bu===e.Bu}};function OT(n,e,t,r){let i=n.Nu(1,e,t);LT("Data must be an object, but it was:",i,r);let s=[],o=rn.empty();Ro(r,(c,l)=>{let d=VT(e,c,t);l=ce(l);let f=i.Cu(d);if(l instanceof id)s.push(d);else{let g=Mo(l,f);g!=null&&(s.push(d),o.set(d,g))}});let a=new Ln(s);return new Ig(o,a,i.fieldTransforms)}function FT(n,e,t,r,i,s){let o=n.Nu(1,e,t),a=[ZI(e,r,t)],c=[i];if(s.length%2!=0)throw new L(P.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)a.push(ZI(e,s[g])),c.push(s[g+1]);let l=[],d=rn.empty();for(let g=a.length-1;g>=0;--g)if(!gk(l,a[g])){let y=a[g],v=c[g];v=ce(v);let b=o.Cu(y);if(v instanceof id)l.push(y);else{let C=Mo(v,b);C!=null&&(l.push(y),d.set(y,C))}}let f=new Ln(l);return new Ig(d,f,o.fieldTransforms)}function hk(n,e,t,r=!1){return Mo(t,n.Nu(r?4:3,e))}function Mo(n,e){if(pk(n=ce(n)))return LT("Unsupported field value:",e,n),fk(n,e);if(n instanceof Ci)return function(r,i){if(!lk(i.wu))throw i.Mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Mu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Du&&e.wu!==4)throw e.Mu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=Mo(a,i.Fu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=ce(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return YN(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=ut.fromDate(r);return{timestampValue:uc(i.serializer,s)}}if(r instanceof ut){let s=new ut(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:uc(i.serializer,s)}}if(r instanceof bo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Wr)return{bytesValue:oP(i.serializer,r._byteString)};if(r instanceof Ye){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:hT(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof rd)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Mu("VectorValues must only contain numeric values.");return dT(a.serializer,c)})}}}}}}(r,i);throw i.Mu(`Unsupported field value: ${Og(r)}`)}(n,e)}function fk(n,e){let t={};return NN(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ro(n,(r,i)=>{let s=Mo(i,e.bu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function pk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ut||n instanceof bo||n instanceof Wr||n instanceof Ye||n instanceof Ci||n instanceof rd)}function LT(n,e,t){if(!pk(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Og(t);throw r==="an object"?e.Mu(n+" a custom object"):e.Mu(n+" "+r)}}function ZI(n,e,t){if((e=ce(e))instanceof gr)return e._internalPath;if(typeof e=="string")return VT(n,e);throw Cg("Field path arguments must be of type string or ",n,!1,void 0,t)}var Zz=new RegExp("[~\\*/\\[\\]]");function VT(n,e,t){if(e.search(Zz)>=0)throw Cg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new gr(...e.split("."))._internalPath}catch{throw Cg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Cg(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new L(P.INVALID_ARGUMENT,a+n+c)}function gk(n,e){return n.some(t=>t.isEqual(e))}var So=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Ye(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new XI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Lg("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},XI=class extends So{data(){return super.data()}};function Lg(n,e){return typeof e=="string"?VT(n,e):e instanceof gr?e._internalPath:e._delegate._internalPath}function mk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new L(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var sd=class{},Ao=class extends sd{};function Si(n,e,...t){let r=[];e instanceof sd&&r.push(e),r=r.concat(t),function(s){let o=s.filter(c=>c instanceof JI).length,a=s.filter(c=>c instanceof Dg).length;if(o>1||o>0&&a>0)throw new L(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Dg=class n extends Ao{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return bk(e._query,t),new Yt(e.firestore,e.converter,AE(e._query,t))}_parse(e){let t=xo(e.firestore);return function(s,o,a,c,l,d,f){let g;if(l.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new L(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){_N(f,d);let y=[];for(let v of f)y.push(yN(c,s,v));g={arrayValue:{values:y}}}else g=yN(c,s,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||_N(f,d),g=hk(a,o,f,d==="in"||d==="not-in");return Re.create(l,d,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function yk(n,e,t){let r=e,i=Lg("where",n);return Dg._create(i,r,t)}var JI=class n extends sd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Be.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)bk(o,c),o=AE(o,c)}(e._query,t),new Yt(e.firestore,e.converter,AE(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var eT=class n extends Ao{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,o){if(i.startAt!==null)throw new L(P.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new L(P.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new wo(s,o)}(e._query,this._field,this._direction);return new Yt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new fr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function _k(n,e="asc"){let t=e,r=Lg("orderBy",n);return eT._create(r,t)}var bg=class n extends Ao{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new Yt(e.firestore,e.converter,zp(e._query,this._limit,this._limitType))}};function vk(n){return QP("limit",n),bg._create("limit",n,"F")}function wk(n){return QP("limitToLast",n),bg._create("limitToLast",n,"L")}var Sg=class n extends Ao{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=Dk(e,this.type,this._docOrFields,this._inclusive);return new Yt(e.firestore,e.converter,function(i,s){return new fr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}};function Ek(...n){return Sg._create("startAt",n,!0)}function Ik(...n){return Sg._create("startAfter",n,!1)}var Ag=class n extends Ao{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=Dk(e,this.type,this._docOrFields,this._inclusive);return new Yt(e.firestore,e.converter,function(i,s){return new fr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}};function Tk(...n){return Ag._create("endBefore",n,!1)}function Ck(...n){return Ag._create("endAt",n,!0)}function Dk(n,e,t,r){if(t[0]=ce(t[0]),t[0]instanceof So)return function(s,o,a,c,l){if(!c)throw new L(P.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let f of tc(s))if(f.field.isKeyField())d.push(vo(o,c.key));else{let g=c.data.field(f.field);if(xg(g))throw new L(P.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){let y=f.field.canonicalString();throw new L(P.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}d.push(g)}return new zr(d,l)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=xo(n.firestore);return function(o,a,c,l,d,f){let g=o.explicitOrderBy;if(d.length>g.length)throw new L(P.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let y=[];for(let v=0;v<d.length;v++){let b=d[v];if(g[v].field.isKeyField()){if(typeof b!="string")throw new L(P.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof b}`);if(!uT(o)&&b.indexOf("/")!==-1)throw new L(P.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${b}' contains a slash.`);let C=o.path.child(Pe.fromString(b));if(!H.isDocumentKey(C))throw new L(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${C}' is not because it contains an odd number of segments.`);let V=new H(C);y.push(vo(a,V))}else{let C=hk(c,l,b);y.push(C)}}return new zr(y,f)}(n._query,n.firestore._databaseId,i,e,t,r)}}function yN(n,e,t){if(typeof(t=ce(t))=="string"){if(t==="")throw new L(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!uT(e)&&t.indexOf("/")!==-1)throw new L(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(Pe.fromString(t));if(!H.isDocumentKey(r))throw new L(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return vo(n,new H(r))}if(t instanceof Ye)return vo(n,t._key);throw new L(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Og(t)}.`)}function _N(n,e){if(!Array.isArray(n)||n.length===0)throw new L(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bk(n,e){let t=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new L(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new L(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var vc=class{convertValue(e,t="none"){switch(_o(e)){case 0:return null;case 1:return e.booleanValue;case 2:return st(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(us(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw W()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Ro(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>st(o.doubleValue));return new rd(s)}convertGeoPoint(e){return new bo(st(e.latitude),st(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=aT(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(jl(e));default:return null}}convertTimestamp(e){let t=Ei(e);return new ut(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=Pe.fromString(e);te(yP(r));let i=new ls(r.get(1),r.get(3)),s=new H(r.popFirst(5));return i.isEqual(t)||wt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function Vg(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var tT=class extends vc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ye(this.firestore,null,t)}};var wi=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Jn=class extends So{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new os(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Lg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},os=class extends Jn{data(e={}){return super.data(e)}},mr=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new wi(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new os(this._firestore,this._userDataWriter,r.key,r,new wi(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new os(i._firestore,i._userDataWriter,a.doc.key,a.doc,new wi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new os(i._firestore,i._userDataWriter,a.doc.key,a.doc,new wi(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),l=-1,d=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:Xz(a.type),doc:c,oldIndex:l,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function Xz(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W()}}function UT(n,e){return n instanceof Jn&&e instanceof Jn?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof mr&&e instanceof mr&&n._firestore===e._firestore&&kT(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function Sk(n){n=ke(n,Ye);let e=ke(n.firestore,ot);return GP(Ft(e),n._key).then(t=>qT(e,n,t))}var Di=class extends vc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wr(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ye(this.firestore,null,t)}};function Ak(n){n=ke(n,Ye);let e=ke(n.firestore,ot),t=Ft(e),r=new Di(e);return zz(t,n._key).then(i=>new Jn(e,r,n._key,i,new wi(i!==null&&i.hasLocalMutations,!0),n.converter))}function Rk(n){n=ke(n,Ye);let e=ke(n.firestore,ot);return GP(Ft(e),n._key,{source:"server"}).then(t=>qT(e,n,t))}function xk(n){n=ke(n,Yt);let e=ke(n.firestore,ot),t=Ft(e),r=new Di(e);return mk(n._query),WP(t,n._query).then(i=>new mr(e,r,n,i))}function Mk(n){n=ke(n,Yt);let e=ke(n.firestore,ot),t=Ft(e),r=new Di(e);return Gz(t,n._query).then(i=>new mr(e,r,n,i))}function Nk(n){n=ke(n,Yt);let e=ke(n.firestore,ot),t=Ft(e),r=new Di(e);return WP(t,n._query,{source:"server"}).then(i=>new mr(e,r,n,i))}function jT(n,e,t){n=ke(n,Ye);let r=ke(n.firestore,ot),i=Vg(n.converter,e,t);return bc(r,[Fg(xo(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,pt.none())])}function BT(n,e,t,...r){n=ke(n,Ye);let i=ke(n.firestore,ot),s=xo(i),o;return o=typeof(e=ce(e))=="string"||e instanceof gr?FT(s,"updateDoc",n._key,e,t,r):OT(s,"updateDoc",n._key,e),bc(i,[o.toMutation(n._key,pt.exists(!0))])}function Pk(n){return bc(ke(n.firestore,ot),[new gs(n._key,pt.none())])}function kk(n,e){let t=ke(n.firestore,ot),r=hd(n),i=Vg(n.converter,e);return bc(t,[Fg(xo(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,pt.exists(!1))]).then(()=>r)}function $T(n,...e){var t,r,i;n=ce(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||qI(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(qI(e[o])){let f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(i=f.complete)===null||i===void 0?void 0:i.bind(f)}let c,l,d;if(n instanceof Ye)l=ke(n.firestore,ot),d=Ec(n._key.path),c={next:f=>{e[o]&&e[o](qT(l,n,f))},error:e[o+1],complete:e[o+2]};else{let f=ke(n,Yt);l=ke(f.firestore,ot),d=f._query;let g=new Di(l);c={next:y=>{e[o]&&e[o](new mr(l,g,f,y))},error:e[o+1],complete:e[o+2]},mk(n._query)}return function(g,y,v,b){let C=new yc(b),V=new ed(y,C,v);return g.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return vT(yield _c(g),V)})),()=>{C.za(),g.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return wT(yield _c(g),V)}))}}(Ft(l),d,a,c)}function Ok(n,e){return Wz(Ft(n=ke(n,ot)),qI(e)?e:{next:e})}function bc(n,e){return function(r,i){let s=new Mt;return r.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){return bz(yield RT(r),i,s)})),s.promise}(Ft(n),e)}function qT(n,e,t){let r=t.docs.get(e._key),i=new Di(n);return new Jn(n,i,e._key,r,new wi(t.hasPendingWrites,t.fromCache),e.converter)}var Jz={maxAttempts:5};var Rg=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=xo(e)}set(e,t,r){this._verifyNotCommitted();let i=is(e,this._firestore),s=Vg(i.converter,t,r),o=Fg(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,pt.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=is(e,this._firestore),o;return o=typeof(t=ce(t))=="string"||t instanceof gr?FT(this._dataReader,"WriteBatch.update",s._key,t,r,i):OT(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,pt.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=is(e,this._firestore);return this._mutations=this._mutations.concat(new gs(t._key,pt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new L(P.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function is(n,e){if((n=ce(n)).firestore!==e)throw new L(P.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var nT=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=xo(t)}get(t){let r=is(t,this._firestore),i=new tT(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return W();let o=s[0];if(o.isFoundDocument())return new So(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new So(this._firestore,i,r._key,null,r.converter);throw W()})}set(t,r,i){let s=is(t,this._firestore),o=Vg(s.converter,r,i),a=Fg(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){let o=is(t,this._firestore),a;return a=typeof(r=ce(r))=="string"||r instanceof gr?FT(this._dataReader,"Transaction.update",o._key,r,i,s):OT(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){let r=is(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=is(e,this._firestore),r=new Di(this._firestore);return super.get(e).then(i=>new Jn(this._firestore,r,t._key,i._document,new wi(!1,!1),t.converter))}};function Fk(n,e,t){n=ke(n,ot);let r=Object.assign(Object.assign({},Jz),t);return function(s){if(s.maxAttempts<1)throw new L(P.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new Mt;return s.asyncQueue.enqueueAndForget(()=>M(this,null,function*(){let l=yield $z(s);new UI(s.asyncQueue,l,a,o,c).ru()})),c.promise}(Ft(n),i=>e(new nT(n,i)),r)}function Lk(){return new id("deleteField")}function Vk(){return new WI("serverTimestamp")}function Uk(...n){return new KI("arrayUnion",n)}function jk(...n){return new QI("arrayRemove",n)}function Bk(n){return new YI("increment",n)}(function(e,t=!0){(function(i){wc=i})(na),si(new Gt("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new ot(new sE(r.getProvider("auth-internal")),new uE(r.getProvider("app-check-internal")),function(l,d){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new L(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ls(l.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),En(yM,"4.7.1",e),En(yM,"4.7.1","esm2017")})();var eG="@firebase/firestore-compat",tG="0.3.36";function QT(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new L("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function $k(){if(typeof Uint8Array>"u")throw new L("unimplemented","Uint8Arrays are not available in this environment.")}function qk(){if(!PN())throw new L("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Ug=class n{constructor(e){this._delegate=e}static fromBase64String(e){return qk(),new n(Wr.fromBase64String(e))}static fromUint8Array(e){return $k(),new n(Wr.fromUint8Array(e))}toBase64(){return qk(),this._delegate.toBase64()}toUint8Array(){return $k(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function HT(n){return nG(n,["next","error","complete"])}function nG(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var zT=class{enableIndexedDbPersistence(e,t){return ek(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return tk(e._delegate)}clearIndexedDbPersistence(e){return rk(e._delegate)}},jg=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ls||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Zn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){YP(this._delegate,e,t,r)}enableNetwork(){return sk(this._delegate)}disableNetwork(){return ok(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,MT("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return ik(this._delegate)}onSnapshotsInSync(e){return Ok(this._delegate,e)}get app(){if(!this._appCompat)throw new L("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Rc(this,NT(this._delegate,e))}catch(t){throw fn(t,"collection()","Firestore.collection()")}}doc(e){try{return new Kr(this,hd(this._delegate,e))}catch(t){throw fn(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Oo(this,ZP(this._delegate,e))}catch(t){throw fn(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Fk(this._delegate,t=>e(new Bg(this,t)))}batch(){return Ft(this._delegate),new $g(new Rg(this._delegate,e=>bc(this._delegate,e)))}loadBundle(e){return ak(this._delegate,e)}namedQuery(e){return ck(this._delegate,e).then(t=>t?new Oo(this,t):null)}},Sc=class extends vc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ug(new Wr(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return Kr.forKey(t,this.firestore,null)}};function rG(n){wN(n)}var Bg=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Sc(e)}get(e){let t=No(e);return this._delegate.get(t).then(r=>new Po(this._firestore,new Jn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=No(e);return r?(QT("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=No(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=No(e);return this._delegate.delete(t),this}},$g=class{constructor(e){this._delegate=e}set(e,t,r){let i=No(e);return r?(QT("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=No(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=No(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},Ac=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new os(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new ko(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new Sc(e),t),i.set(t,s)),s}};Ac.INSTANCES=new WeakMap;var Kr=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Sc(e)}static forPath(e,t,r){if(e.length%2!==0)throw new L("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new Ye(t._delegate,r,new H(e)))}static forKey(e,t,r){return new n(t,new Ye(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Rc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Rc(this.firestore,NT(this._delegate,e))}catch(t){throw fn(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ce(e),e instanceof Ye?PT(this._delegate,e):!1}set(e,t){t=QT("DocumentReference.set",t);try{return t?jT(this._delegate,e,t):jT(this._delegate,e)}catch(r){throw fn(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?BT(this._delegate,e):BT(this._delegate,e,t,...r)}catch(i){throw fn(i,"updateDoc()","DocumentReference.update()")}}delete(){return Pk(this._delegate)}onSnapshot(...e){let t=Hk(e),r=zk(e,i=>new Po(this.firestore,new Jn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return $T(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=Ak(this._delegate):e?.source==="server"?t=Rk(this._delegate):t=Sk(this._delegate),t.then(r=>new Po(this.firestore,new Jn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ac.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function fn(n,e,t){return n.message=n.message.replace(e,t),n}function Hk(n){for(let e of n)if(typeof e=="object"&&!HT(e))return e;return{}}function zk(n,e){var t,r;let i;return HT(n[0])?i=n[0]:HT(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Po=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Kr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return UT(this._delegate,e._delegate)}},ko=class extends Po{data(e){let t=this._delegate.data(e);return this._delegate._converter||EN(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},Oo=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Sc(e)}where(e,t,r){try{return new n(this.firestore,Si(this._delegate,yk(e,t,r)))}catch(i){throw fn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Si(this._delegate,_k(e,t)))}catch(r){throw fn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Si(this._delegate,vk(e)))}catch(t){throw fn(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Si(this._delegate,wk(e)))}catch(t){throw fn(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Si(this._delegate,Ek(...e)))}catch(t){throw fn(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Si(this._delegate,Ik(...e)))}catch(t){throw fn(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Si(this._delegate,Tk(...e)))}catch(t){throw fn(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Si(this._delegate,Ck(...e)))}catch(t){throw fn(t,"endAt()","Query.endAt()")}}isEqual(e){return kT(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=Mk(this._delegate):e?.source==="server"?t=Nk(this._delegate):t=xk(this._delegate),t.then(r=>new fd(this.firestore,new mr(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=Hk(e),r=zk(e,i=>new fd(this.firestore,new mr(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return $T(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ac.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},GT=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new ko(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},fd=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Oo(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new ko(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new GT(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new ko(this._firestore,r))})}isEqual(e){return UT(this._delegate,e._delegate)}},Rc=class n extends Oo{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Kr(this.firestore,e):null}doc(e){try{return e===void 0?new Kr(this.firestore,hd(this._delegate)):new Kr(this.firestore,hd(this._delegate,e))}catch(t){throw fn(t,"doc()","CollectionReference.doc()")}}add(e){return kk(this._delegate,e).then(t=>new Kr(this.firestore,t))}isEqual(e){return PT(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(Ac.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function No(n){return ke(n,Ye)}var WT=class n{constructor(...e){this._delegate=new gr(...e)}static documentId(){return new n(Et.keyField().canonicalString())}isEqual(e){return e=ce(e),e instanceof gr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var KT=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=Vk();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=Lk();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=Uk(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=jk(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=Bk(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var iG={Firestore:jg,GeoPoint:bo,Timestamp:ut,Blob:Ug,Transaction:Bg,WriteBatch:$g,DocumentReference:Kr,DocumentSnapshot:Po,Query:Oo,QueryDocumentSnapshot:ko,QuerySnapshot:fd,CollectionReference:Rc,FieldPath:WT,FieldValue:KT,setLogLevel:rG,CACHE_SIZE_UNLIMITED:XP};function sG(n,e){n.INTERNAL.registerComponent(new Gt("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},iG)))}function oG(n){sG(n,(e,t)=>new jg(e,t,new zT)),n.registerVersion(eG,tG)}oG(ft);function aG(n,e=ai){return new ve(t=>{let r;return e!=null?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}function Gk(n,e){return aG(n,e)}function cG(n,e){return Gk(n,e).pipe(qs(void 0),bu(),ee(t=>{let[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function XT(n,e){return Gk(n,e).pipe(ee(t=>({payload:t,type:"query"})))}var qg=class{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){let r=this.ref.collection(e),{ref:i,query:s}=Zk(r,t);return new zg(i,s,this.afs)}snapshotChanges(){return cG(this.ref,this.afs.schedulers.outsideAngular).pipe(it)}valueChanges(e={}){return this.snapshotChanges().pipe(ee(({payload:t})=>e.idField?Je(Q({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return Ae(this.ref.get(e)).pipe(it)}};function Hg(n,e){return XT(n,e).pipe(qs(void 0),bu(),ee(t=>{let[r,i]=t,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,c)=>{let l=s.find(f=>f.doc.ref.isEqual(a.ref)),d=r?.payload.docs.find(f=>f.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&d&&JSON.stringify(d.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),o}))}function Wk(n,e,t){return Hg(n,t).pipe(Tr((r,i)=>uG(r,i.map(s=>s.payload),e),[]),Cu(),ee(r=>r.map(i=>({type:i.type,payload:i}))))}function uG(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=lG(n,r))}),n}function YT(n,e,t,...r){let i=n.slice();return i.splice(e,t,...r),i}function lG(n,e){switch(e.type){case"added":if(!(n[e.newIndex]&&n[e.newIndex].doc.ref.isEqual(e.doc.ref)))return YT(n,e.newIndex,0,e);break;case"modified":if(n[e.oldIndex]==null||n[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}else return YT(n,e.newIndex,1,e);break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return YT(n,e.oldIndex,1);break}return n}function Kk(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var zg=class{ref;query;afs;constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=Hg(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(ee(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(qs(void 0),bu(),Qt(([r,i])=>i.length>0||!r),ee(([,r])=>r),it)}auditTrail(e){return this.stateChanges(e).pipe(Tr((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=Kk(e);return Wk(this.query,t,this.afs.schedulers.outsideAngular).pipe(it)}valueChanges(e={}){return XT(this.query,this.afs.schedulers.outsideAngular).pipe(ee(t=>t.payload.docs.map(r=>e.idField?Je(Q({},r.data()),{[e.idField]:r.id}):r.data())),it)}get(e){return Ae(this.query.get(e)).pipe(it)}add(e){return this.ref.add(e)}doc(e){return new qg(this.ref.doc(e),this.afs)}},ZT=class{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return!e||e.length===0?Hg(this.query,this.afs.schedulers.outsideAngular).pipe(it):Hg(this.query,this.afs.schedulers.outsideAngular).pipe(ee(t=>t.filter(r=>e.indexOf(r.type)>-1)),Qt(t=>t.length>0),it)}auditTrail(e){return this.stateChanges(e).pipe(Tr((t,r)=>[...t,...r],[]))}snapshotChanges(e){let t=Kk(e);return Wk(this.query,t,this.afs.schedulers.outsideAngular).pipe(it)}valueChanges(e={}){return XT(this.query,this.afs.schedulers.outsideAngular).pipe(ee(r=>r.payload.docs.map(i=>e.idField?Q({[e.idField]:i.id},i.data()):i.data())),it)}get(e){return Ae(this.query.get(e)).pipe(it)}},Qk=new K("angularfire2.enableFirestorePersistence"),Yk=new K("angularfire2.firestore.persistenceSettings"),dG=new K("angularfire2.firestore.settings"),hG=new K("angularfire2.firestore.use-emulator");function Zk(n,e=t=>t){return{query:e(n),ref:n}}var JT=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,r,i,s,o,a,c,l,d,f,g,y,v,b,C,V,B){this.schedulers=c;let O=yi(t,a,r),z=d;f&&Cl(O,a,g,v,b,C,y,V),[this.firestore,this.persistenceEnabled$]=Ji(`${O.name}.firestore`,"AngularFirestore",O.name,()=>{let re=a.runOutsideAngular(()=>O.firestore());if(s&&re.settings(s),z&&re.useEmulator(...z),i&&!so(o)){let Z=()=>{try{return Ae(re.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(I){return typeof console<"u"&&console.warn(I),ne(!1)}};return[re,a.runOutsideAngular(Z)]}else return[re,ne(!1)]},[s,z,i])}collection(t,r){let i;typeof t=="string"?i=this.firestore.collection(t):i=t;let{ref:s,query:o}=Zk(i,r),a=this.schedulers.ngZone.run(()=>s);return new zg(a,o,this)}collectionGroup(t,r){let i=r||(o=>o),s=this.firestore.collectionGroup(t);return new ZT(i(s),this)}doc(t){let r;typeof t=="string"?r=this.firestore.doc(t):r=t;let i=this.schedulers.ngZone.run(()=>r);return new qg(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(F(Lr),F(Vr,8),F(Qk,8),F(dG,8),F(jt),F(De),F(Zi),F(Yk,8),F(hG,8),F(Ep,8),F(_l,8),F(vl,8),F(wl,8),F(El,8),F(Il,8),F(Tl,8),F(dr,8))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),Xk=(()=>{class n{constructor(){ft.registerVersion("angularfire",Fr.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:Qk,useValue:!0},{provide:Yk,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=vt({type:n});static \u0275inj=_t({providers:[JT]})}return n})();var pG=n=>({color:n});function gG(n,e){if(n&1&&(rt(0,"li",11)(1,"span",12),kt(2),tt(),rt(3,"span",13),kt(4),tt(),rt(5,"span",14),kt(6),tt()()),n&2){let t=e.$implicit,r=e.index;ln(2),Pr(r+1),ln(2),Pr(t.score.player),ln(2),Pr(t.score.score)}}function mG(n,e){if(n&1&&(rt(0,"ul",9),to(1,gG,7,3,"li",10),tt()),n&2){let t=e.ngIf;ln(),Gi("ngForOf",t.slice(0,3))}}function yG(n,e){if(n&1&&(rt(0,"li",16)(1,"span",12),kt(2),tt(),rt(3,"span",13),kt(4),tt(),rt(5,"span",14),kt(6),tt()()),n&2){let t=e.$implicit,r=e.index,i=yv(2);Gi("ngStyle",CR(4,pG,i.getBackgroundColor(r))),ln(2),Pr(r+4),ln(2),Pr(t.score.player),ln(2),Pr(t.score.score)}}function _G(n,e){if(n&1&&(rt(0,"ul",9),to(1,yG,7,6,"li",15),tt()),n&2){let t=e.ngIf;ln(),Gi("ngForOf",t.slice(3))}}function vG(n,e){n&1&&(rt(0,"p"),kt(1,"Loading..."),tt())}function wG(n,e){if(n&1&&(rt(0,"div",17)(1,"div",18)(2,"h3"),kt(3,"New Score!"),tt(),rt(4,"div",12),kt(5),tt(),rt(6,"div",19)(7,"span",20),kt(8,"Player:"),tt(),rt(9,"span",21),kt(10),tt()(),rt(11,"div",19)(12,"span",20),kt(13,"Score:"),tt(),rt(14,"span",21),kt(15),tt()()()()),n&2){let t=yv();ln(5),Bf("Rank: ",t.alertData.rank,""),ln(5),Pr(t.alertData.player),ln(5),Pr(t.alertData.score)}}var Jk=(()=>{let e=class e{constructor(r){this.firestore=r,this.previousScores=[],this.colors=["#7f00ff","#0000ff","#007fff","#00ffff","#00ff7f","#00ff00","#7fff00","#ffff00","#ff7f00","#ff0000"],this.newScoreAlert=null,this.alertData=null,this.scores$=this.firestore.collection("scoreboard",i=>i.orderBy("score","desc")).snapshotChanges().pipe(ee(i=>i.map(s=>{let o=s.payload.doc.data();return{id:s.payload.doc.id,score:o}})))}ngOnInit(){this.scores$.subscribe(r=>{if(this.previousScores.length===0){this.previousScores=r;return}let i=r.filter(s=>!this.previousScores.some(o=>o.id===s.id));if(i.length>0){let s=[...r];s.sort((o,a)=>a.score.score-o.score.score),i.forEach(o=>{let a=s.findIndex(c=>c.id===o.id)+1;this.showAlert(o.score,a),a<=3&&this.triggerConfetti()})}this.previousScores=r},r=>{console.error("Error fetching scores:",r)})}getBackgroundColor(r){return this.colors[r%this.colors.length]}showAlert(r,i){this.alertData={player:r.player,score:r.score,rank:i},this.newScoreAlert="New High Score!",this.alertTimeout&&clearTimeout(this.alertTimeout),this.alertTimeout=setTimeout(()=>{this.newScoreAlert=null,this.alertData=null},4e3)}closeAlert(){this.newScoreAlert=null,this.alertData=null,this.alertTimeout&&clearTimeout(this.alertTimeout)}triggerConfetti(){kw({particleCount:100,spread:70,origin:{x:.2,y:1},colors:["#ff0000","#00ff00","#0000ff","#ffff00"]}),kw({particleCount:100,spread:70,origin:{x:.8,y:1},colors:["#ff0000","#00ff00","#0000ff","#ffff00"]})}};e.\u0275fac=function(i){return new(i||e)(tn(JT))},e.\u0275cmp=ba({type:e,selectors:[["app-scoreboard"]],decls:20,vars:9,consts:[["loading",""],[1,"scoreboard-container"],[1,"header"],[1,"header-rank"],[1,"header-player"],[1,"header-score"],[1,"fixed"],["class","scrollable-list",4,"ngIf","ngIfElse"],["class","overlay",4,"ngIf"],[1,"scrollable-list"],["class","top3",4,"ngFor","ngForOf"],[1,"top3"],[1,"rank"],[1,"player"],[1,"score"],[3,"ngStyle",4,"ngFor","ngForOf"],[3,"ngStyle"],[1,"overlay"],[1,"overlay-content"],[1,"alert-item"],[1,"alert-key"],[1,"alert-value"]],template:function(i,s){if(i&1&&(rt(0,"h1"),kt(1,"GAMESP32"),tt(),rt(2,"h2"),kt(3,"Scoreboard"),tt(),rt(4,"div",1)(5,"div",2)(6,"span",3),kt(7,"Rank"),tt(),rt(8,"span",4),kt(9,"Player"),tt(),rt(10,"span",5),kt(11,"Score"),tt()(),rt(12,"div",6),to(13,mG,2,1,"ul",7),_v(14,"async"),tt(),to(15,_G,2,1,"ul",7),_v(16,"async"),tt(),to(17,vG,2,0,"ng-template",null,0,bR)(19,wG,16,3,"div",8)),i&2){let o=IR(18);ln(13),Gi("ngIf",vv(14,5,s.scores$))("ngIfElse",o),ln(2),Gi("ngIf",vv(16,7,s.scores$))("ngIfElse",o),ln(4),Gi("ngIf",s.alertData)}},dependencies:[WR,KR,QR,YR],styles:['@font-face{font-family:"Press Start 2P";font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/pressstart2p/v15/e3t4euO8T-267oIAQAu6jDQyK3nYivN04w.woff2) format("woff2");unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:"Press Start 2P";font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/pressstart2p/v15/e3t4euO8T-267oIAQAu6jDQyK3nRivN04w.woff2) format("woff2");unicode-range:U+0301,U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:"Press Start 2P";font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/pressstart2p/v15/e3t4euO8T-267oIAQAu6jDQyK3nWivN04w.woff2) format("woff2");unicode-range:U+0370-0377,U+037A-037F,U+0384-038A,U+038C,U+038E-03A1,U+03A3-03FF}@font-face{font-family:"Press Start 2P";font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/pressstart2p/v15/e3t4euO8T-267oIAQAu6jDQyK3nbivN04w.woff2) format("woff2");unicode-range:U+0100-02AF,U+0304,U+0308,U+0329,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:"Press Start 2P";font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/pressstart2p/v15/e3t4euO8T-267oIAQAu6jDQyK3nVivM.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}[_nghost-%COMP%]{display:block;font-family:"Press Start 2P",cursive;background:#000;color:#fff;text-align:center;padding:20px}h1[_ngcontent-%COMP%]{font-size:3em;margin:0;color:#fff;text-shadow:2px 2px 0 #ff0000;letter-spacing:1px}h2[_ngcontent-%COMP%]{font-size:2em;margin:20px 0;color:#fff;text-shadow:1px 1px 0 #000;letter-spacing:1px}.scoreboard-container[_ngcontent-%COMP%]{display:inline-block;width:80%;max-width:800px;text-align:left}.header[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 3fr 2fr;margin-bottom:10px;font-size:1.2em;font-weight:700;color:#ff0;border-bottom:2px solid #ffff00;padding-bottom:5px}.header[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:5px 10px}ul[_ngcontent-%COMP%]{list-style-type:none;padding:0;margin:0;max-height:400px;overflow-y:scroll;scrollbar-width:thin;scrollbar-color:transparent transparent}ul[_ngcontent-%COMP%]::-webkit-scrollbar{width:0;background:transparent}ul[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:transparent}.fixed[_ngcontent-%COMP%]{position:sticky;top:0;background:#000000e6;z-index:1}li[_ngcontent-%COMP%]{font-size:1em;margin:5px 0;padding:5px 10px;border-radius:5px;border:solid 1px;display:grid;grid-template-columns:1fr 3fr 2fr;align-items:center;background:#000000b3}.top3[_ngcontent-%COMP%]:nth-child(1){color:gold!important;border:5px solid;font-weight:700}.top3[_ngcontent-%COMP%]:nth-child(2){color:silver!important;border:5px solid;font-weight:700}.top3[_ngcontent-%COMP%]:nth-child(3){color:#cd7f32!important;border:5px solid;font-weight:700}.rank[_ngcontent-%COMP%], .player[_ngcontent-%COMP%], .score[_ngcontent-%COMP%]{padding:5px}ng-template[_ngcontent-%COMP%]{color:#fff;font-size:1em}.overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000c;display:flex;align-items:center;justify-content:center;z-index:1000;transition:opacity .5s ease-out}.overlay-content[_ngcontent-%COMP%]{background:#000;border:2px solid #fff;padding:20px;border-radius:8px;color:#fff;text-align:center;box-shadow:0 0 15px #00000080;max-width:400px;width:100%}.overlay-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 20px;font-size:1.5em}.overlay-content[_ngcontent-%COMP%]   .alert-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:15px;font-size:1.2em}.overlay-content[_ngcontent-%COMP%]   .alert-key[_ngcontent-%COMP%]{font-weight:700}.overlay-content[_ngcontent-%COMP%]   .alert-value[_ngcontent-%COMP%]{font-weight:400}.overlay-content[_ngcontent-%COMP%]   .rank[_ngcontent-%COMP%]{font-size:1.4em;color:red;font-weight:700;margin-bottom:15px}.overlay-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;border-radius:4px;padding:10px 20px;cursor:pointer}.overlay-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3}']});let n=e;return n})();var eO=(()=>{let e=class e{constructor(){this.title="snake-like-scoreboard"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=ba({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(i,s){i&1&&zu(0,"app-scoreboard")},dependencies:[Jk]});let n=e;return n})();var tO={firebaseConfig:{apiKey:"AIzaSyCmoXw-iaBEYNq2BIirBdFDejx8WrwBx4M",authDomain:"gamesp32-snake-like.firebaseapp.com",projectId:"gamesp32-snake-like",storageBucket:"gamesp32-snake-like.appspot.com",messagingSenderId:"1027497563231",appId:"1:1027497563231:web:a1a253d7d08e1f9900f7ea"}};var nO="@firebase/database",rO="1.0.7";var dD="";function hD(n){dD=n}var aC=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Ct(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:_h(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var cC=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Hn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var kO=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new aC(e)}}catch{}return new cC},Lo=kO("localStorage"),uC=kO("sessionStorage");var Pc=new ki("@firebase/database"),OO=function(){let n=1;return function(){return n++}}(),FO=function(n){let e=pb(n),t=new fb;t.update(e);let r=t.digest();return gh.encodeByteArray(r)},Ld=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Ld.apply(null,r):typeof r=="object"?e+=Ct(r):e+=r,e+=" "}return e},Vo=null,iO=!0,LO=function(n,e){j(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Pc.logLevel=zn.VERBOSE,Vo=Pc.log.bind(Pc),e&&uC.set("logging_enabled",!0)):typeof n=="function"?Vo=n:(Vo=null,uC.remove("logging_enabled"))},$t=function(...n){if(iO===!0&&(iO=!1,Vo===null&&uC.get("logging_enabled")===!0&&LO(!0)),Vo){let e=Ld.apply(null,n);Vo(e)}},Vd=function(n){return function(...e){$t(n,...e)}},lC=function(...n){let e="FIREBASE INTERNAL ERROR: "+Ld(...n);Pc.error(e)},Zr=function(...n){let e=`FIREBASE FATAL ERROR: ${Ld(...n)}`;throw Pc.error(e),new Error(e)},sn=function(...n){let e="FIREBASE WARNING: "+Ld(...n);Pc.warn(e)},IG=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&sn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},vm=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},TG=function(n){if(Er()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Ts="[MIN_NAME]",Ai="[MAX_NAME]",jo=function(n,e){if(n===e)return 0;if(n===Ts||e===Ai)return-1;if(e===Ts||n===Ai)return 1;{let t=sO(n),r=sO(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},CG=function(n,e){return n===e?0:n<e?-1:1},pd=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Ct(e))},fD=function(n){if(typeof n!="object"||n===null)return Ct(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=Ct(e[r]),t+=":",t+=fD(n[e[r]]);return t+="}",t},VO=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function qt(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var UO=function(n){j(!vm(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,s,o,a,c;n===0?(s=0,o=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(s=0,o=Math.round(n/Math.pow(2,1-r-t))));let l=[];for(c=t;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(s%2?1:0),s=Math.floor(s/2);l.push(i?1:0),l.reverse();let d=l.join(""),f="";for(c=0;c<64;c+=8){let g=parseInt(d.substr(c,8),2).toString(16);g.length===1&&(g="0"+g),f=f+g}return f.toLowerCase()},DG=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},bG=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function SG(n,e){let t="Unknown Error";n==="too_big"?t="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?t="Client doesn't have permission to access the desired data.":n==="unavailable"&&(t="The service is unavailable");let r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}var AG=new RegExp("^-?(0*)\\d{1,10}$"),RG=-2147483648,xG=2147483647,sO=function(n){if(AG.test(n)){let e=Number(n);if(e>=RG&&e<=xG)return e}return null},$c=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw sn("Exception was thrown by user callback.",t),e},Math.floor(0))}},MG=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},_d=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var dC=class{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){sn(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var hC=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?($t("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',sn(e)}},vd=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),Wg="5",jO="v",BO="s",$O="r",qO="f",HO=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,zO="ls",GO="p",fC="ac",WO="websocket",KO="long_polling";var Kg=class{constructor(e,t,r,i,s=!1,o="",a=!1,c=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Lo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Lo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function NG(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function QO(n,e,t){j(typeof e=="string","typeof type must == string"),j(typeof t=="object","typeof params must == object");let r;if(e===WO)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===KO)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);NG(n)&&(t.ns=n.namespace);let i=[];return qt(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var pC=class{constructor(){this.counters_={}}incrementCounter(e,t=1){Hn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return ab(this.counters_)}};var eC={},tC={};function pD(n){let e=n.toString();return eC[e]||(eC[e]=new pC),eC[e]}function PG(n,e){let t=n.toString();return tC[t]||(tC[t]=e()),tC[t]}var gC=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&$c(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var oO="start",kG="close",OG="pLPCommand",FG="pRTLPCB",YO="id",ZO="pw",XO="ser",LG="cb",VG="seg",UG="ts",jG="d",BG="dframe",JO=1870,e1=30,$G=JO-e1,qG=25e3,HG=3e4,Td=class n{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Vd(e),this.stats_=pD(t),this.urlFn=c=>(this.appCheckToken&&(c[fC]=this.appCheckToken),QO(t,KO,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new gC(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(HG)),TG(()=>{if(this.isClosed_)return;this.scriptTagHolder=new mC((...s)=>{let[o,a,c,l,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===oO)this.id=a,this.password=c;else if(o===kG)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[oO]="t",r[XO]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[LG]=this.scriptTagHolder.uniqueCallbackIdentifier),r[jO]=Wg,this.transportSessionId&&(r[BO]=this.transportSessionId),this.lastSessionId&&(r[zO]=this.lastSessionId),this.applicationId&&(r[GO]=this.applicationId),this.appCheckToken&&(r[fC]=this.appCheckToken),typeof location<"u"&&location.hostname&&HO.test(location.hostname)&&(r[$O]=qO);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return Er()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!DG()&&!bG()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=Ct(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=ob(t),i=VO(r,$G);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Er())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[BG]="t",r[YO]=e,r[ZO]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=Ct(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},mC=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Er())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=OO(),window[OG+this.uniqueCallbackIdentifier]=e,window[FG+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){$t("frame writing exception"),a.stack&&$t(a.stack),$t(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||$t("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[YO]=this.myID,e[ZO]=this.myPW,e[XO]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+e1+r.length<=JO;){let o=this.pendingSegs.shift();r=r+"&"+VG+i+"="+o.seg+"&"+UG+i+"="+o.ts+"&"+jG+i+"="+o.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(qG)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,t){Er()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{$t("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var zG=16384,GG=45e3,Qg=null;typeof MozWebSocket<"u"?Qg=MozWebSocket:typeof WebSocket<"u"&&(Qg=WebSocket);var Mc=(()=>{class n{constructor(t,r,i,s,o,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Vd(this.connId),this.stats_=pD(r),this.connURL=n.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){let a={};return a[jO]=Wg,!Er()&&typeof location<"u"&&location.hostname&&HO.test(location.hostname)&&(a[$O]=qO),r&&(a[BO]=r),i&&(a[zO]=i),s&&(a[fC]=s),o&&(a[GO]=o),QO(t,WO,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Lo.set("previous_websocket_failure",!0);try{let i;if(Er()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Wg}/${dD}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Qg(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&Qg!==null&&!n.forceDisallow_}static previouslyFailed(){return Lo.isInMemoryStorage||Lo.get("previous_websocket_failure")===!0}markConnectionHealthy(){Lo.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=_h(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(j(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=Ct(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=VO(r,zG);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(GG))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),t1=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Td,Mc]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){let r=Mc&&Mc.isAvailable(),i=r&&!Mc.previouslyFailed();if(t.webSocketOnly&&(r||sn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Mc];else{let s=this.transports_=[];for(let o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),WG=6e4,KG=5e3,QG=10*1024,YG=100*1024,nC="t",aO="d",ZG="s",cO="r",XG="e",uO="o",lO="a",dO="n",hO="p",JG="h",yC=class{constructor(e,t,r,i,s,o,a,c,l,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Vd("c:"+this.id+":"),this.transportManager_=new t1(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=_d(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>YG?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>QG?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(nC in e){let t=e[nC];t===lO?this.upgradeIfSecondaryHealthy_():t===cO?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===uO&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=pd("t",e),r=pd("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:hO,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:lO,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:dO,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=pd("t",e),r=pd("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=pd(nC,e);if(aO in e){let r=e[aO];if(t===JG){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===dO){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===ZG?this.onConnectionShutdown_(r):t===cO?this.onReset_(r):t===XG?lC("Server Error: "+r):t===uO?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):lC("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Wg!==r&&sn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),_d(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(WG))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):_d(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(KG))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:hO,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Lo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Yg=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var Zg=class{constructor(e){this.allowedEvents_=e,this.listeners_={},j(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){j(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var Xg=class n extends Zg{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!fy()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new n}getInitialEvent(e){return j(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var fO=32,pO=768,Le=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Fe(){return new Le("")}function we(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Cs(n){return n.pieces_.length-n.pieceNum_}function Ke(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Le(n.pieces_,e)}function gD(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function e9(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Cd(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function n1(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Le(e,0)}function at(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Le)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Le(t,0)}function Ee(n){return n.pieceNum_>=n.pieces_.length}function pn(n,e){let t=we(n),r=we(e);if(t===null)return e;if(t===r)return pn(Ke(n),Ke(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function t9(n,e){let t=Cd(n,0),r=Cd(e,0);for(let i=0;i<t.length&&i<r.length;i++){let s=jo(t[i],r[i]);if(s!==0)return s}return t.length===r.length?0:t.length<r.length?-1:1}function mD(n,e){if(Cs(n)!==Cs(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function er(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Cs(n)>Cs(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var _C=class{constructor(e,t){this.errorPrefix_=t,this.parts_=Cd(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=wu(this.parts_[r]);r1(this)}};function n9(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=wu(e),r1(n)}function r9(n){let e=n.parts_.pop();n.byteLength_-=wu(e),n.parts_.length>0&&(n.byteLength_-=1)}function r1(n){if(n.byteLength_>pO)throw new Error(n.errorPrefix_+"has a key path longer than "+pO+" bytes ("+n.byteLength_+").");if(n.parts_.length>fO)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+fO+") or object contains a cycle "+Fo(n))}function Fo(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var vC=class n extends Zg{constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new n}getInitialEvent(e){return j(e==="visible","Unknown event type: "+e),[this.visible_]}};var gd=1e3,i9=60*5*1e3,gO=30*1e3,s9=1.3,o9=3e4,a9="server_kill",mO=3,yD=(()=>{class n extends Yg{constructor(t,r,i,s,o,a,c,l){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=l,this.id=n.nextPersistentConnectionId_++,this.log_=Vd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=gd,this.maxReconnectDelay_=i9,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!Er())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");vC.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Xg.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(Ct(o)),j(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();let r=new Ut,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(t,r,i,s){this.initConnection_();let o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),j(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),j(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(a,o,c=>{let l=c.d,d=c.s;n.warnOnListenWarnings_(l,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,l))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&Hn(t,"w")){let i=Pi(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();sn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||db(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=gO)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=lb(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),j(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);let o={p:t},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Ct(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):lC("Unrecognized action received from server: "+Ct(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){j(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=gd,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=gd,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>o9&&(this.reconnectDelay_=gd),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*s9)}this.onConnectStatus_(!1)}establishConnection_(){return M(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+n.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,l=function(){c?c.close():(a=!0,i())},d=function(g){j(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(g)};this.realtime_={close:l,sendRequest:d};let f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[g,y]=yield Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);a?$t("getToken() completed but was canceled"):($t("getToken() completed. Creating connection."),this.authToken_=g&&g.accessToken,this.appCheckToken_=y&&y.token,c=new yC(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,v=>{sn(v+" ("+this.repoInfo_.toString()+")"),this.interrupt(a9)},o))}catch(g){this.log_("Failed to get token: "+g),a||(this.repoInfo_.nodeAdmin&&sn(g),l())}}})}interrupt(t){$t("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){$t("Resuming connection for reason: "+t),delete this.interruptReasons_[t],vh(this.interruptReasons_)&&(this.reconnectDelay_=gd,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(o=>fD(o)).join("$"):i="default";let s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){let i=new Le(t).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){$t("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=mO&&(this.reconnectDelay_=gO,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){$t("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=mO&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";Er()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+dD.replace(/\./g,"-")]=1,fy()?t["framework.cordova"]=1:cb()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=Xg.getInstance().currentlyOnline();return vh(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),be=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var kc=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new be(Ts,e),i=new be(Ts,t);return this.compare(r,i)!==0}minPost(){return be.MIN}};var Gg,Jg=class extends kc{static get __EMPTY_NODE(){return Gg}static set __EMPTY_NODE(e){Gg=e}compare(e,t){return jo(e.name,t.name)}isDefinedOn(e){throw ea("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return be.MIN}maxPost(){return new be(Ai,Gg)}makePost(e,t){return j(typeof e=="string","KeyIndex indexValue must always be a string."),new be(e,Gg)}toString(){return".key"}},Yr=new Jg;var Nc=class{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},yr=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??tr.EMPTY_NODE,this.right=o??tr.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this,o=i(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return tr.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return tr.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),wC=class{copy(e,t,r,i,s){return this}insert(e,t,r){return new yr(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},tr=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,yr.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,yr.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Nc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Nc(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Nc(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Nc(this.root_,null,this.comparator_,!0,e)}};tr.EMPTY_NODE=new wC;function c9(n,e){return jo(n.name,e.name)}function _D(n,e){return jo(n,e)}var EC;function u9(n){EC=n}var i1=function(n){return typeof n=="number"?"number:"+UO(n):"string:"+n},s1=function(n){if(n.isLeafNode()){let e=n.val();j(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Hn(e,".sv"),"Priority must be a string or number.")}else j(n===EC||n.isEmpty(),"priority of unexpected type.");j(n===EC||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var yO,Oc=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,j(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),s1(this.priorityNode_)}static set __childrenNodeConstructor(t){yO=t}static get __childrenNodeConstructor(){return yO}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Ee(t)?this:we(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=we(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(j(i!==".priority"||Cs(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ke(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+i1(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=UO(this.value_):t+=this.value_,this.lazyHash_=FO(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(j(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return j(s>=0,"Unknown leaf type: "+r),j(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),o1,a1;function l9(n){o1=n}function d9(n){a1=n}var IC=class extends kc{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return s===0?jo(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return be.MIN}maxPost(){return new be(Ai,new Oc("[PRIORITY-POST]",a1))}makePost(e,t){let r=o1(e);return new be(t,new Oc("[PRIORITY-POST]",r))}toString(){return".priority"}},Ze=new IC;var h9=Math.log(2),TC=class{constructor(e){let t=s=>parseInt(Math.log(s)/h9,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},em=function(n,e,t,r){n.sort(e);let i=function(c,l){let d=l-c,f,g;if(d===0)return null;if(d===1)return f=n[c],g=t?t(f):f,new yr(g,f.node,yr.BLACK,null,null);{let y=parseInt(d/2,10)+c,v=i(c,y),b=i(y+1,l);return f=n[y],g=t?t(f):f,new yr(g,f.node,yr.BLACK,v,b)}},s=function(c){let l=null,d=null,f=n.length,g=function(v,b){let C=f-v,V=f;f-=v;let B=i(C+1,V),O=n[C],z=t?t(O):O;y(new yr(z,O.node,b,null,B))},y=function(v){l?(l.left=v,l=v):(d=v,l=v)};for(let v=0;v<c.count;++v){let b=c.nextBitIsOne(),C=Math.pow(2,c.count-(v+1));b?g(C,yr.BLACK):(g(C,yr.BLACK),g(C,yr.RED))}return d},o=new TC(n.length),a=s(o);return new tr(r||e,a)};var rC,xc={},Fc=class n{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return j(xc&&Ze,"ChildrenNode.ts has not been loaded"),rC=rC||new n({".priority":xc},{".priority":Ze}),rC}get(e){let t=Pi(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof tr?t:null}hasIndex(e){return Hn(this.indexSet_,e.toString())}addIndex(e,t){j(e!==Yr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(be.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=em(r,e.getCompare()):a=xc;let c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,l)}addToIndexes(e,t){let r=vu(this.indexes_,(i,s)=>{let o=Pi(this.indexSet_,s);if(j(o,"Missing index implementation for "+s),i===xc)if(o.isDefinedOn(e.node)){let a=[],c=t.getIterator(be.Wrap),l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),em(a,o.getCompare())}else return xc;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new be(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=vu(this.indexes_,i=>{if(i===xc)return i;{let s=t.get(e.name);return s?i.remove(new be(e.name,s)):i}});return new n(r,this.indexSet_)}};var md,ge=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&s1(this.priorityNode_),this.children_.isEmpty()&&j(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return md||(md=new n(new tr(_D),null,Fc.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||md}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?md:r}}getChild(t){let r=we(t);return r===null?this:this.getImmediateChild(r).getChild(Ke(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(j(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new be(t,r),s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?md:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){let i=we(t);if(i===null)return r;{j(we(t)!==".priority"||Cs(t)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Ke(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Ze,(a,c)=>{r[a]=c.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+i1(this.getPriority().val())+":"),this.forEachChild(Ze,(r,i)=>{let s=i.hash();s!==""&&(t+=":"+r+":"+s)}),this.lazyHash_=t===""?"":FO(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new be(t,r));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new be(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new be(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{let s=this.children_.getIteratorFrom(t.name,be.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{let s=this.children_.getReverseIteratorFrom(t.name,be.Wrap),o=s.peek();for(;o!=null&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Ud?-1:0}withIndex(t){if(t===Yr||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Yr||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Ze),s=r.getIterator(Ze),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===Yr?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),CC=class extends ge{constructor(){super(new tr(_D),ge.EMPTY_NODE,Fc.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ge.EMPTY_NODE}isEmpty(){return!1}},Ud=new CC;Object.defineProperties(be,{MIN:{value:new be(Ts,ge.EMPTY_NODE)},MAX:{value:new be(Ai,Ud)}});Jg.__EMPTY_NODE=ge.EMPTY_NODE;Oc.__childrenNodeConstructor=ge;u9(Ud);d9(Ud);var f9=!0;function lt(n,e=null){if(n===null)return ge.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),j(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new Oc(t,lt(e))}if(!(n instanceof Array)&&f9){let t=[],r=!1;if(qt(n,(o,a)=>{if(o.substring(0,1)!=="."){let c=lt(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new be(o,c)))}}),t.length===0)return ge.EMPTY_NODE;let s=em(t,c9,o=>o.name,_D);if(r){let o=em(t,Ze.getCompare());return new ge(s,lt(e),new Fc({".priority":o},{".priority":Ze}))}else return new ge(s,lt(e),Fc.Default)}else{let t=ge.EMPTY_NODE;return qt(n,(r,i)=>{if(Hn(n,r)&&r.substring(0,1)!=="."){let s=lt(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(lt(e))}}l9(lt);var Dd=class extends kc{constructor(e){super(),this.indexPath_=e,j(!Ee(e)&&we(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return s===0?jo(e.name,t.name):s}makePost(e,t){let r=lt(e),i=ge.EMPTY_NODE.updateChild(this.indexPath_,r);return new be(t,i)}maxPost(){let e=ge.EMPTY_NODE.updateChild(this.indexPath_,Ud);return new be(Ai,e)}toString(){return Cd(this.indexPath_,0).join("/")}};var DC=class extends kc{compare(e,t){let r=e.node.compareTo(t.node);return r===0?jo(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return be.MIN}maxPost(){return be.MAX}makePost(e,t){let r=lt(e);return new be(t,r)}toString(){return".value"}},vD=new DC;function c1(n){return{type:"value",snapshotNode:n}}function Lc(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function bd(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function Sd(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function p9(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var Ad=class{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){j(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(bd(t,a)):j(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Lc(t,r)):o.trackChildChange(Sd(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Ze,(i,s)=>{t.hasChild(i)||r.trackChildChange(bd(i,s))}),t.isLeafNode()||t.forEachChild(Ze,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Sd(i,s,o))}else r.trackChildChange(Lc(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?ge.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var tm=class n{constructor(e){this.indexedFilter_=new Ad(e.getIndex()),this.index_=e.getIndex(),this.startPost_=n.getStartPost_(e),this.endPost_=n.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new be(t,r))||(r=ge.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=ge.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(ge.EMPTY_NODE);let s=this;return t.forEachChild(Ze,(o,a)=>{s.matches(new be(o,a))||(i=i.updateImmediateChild(o,ge.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}else return e.getIndex().maxPost()}};var bC=class{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{let r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new tm(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new be(t,r))||(r=ge.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=ge.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<t.numChildren()&&t.isIndexed(this.index_)){i=ge.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=t.withIndex(this.index_),i=i.updatePriority(ge.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,ge.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){let f=this.index_.getCompare();o=(g,y)=>f(y,g)}else o=this.index_.getCompare();let a=e;j(a.numChildren()===this.limit_,"");let c=new be(t,r),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(a.hasChild(t)){let f=a.getImmediateChild(t),g=i.getChildAfterChild(this.index_,l,this.reverse_);for(;g!=null&&(g.name===t||a.hasChild(g.name));)g=i.getChildAfterChild(this.index_,g,this.reverse_);let y=g==null?1:o(g,c);if(d&&!r.isEmpty()&&y>=0)return s?.trackChildChange(Sd(t,r,f)),a.updateImmediateChild(t,r);{s?.trackChildChange(bd(t,f));let b=a.updateImmediateChild(t,ge.EMPTY_NODE);return g!=null&&this.rangedFilter_.matches(g)?(s?.trackChildChange(Lc(g.name,g.node)),b.updateImmediateChild(g.name,g.node)):b}}else return r.isEmpty()?e:d&&o(l,c)>=0?(s!=null&&(s.trackChildChange(bd(l.name,l.node)),s.trackChildChange(Lc(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(l.name,ge.EMPTY_NODE)):e}};var Rd=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ze}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return j(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return j(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ts}hasEnd(){return this.endSet_}getIndexEndValue(){return j(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return j(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ai}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return j(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ze}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function g9(n){return n.loadsAllData()?new Ad(n.getIndex()):n.hasLimit()?new bC(n):new tm(n)}function m9(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}function y9(n,e){let t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}function SC(n,e,t){let r=n.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,t!=null?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function _9(n,e,t){let r;return n.index_===Yr||t?r=SC(n,e,t):r=SC(n,e,Ai),r.startAfterSet_=!0,r}function AC(n,e,t){let r=n.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,t!==void 0?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function v9(n,e,t){let r;return n.index_===Yr||t?r=AC(n,e,t):r=AC(n,e,Ts),r.endBeforeSet_=!0,r}function wm(n,e){let t=n.copy();return t.index_=e,t}function _O(n){let e={};if(n.isDefault())return e;let t;if(n.index_===Ze?t="$priority":n.index_===vD?t="$value":n.index_===Yr?t="$key":(j(n.index_ instanceof Dd,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Ct(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=Ct(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+Ct(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=Ct(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+Ct(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function vO(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==Ze&&(e.i=n.index_.toString()),e}var RC=class n extends Yg{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Vd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(j(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=n.getListenId_(e,r),a={};this.listens_[o]=a;let c=_O(e._queryParams);this.restRequest_(s+".json",c,(l,d)=>{let f=d;if(l===404&&(f=null,l=null),l===null&&this.onDataUpdate_(s,f,!1,r),Pi(this.listens_,o)===a){let g;l?l===401?g="permission_denied":g="rest_error:"+l:g="ok",i(g,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=_O(e._queryParams),r=e._path.toString(),i=new Ut;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+hb(t);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=_h(a.responseText)}catch{sn("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&sn("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var xC=class{constructor(){this.rootNode_=ge.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function nm(){return{value:null,children:new Map}}function qc(n,e,t){if(Ee(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=we(e);n.children.has(r)||n.children.set(r,nm());let i=n.children.get(r);e=Ke(e),qc(i,e,t)}}function MC(n,e){if(Ee(e))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{let t=n.value;return n.value=null,t.forEachChild(Ze,(r,i)=>{qc(n,new Le(r),i)}),MC(n,e)}}else if(n.children.size>0){let t=we(e);return e=Ke(e),n.children.has(t)&&MC(n.children.get(t),e)&&n.children.delete(t),n.children.size===0}else return!0}function NC(n,e,t){n.value!==null?t(e,n.value):w9(n,(r,i)=>{let s=new Le(e.toString()+"/"+r);NC(i,s,t)})}function w9(n,e){n.children.forEach((t,r)=>{e(r,t)})}var PC=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&qt(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var wO=10*1e3,E9=30*1e3,I9=5*60*1e3,kC=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new PC(e);let r=wO+(E9-wO)*Math.random();_d(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;qt(e,(i,s)=>{s>0&&Hn(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),_d(this.reportStats_.bind(this),Math.floor(Math.random()*2*I9))}};var Qr=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Qr||{});function wD(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function ED(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function ID(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var OC=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Qr.ACK_USER_WRITE,this.source=wD()}operationForChild(e){if(Ee(this.path)){if(this.affectedTree.value!=null)return j(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new Le(e));return new n(Fe(),t,this.revert)}}else return j(we(this.path)===e,"operationForChild called for unrelated child."),new n(Ke(this.path),this.affectedTree,this.revert)}};var rm=class n{constructor(e,t){this.source=e,this.path=t,this.type=Qr.LISTEN_COMPLETE}operationForChild(e){return Ee(this.path)?new n(this.source,Fe()):new n(this.source,Ke(this.path))}};var Vc=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Qr.OVERWRITE}operationForChild(e){return Ee(this.path)?new n(this.source,Fe(),this.snap.getImmediateChild(e)):new n(this.source,Ke(this.path),this.snap)}};var xd=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Qr.MERGE}operationForChild(e){if(Ee(this.path)){let t=this.children.subtree(new Le(e));return t.isEmpty()?null:t.value?new Vc(this.source,Fe(),t.value):new n(this.source,Fe(),t)}else return j(we(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,Ke(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Xr=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ee(e))return this.isFullyInitialized()&&!this.filtered_;let t=we(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var FC=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function T9(n,e,t,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(p9(o.childName,o.snapshotNode))}),yd(n,i,"child_removed",e,r,t),yd(n,i,"child_added",e,r,t),yd(n,i,"child_moved",s,r,t),yd(n,i,"child_changed",e,r,t),yd(n,i,"value",e,r,t),i}function yd(n,e,t,r,i,s){let o=r.filter(a=>a.type===t);o.sort((a,c)=>D9(n,a,c)),o.forEach(a=>{let c=C9(n,a,s);i.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,n.query_))})})}function C9(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function D9(n,e,t){if(e.childName==null||t.childName==null)throw ea("Should only compare child_ events.");let r=new be(e.childName,e.snapshotNode),i=new be(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function Em(n,e){return{eventCache:n,serverCache:e}}function wd(n,e,t,r){return Em(new Xr(e,t,r),n.serverCache)}function u1(n,e,t,r){return Em(n.eventCache,new Xr(e,t,r))}function im(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Uo(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var iC,b9=()=>(iC||(iC=new tr(CG)),iC),gn=class n{constructor(e,t=b9()){this.value=e,this.children=t}static fromObject(e){let t=new n(null);return qt(e,(r,i)=>{t=t.set(new Le(r),i)}),t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Fe(),value:this.value};if(Ee(e))return null;{let r=we(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Ke(e),t);return s!=null?{path:at(new Le(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ee(e))return this;{let t=we(e),r=this.children.get(t);return r!==null?r.subtree(Ke(e)):new n(null)}}set(e,t){if(Ee(e))return new n(t,this.children);{let r=we(e),s=(this.children.get(r)||new n(null)).set(Ke(e),t),o=this.children.insert(r,s);return new n(this.value,o)}}remove(e){if(Ee(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=we(e),r=this.children.get(t);if(r){let i=r.remove(Ke(e)),s;return i.isEmpty()?s=this.children.remove(t):s=this.children.insert(t,i),this.value===null&&s.isEmpty()?new n(null):new n(this.value,s)}else return this}}get(e){if(Ee(e))return this.value;{let t=we(e),r=this.children.get(t);return r?r.get(Ke(e)):null}}setTree(e,t){if(Ee(e))return t;{let r=we(e),s=(this.children.get(r)||new n(null)).setTree(Ke(e),t),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new n(this.value,o)}}fold(e){return this.fold_(Fe(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(at(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Fe(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(Ee(e))return null;{let s=we(e),o=this.children.get(s);return o?o.findOnPath_(Ke(e),at(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Fe(),t)}foreachOnPath_(e,t,r){if(Ee(e))return this;{this.value&&r(t,this.value);let i=we(e),s=this.children.get(i);return s?s.foreachOnPath_(Ke(e),at(t,i),r):new n(null)}}foreach(e){this.foreach_(Fe(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(at(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var _r=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new gn(null))}};function Ed(n,e,t){if(Ee(e))return new _r(new gn(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=pn(i,e);return s=s.updateChild(o,t),new _r(n.writeTree_.set(i,s))}else{let i=new gn(t),s=n.writeTree_.setTree(e,i);return new _r(s)}}}function LC(n,e,t){let r=n;return qt(t,(i,s)=>{r=Ed(r,at(e,i),s)}),r}function EO(n,e){if(Ee(e))return _r.empty();{let t=n.writeTree_.setTree(e,new gn(null));return new _r(t)}}function VC(n,e){return Bo(n,e)!=null}function Bo(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(pn(t.path,e)):null}function IO(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(Ze,(r,i)=>{e.push(new be(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new be(r,i.value))}),e}function Es(n,e){if(Ee(e))return n;{let t=Bo(n,e);return t!=null?new _r(new gn(t)):new _r(n.writeTree_.subtree(e))}}function UC(n){return n.writeTree_.isEmpty()}function Uc(n,e){return l1(Fe(),n.writeTree_,e)}function l1(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(j(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):t=l1(at(n,i),s,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(at(n,".priority"),r)),t}}function Im(n,e){return p1(e,n)}function S9(n,e,t,r,i){j(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Ed(n.visibleWrites,e,t)),n.lastWriteId=r}function A9(n,e,t,r){j(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=LC(n.visibleWrites,e,t),n.lastWriteId=r}function R9(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function x9(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);j(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){let a=n.allWrites[o];a.visible&&(o>=t&&M9(a,r.path)?i=!1:er(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return N9(n),!0;if(r.snap)n.visibleWrites=EO(n.visibleWrites,r.path);else{let a=r.children;qt(a,c=>{n.visibleWrites=EO(n.visibleWrites,at(r.path,c))})}return!0}else return!1}function M9(n,e){if(n.snap)return er(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&er(at(n.path,t),e))return!0;return!1}function N9(n){n.visibleWrites=d1(n.allWrites,P9,Fe()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function P9(n){return n.visible}function d1(n,e,t){let r=_r.empty();for(let i=0;i<n.length;++i){let s=n[i];if(e(s)){let o=s.path,a;if(s.snap)er(t,o)?(a=pn(t,o),r=Ed(r,a,s.snap)):er(o,t)&&(a=pn(o,t),r=Ed(r,Fe(),s.snap.getChild(a)));else if(s.children){if(er(t,o))a=pn(t,o),r=LC(r,a,s.children);else if(er(o,t))if(a=pn(o,t),Ee(a))r=LC(r,Fe(),s.children);else{let c=Pi(s.children,we(a));if(c){let l=c.getChild(Ke(a));r=Ed(r,Fe(),l)}}}else throw ea("WriteRecord should have .snap or .children")}}return r}function h1(n,e,t,r,i){if(!r&&!i){let s=Bo(n.visibleWrites,e);if(s!=null)return s;{let o=Es(n.visibleWrites,e);if(UC(o))return t;if(t==null&&!VC(o,Fe()))return null;{let a=t||ge.EMPTY_NODE;return Uc(o,a)}}}else{let s=Es(n.visibleWrites,e);if(!i&&UC(s))return t;if(!i&&t==null&&!VC(s,Fe()))return null;{let o=function(l){return(l.visible||i)&&(!r||!~r.indexOf(l.writeId))&&(er(l.path,e)||er(e,l.path))},a=d1(n.allWrites,o,e),c=t||ge.EMPTY_NODE;return Uc(a,c)}}}function k9(n,e,t){let r=ge.EMPTY_NODE,i=Bo(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Ze,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){let s=Es(n.visibleWrites,e);return t.forEachChild(Ze,(o,a)=>{let c=Uc(Es(s,new Le(o)),a);r=r.updateImmediateChild(o,c)}),IO(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Es(n.visibleWrites,e);return IO(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function O9(n,e,t,r,i){j(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=at(e,t);if(VC(n.visibleWrites,s))return null;{let o=Es(n.visibleWrites,s);return UC(o)?i.getChild(t):Uc(o,i.getChild(t))}}function F9(n,e,t,r){let i=at(e,t),s=Bo(n.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(t)){let o=Es(n.visibleWrites,i);return Uc(o,r.getNode().getImmediateChild(t))}else return null}function L9(n,e){return Bo(n.visibleWrites,e)}function V9(n,e,t,r,i,s,o){let a,c=Es(n.visibleWrites,e),l=Bo(c,Fe());if(l!=null)a=l;else if(t!=null)a=Uc(c,t);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],f=o.getCompare(),g=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),y=g.getNext();for(;y&&d.length<i;)f(y,r)!==0&&d.push(y),y=g.getNext();return d}else return[]}function U9(){return{visibleWrites:_r.empty(),allWrites:[],lastWriteId:-1}}function sm(n,e,t,r){return h1(n.writeTree,n.treePath,e,t,r)}function TD(n,e){return k9(n.writeTree,n.treePath,e)}function TO(n,e,t,r){return O9(n.writeTree,n.treePath,e,t,r)}function om(n,e){return L9(n.writeTree,at(n.treePath,e))}function j9(n,e,t,r,i,s){return V9(n.writeTree,n.treePath,e,t,r,i,s)}function CD(n,e,t){return F9(n.writeTree,n.treePath,e,t)}function f1(n,e){return p1(at(n.treePath,e),n.writeTree)}function p1(n,e){return{treePath:n,writeTree:e}}var jC=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;j(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),j(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(t==="child_added"&&s==="child_removed")this.changeMap.set(r,Sd(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&s==="child_changed")this.changeMap.set(r,bd(r,i.oldSnap));else if(t==="child_changed"&&s==="child_added")this.changeMap.set(r,Lc(r,e.snapshotNode));else if(t==="child_changed"&&s==="child_changed")this.changeMap.set(r,Sd(r,e.snapshotNode,i.oldSnap));else throw ea("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var BC=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},g1=new BC,Md=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Xr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return CD(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Uo(this.viewCache_),s=j9(this.writes_,i,t,1,r,e);return s.length===0?null:s[0]}};function B9(n){return{filter:n}}function $9(n,e){j(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),j(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function q9(n,e,t,r,i){let s=new jC,o,a;if(t.type===Qr.OVERWRITE){let l=t;l.source.fromUser?o=$C(n,e,l.path,l.snap,r,i,s):(j(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!Ee(l.path),o=am(n,e,l.path,l.snap,r,i,a,s))}else if(t.type===Qr.MERGE){let l=t;l.source.fromUser?o=z9(n,e,l.path,l.children,r,i,s):(j(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=qC(n,e,l.path,l.children,r,i,a,s))}else if(t.type===Qr.ACK_USER_WRITE){let l=t;l.revert?o=K9(n,e,l.path,r,i,s):o=G9(n,e,l.path,l.affectedTree,r,i,s)}else if(t.type===Qr.LISTEN_COMPLETE)o=W9(n,e,t.path,r,s);else throw ea("Unknown operation type: "+t.type);let c=s.getChanges();return H9(e,o,c),{viewCache:o,changes:c}}function H9(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=im(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(c1(im(e)))}}function m1(n,e,t,r,i,s){let o=e.eventCache;if(om(r,t)!=null)return e;{let a,c;if(Ee(t))if(j(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let l=Uo(e),d=l instanceof ge?l:ge.EMPTY_NODE,f=TD(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),f,s)}else{let l=sm(r,Uo(e));a=n.filter.updateFullNode(e.eventCache.getNode(),l,s)}else{let l=we(t);if(l===".priority"){j(Cs(t)===1,"Can't have a priority with additional path components");let d=o.getNode();c=e.serverCache.getNode();let f=TO(r,t,d,c);f!=null?a=n.filter.updatePriority(d,f):a=o.getNode()}else{let d=Ke(t),f;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();let g=TO(r,t,o.getNode(),c);g!=null?f=o.getNode().getImmediateChild(l).updateChild(d,g):f=o.getNode().getImmediateChild(l)}else f=CD(r,l,e.serverCache);f!=null?a=n.filter.updateChild(o.getNode(),l,f,d,i,s):a=o.getNode()}}return wd(e,a,o.isFullyInitialized()||Ee(t),n.filter.filtersNodes())}}function am(n,e,t,r,i,s,o,a){let c=e.serverCache,l,d=o?n.filter:n.filter.getIndexedFilter();if(Ee(t))l=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let y=c.getNode().updateChild(t,r);l=d.updateFullNode(c.getNode(),y,null)}else{let y=we(t);if(!c.isCompleteForPath(t)&&Cs(t)>1)return e;let v=Ke(t),C=c.getNode().getImmediateChild(y).updateChild(v,r);y===".priority"?l=d.updatePriority(c.getNode(),C):l=d.updateChild(c.getNode(),y,C,v,g1,null)}let f=u1(e,l,c.isFullyInitialized()||Ee(t),d.filtersNodes()),g=new Md(i,f,s);return m1(n,f,t,i,g,a)}function $C(n,e,t,r,i,s,o){let a=e.eventCache,c,l,d=new Md(i,e,s);if(Ee(t))l=n.filter.updateFullNode(e.eventCache.getNode(),r,o),c=wd(e,l,!0,n.filter.filtersNodes());else{let f=we(t);if(f===".priority")l=n.filter.updatePriority(e.eventCache.getNode(),r),c=wd(e,l,a.isFullyInitialized(),a.isFiltered());else{let g=Ke(t),y=a.getNode().getImmediateChild(f),v;if(Ee(g))v=r;else{let b=d.getCompleteChild(f);b!=null?gD(g)===".priority"&&b.getChild(n1(g)).isEmpty()?v=b:v=b.updateChild(g,r):v=ge.EMPTY_NODE}if(y.equals(v))c=e;else{let b=n.filter.updateChild(a.getNode(),f,v,g,d,o);c=wd(e,b,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function CO(n,e){return n.eventCache.isCompleteForChild(e)}function z9(n,e,t,r,i,s,o){let a=e;return r.foreach((c,l)=>{let d=at(t,c);CO(e,we(d))&&(a=$C(n,a,d,l,i,s,o))}),r.foreach((c,l)=>{let d=at(t,c);CO(e,we(d))||(a=$C(n,a,d,l,i,s,o))}),a}function DO(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function qC(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;Ee(t)?l=r:l=new gn(null).setTree(t,r);let d=e.serverCache.getNode();return l.children.inorderTraversal((f,g)=>{if(d.hasChild(f)){let y=e.serverCache.getNode().getImmediateChild(f),v=DO(n,y,g);c=am(n,c,new Le(f),v,i,s,o,a)}}),l.children.inorderTraversal((f,g)=>{let y=!e.serverCache.isCompleteForChild(f)&&g.value===null;if(!d.hasChild(f)&&!y){let v=e.serverCache.getNode().getImmediateChild(f),b=DO(n,v,g);c=am(n,c,new Le(f),b,i,s,o,a)}}),c}function G9(n,e,t,r,i,s,o){if(om(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(Ee(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return am(n,e,t,c.getNode().getChild(t),i,s,a,o);if(Ee(t)){let l=new gn(null);return c.getNode().forEachChild(Yr,(d,f)=>{l=l.set(new Le(d),f)}),qC(n,e,t,l,i,s,a,o)}else return e}else{let l=new gn(null);return r.foreach((d,f)=>{let g=at(t,d);c.isCompleteForPath(g)&&(l=l.set(d,c.getNode().getChild(g)))}),qC(n,e,t,l,i,s,a,o)}}function W9(n,e,t,r,i){let s=e.serverCache,o=u1(e,s.getNode(),s.isFullyInitialized()||Ee(t),s.isFiltered());return m1(n,o,t,r,g1,i)}function K9(n,e,t,r,i,s){let o;if(om(r,t)!=null)return e;{let a=new Md(r,e,i),c=e.eventCache.getNode(),l;if(Ee(t)||we(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=sm(r,Uo(e));else{let f=e.serverCache.getNode();j(f instanceof ge,"serverChildren would be complete if leaf node"),d=TD(r,f)}d=d,l=n.filter.updateFullNode(c,d,s)}else{let d=we(t),f=CD(r,d,e.serverCache);f==null&&e.serverCache.isCompleteForChild(d)&&(f=c.getImmediateChild(d)),f!=null?l=n.filter.updateChild(c,d,f,Ke(t),a,s):e.eventCache.getNode().hasChild(d)?l=n.filter.updateChild(c,d,ge.EMPTY_NODE,Ke(t),a,s):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=sm(r,Uo(e)),o.isLeafNode()&&(l=n.filter.updateFullNode(l,o,s)))}return o=e.serverCache.isFullyInitialized()||om(r,Fe())!=null,wd(e,l,o,n.filter.filtersNodes())}}var HC=class{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Ad(r.getIndex()),s=g9(r);this.processor_=B9(s);let o=t.serverCache,a=t.eventCache,c=i.updateFullNode(ge.EMPTY_NODE,o.getNode(),null),l=s.updateFullNode(ge.EMPTY_NODE,a.getNode(),null),d=new Xr(c,o.isFullyInitialized(),i.filtersNodes()),f=new Xr(l,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Em(f,d),this.eventGenerator_=new FC(this.query_)}get query(){return this.query_}};function Q9(n){return n.viewCache_.serverCache.getNode()}function Y9(n){return im(n.viewCache_)}function Z9(n,e){let t=Uo(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Ee(e)&&!t.getImmediateChild(we(e)).isEmpty())?t.getChild(e):null}function bO(n){return n.eventRegistrations_.length===0}function X9(n,e){n.eventRegistrations_.push(e)}function SO(n,e,t){let r=[];if(t){j(e==null,"A cancel should cancel all event registrations.");let i=n.query._path;n.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){let o=n.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function AO(n,e,t,r){e.type===Qr.MERGE&&e.source.queryId!==null&&(j(Uo(n.viewCache_),"We should always have a full cache before handling merges"),j(im(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,s=q9(n.processor_,i,e,t,r);return $9(n.processor_,s.viewCache),j(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,y1(n,s.changes,s.viewCache.eventCache.getNode(),null)}function J9(n,e){let t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Ze,(s,o)=>{r.push(Lc(s,o))}),t.isFullyInitialized()&&r.push(c1(t.getNode())),y1(n,r,t.getNode(),e)}function y1(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return T9(n.eventGenerator_,e,t,i)}var cm,um=class{constructor(){this.views=new Map}};function eW(n){j(!cm,"__referenceConstructor has already been defined"),cm=n}function tW(){return j(cm,"Reference.ts has not been loaded"),cm}function nW(n){return n.views.size===0}function DD(n,e,t,r){let i=e.source.queryId;if(i!==null){let s=n.views.get(i);return j(s!=null,"SyncTree gave us an op for an invalid query."),AO(s,e,t,r)}else{let s=[];for(let o of n.views.values())s=s.concat(AO(o,e,t,r));return s}}function _1(n,e,t,r,i){let s=e._queryIdentifier,o=n.views.get(s);if(!o){let a=sm(t,i?r:null),c=!1;a?c=!0:r instanceof ge?(a=TD(t,r),c=!1):(a=ge.EMPTY_NODE,c=!1);let l=Em(new Xr(a,c,!1),new Xr(r,i,!1));return new HC(e,l)}return o}function rW(n,e,t,r,i,s){let o=_1(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),X9(o,t),J9(o,t)}function iW(n,e,t,r){let i=e._queryIdentifier,s=[],o=[],a=Ds(n);if(i==="default")for(let[c,l]of n.views.entries())o=o.concat(SO(l,t,r)),bO(l)&&(n.views.delete(c),l.query._queryParams.loadsAllData()||s.push(l.query));else{let c=n.views.get(i);c&&(o=o.concat(SO(c,t,r)),bO(c)&&(n.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!Ds(n)&&s.push(new(tW())(e._repo,e._path)),{removed:s,events:o}}function v1(n){let e=[];for(let t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Is(n,e){let t=null;for(let r of n.views.values())t=t||Z9(r,e);return t}function w1(n,e){if(e._queryParams.loadsAllData())return Tm(n);{let r=e._queryIdentifier;return n.views.get(r)}}function E1(n,e){return w1(n,e)!=null}function Ds(n){return Tm(n)!=null}function Tm(n){for(let e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var lm;function sW(n){j(!lm,"__referenceConstructor has already been defined"),lm=n}function oW(){return j(lm,"Reference.ts has not been loaded"),lm}var aW=1,dm=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new gn(null),this.pendingWriteTree_=U9(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function bD(n,e,t,r,i){return S9(n.pendingWriteTree_,e,t,r,i),i?Hc(n,new Vc(wD(),e,t)):[]}function cW(n,e,t,r){A9(n.pendingWriteTree_,e,t,r);let i=gn.fromObject(t);return Hc(n,new xd(wD(),e,i))}function ws(n,e,t=!1){let r=R9(n.pendingWriteTree_,e);if(x9(n.pendingWriteTree_,e)){let s=new gn(null);return r.snap!=null?s=s.set(Fe(),!0):qt(r.children,o=>{s=s.set(new Le(o),!0)}),Hc(n,new OC(r.path,s,t))}else return[]}function jd(n,e,t){return Hc(n,new Vc(ED(),e,t))}function uW(n,e,t){let r=gn.fromObject(t);return Hc(n,new xd(ED(),e,r))}function lW(n,e){return Hc(n,new rm(ED(),e))}function dW(n,e,t){let r=SD(n,t);if(r){let i=AD(r),s=i.path,o=i.queryId,a=pn(s,e),c=new rm(ID(o),a);return RD(n,s,c)}else return[]}function hm(n,e,t,r,i=!1){let s=e._path,o=n.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||E1(o,e))){let c=iW(o,e,t,r);nW(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));let l=c.removed;if(a=c.events,!i){let d=l.findIndex(g=>g._queryParams.loadsAllData())!==-1,f=n.syncPointTree_.findOnPath(s,(g,y)=>Ds(y));if(d&&!f){let g=n.syncPointTree_.subtree(s);if(!g.isEmpty()){let y=pW(g);for(let v=0;v<y.length;++v){let b=y[v],C=b.query,V=D1(n,b);n.listenProvider_.startListening(Id(C),Nd(n,C),V.hashFn,V.onComplete)}}}!f&&l.length>0&&!r&&(d?n.listenProvider_.stopListening(Id(e),null):l.forEach(g=>{let y=n.queryToTagMap.get(Dm(g));n.listenProvider_.stopListening(Id(g),y)}))}gW(n,l)}return a}function I1(n,e,t,r){let i=SD(n,r);if(i!=null){let s=AD(i),o=s.path,a=s.queryId,c=pn(o,e),l=new Vc(ID(a),c,t);return RD(n,o,l)}else return[]}function hW(n,e,t,r){let i=SD(n,r);if(i){let s=AD(i),o=s.path,a=s.queryId,c=pn(o,e),l=gn.fromObject(t),d=new xd(ID(a),c,l);return RD(n,o,d)}else return[]}function zC(n,e,t,r=!1){let i=e._path,s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(g,y)=>{let v=pn(g,i);s=s||Is(y,v),o=o||Ds(y)});let a=n.syncPointTree_.get(i);a?(o=o||Ds(a),s=s||Is(a,Fe())):(a=new um,n.syncPointTree_=n.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=ge.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((y,v)=>{let b=Is(v,Fe());b&&(s=s.updateImmediateChild(y,b))}));let l=E1(a,e);if(!l&&!e._queryParams.loadsAllData()){let g=Dm(e);j(!n.queryToTagMap.has(g),"View does not exist, but we have a tag");let y=mW();n.queryToTagMap.set(g,y),n.tagToQueryMap.set(y,g)}let d=Im(n.pendingWriteTree_,i),f=rW(a,e,t,d,s,c);if(!l&&!o&&!r){let g=w1(a,e);f=f.concat(yW(n,e,g))}return f}function Cm(n,e,t){let i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{let c=pn(o,e),l=Is(a,c);if(l)return l});return h1(i,e,s,t,!0)}function fW(n,e){let t=e._path,r=null;n.syncPointTree_.foreachOnPath(t,(l,d)=>{let f=pn(l,t);r=r||Is(d,f)});let i=n.syncPointTree_.get(t);i?r=r||Is(i,Fe()):(i=new um,n.syncPointTree_=n.syncPointTree_.set(t,i));let s=r!=null,o=s?new Xr(r,!0,!1):null,a=Im(n.pendingWriteTree_,e._path),c=_1(i,e,a,s?o.getNode():ge.EMPTY_NODE,s);return Y9(c)}function Hc(n,e){return T1(e,n.syncPointTree_,null,Im(n.pendingWriteTree_,Fe()))}function T1(n,e,t,r){if(Ee(n.path))return C1(n,e,t,r);{let i=e.get(Fe());t==null&&i!=null&&(t=Is(i,Fe()));let s=[],o=we(n.path),a=n.operationForChild(o),c=e.children.get(o);if(c&&a){let l=t?t.getImmediateChild(o):null,d=f1(r,o);s=s.concat(T1(a,c,l,d))}return i&&(s=s.concat(DD(i,n,r,t))),s}}function C1(n,e,t,r){let i=e.get(Fe());t==null&&i!=null&&(t=Is(i,Fe()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=t?t.getImmediateChild(o):null,l=f1(r,o),d=n.operationForChild(o);d&&(s=s.concat(C1(d,a,c,l)))}),i&&(s=s.concat(DD(i,n,r,t))),s}function D1(n,e){let t=e.query,r=Nd(n,t);return{hashFn:()=>(Q9(e)||ge.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?dW(n,t._path,r):lW(n,t._path);{let s=SG(i,t);return hm(n,t,null,s)}}}}function Nd(n,e){let t=Dm(e);return n.queryToTagMap.get(t)}function Dm(n){return n._path.toString()+"$"+n._queryIdentifier}function SD(n,e){return n.tagToQueryMap.get(e)}function AD(n){let e=n.indexOf("$");return j(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Le(n.substr(0,e))}}function RD(n,e,t){let r=n.syncPointTree_.get(e);j(r,"Missing sync point for query tag that we're tracking");let i=Im(n.pendingWriteTree_,e);return DD(r,t,i,null)}function pW(n){return n.fold((e,t,r)=>{if(t&&Ds(t))return[Tm(t)];{let i=[];return t&&(i=v1(t)),qt(r,(s,o)=>{i=i.concat(o)}),i}})}function Id(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(oW())(n._repo,n._path):n}function gW(n,e){for(let t=0;t<e.length;++t){let r=e[t];if(!r._queryParams.loadsAllData()){let i=Dm(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}function mW(){return aW++}function yW(n,e,t){let r=e._path,i=Nd(n,e),s=D1(n,t),o=n.listenProvider_.startListening(Id(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)j(!Ds(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((l,d,f)=>{if(!Ee(l)&&d&&Ds(d))return[Tm(d).query];{let g=[];return d&&(g=g.concat(v1(d).map(y=>y.query))),qt(f,(y,v)=>{g=g.concat(v)}),g}});for(let l=0;l<c.length;++l){let d=c[l];n.listenProvider_.stopListening(Id(d),Nd(n,d))}}return o}var GC=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},WC=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=at(this.path_,e);return new n(this.syncTree_,t)}node(){return Cm(this.syncTree_,this.path_)}},_W=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},RO=function(n,e,t){if(!n||typeof n!="object")return n;if(j(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return vW(n[".sv"],e,t);if(typeof n[".sv"]=="object")return wW(n[".sv"],e);j(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},vW=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:j(!1,"Unexpected server value: "+n)}},wW=function(n,e,t){n.hasOwnProperty("increment")||j(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&j(!1,"Unexpected increment value: "+r);let i=e.node();if(j(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},b1=function(n,e,t,r){return MD(e,new WC(t,n),r)},xD=function(n,e,t){return MD(n,new GC(e),t)};function MD(n,e,t){let r=n.getPriority().val(),i=RO(r,e.getImmediateChild(".priority"),t),s;if(n.isLeafNode()){let o=n,a=RO(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new Oc(a,lt(i)):n}else{let o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Oc(i))),o.forEachChild(Ze,(a,c)=>{let l=MD(c,e.getImmediateChild(a),t);l!==c&&(s=s.updateImmediateChild(a,l))}),s}}var Pd=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function bm(n,e){let t=e instanceof Le?e:new Le(e),r=n,i=we(t);for(;i!==null;){let s=Pi(r.node.children,i)||{children:{},childCount:0};r=new Pd(i,r,s),t=Ke(t),i=we(t)}return r}function $o(n){return n.node.value}function ND(n,e){n.node.value=e,KC(n)}function S1(n){return n.node.childCount>0}function EW(n){return $o(n)===void 0&&!S1(n)}function Sm(n,e){qt(n.node.children,(t,r)=>{e(new Pd(t,n,r))})}function A1(n,e,t,r){t&&!r&&e(n),Sm(n,i=>{A1(i,e,!0,r)}),t&&r&&e(n)}function IW(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Bd(n){return new Le(n.parent===null?n.name:Bd(n.parent)+"/"+n.name)}function KC(n){n.parent!==null&&TW(n.parent,n.name,n)}function TW(n,e,t){let r=EW(t),i=Hn(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,KC(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,KC(n))}var CW=/[\[\].#$\/\u0000-\u001F\u007F]/,DW=/[\[\].#$\u0000-\u001F\u007F]/,sC=10*1024*1024,Am=function(n){return typeof n=="string"&&n.length!==0&&!CW.test(n)},R1=function(n){return typeof n=="string"&&n.length!==0&&!DW.test(n)},bW=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),R1(n)},kd=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!vm(n)||n&&typeof n=="object"&&Hn(n,".sv")},Jr=function(n,e,t,r){r&&e===void 0||$d(wn(n,"value"),e,t)},$d=function(n,e,t){let r=t instanceof Le?new _C(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+Fo(r));if(typeof e=="function")throw new Error(n+"contains a function "+Fo(r)+" with contents = "+e.toString());if(vm(e))throw new Error(n+"contains "+e.toString()+" "+Fo(r));if(typeof e=="string"&&e.length>sC/3&&wu(e)>sC)throw new Error(n+"contains a string greater than "+sC+" utf8 bytes "+Fo(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(qt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Am(o)))throw new Error(n+" contains an invalid key ("+o+") "+Fo(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);n9(r,o),$d(n,a,r),r9(r)}),i&&s)throw new Error(n+' contains ".value" child '+Fo(r)+" in addition to actual children.")}},SW=function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];let s=Cd(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Am(s[o]))throw new Error(n+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(t9);let i=null;for(t=0;t<e.length;t++){if(r=e[t],i!==null&&er(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},x1=function(n,e,t,r){if(r&&e===void 0)return;let i=wn(n,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];qt(e,(o,a)=>{let c=new Le(o);if($d(i,a,at(t,c)),gD(c)===".priority"&&!kd(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),SW(i,s)},PD=function(n,e,t){if(!(t&&e===void 0)){if(vm(e))throw new Error(wn(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!kd(e))throw new Error(wn(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},qd=function(n,e,t,r){if(!(r&&t===void 0)&&!Am(t))throw new Error(wn(n,e)+'was an invalid key = "'+t+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},zc=function(n,e,t,r){if(!(r&&t===void 0)&&!R1(t))throw new Error(wn(n,e)+'was an invalid path = "'+t+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},AW=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),zc(n,e,t,r)},Vn=function(n,e){if(we(e)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},M1=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Am(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!bW(t))throw new Error(wn(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var QC=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Rm(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();t!==null&&!mD(s,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)}function N1(n,e,t){Rm(n,t),P1(n,r=>mD(r,e))}function Un(n,e,t){Rm(n,t),P1(n,r=>er(r,e)||er(e,r))}function P1(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let s=i.path;e(s)?(RW(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function RW(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();Vo&&$t("event: "+t.toString()),$c(r)}}}var k1="repo_interrupt",xW=25,YC=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new QC,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=nm(),this.transactionQueueTree_=new Pd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function MW(n,e,t){if(n.stats_=pD(n.repoInfo_),n.forceRestClient_||MG())n.server_=new RC(n.repoInfo_,(r,i,s,o)=>{xO(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>MO(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Ct(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new yD(n.repoInfo_,e,(r,i,s,o)=>{xO(n,r,i,s,o)},r=>{MO(n,r)},r=>{NW(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=PG(n.repoInfo_,()=>new kC(n.stats_,n.server_)),n.infoData_=new xC,n.infoSyncTree_=new dm({startListening:(r,i,s,o)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=jd(n.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),kD(n,"connected",!1),n.serverSyncTree_=new dm({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,c)=>{let l=o(a,c);Un(n.eventQueue_,r._path,l)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function O1(n){let t=n.infoData_.getNode(new Le(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function Hd(n){return _W({timestamp:O1(n)})}function xO(n,e,t,r,i){n.dataUpdateCount++;let s=new Le(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){let c=vu(t,l=>lt(l));o=hW(n.serverSyncTree_,s,c,i)}else{let c=lt(t);o=I1(n.serverSyncTree_,s,c,i)}else if(r){let c=vu(t,l=>lt(l));o=uW(n.serverSyncTree_,s,c)}else{let c=lt(t);o=jd(n.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=jc(n,s)),Un(n.eventQueue_,a,o)}function MO(n,e){kD(n,"connected",e),e===!1&&OW(n)}function NW(n,e){qt(e,(t,r)=>{kD(n,t,r)})}function kD(n,e,t){let r=new Le("/.info/"+e),i=lt(t);n.infoData_.updateSnapshot(r,i);let s=jd(n.infoSyncTree_,r,i);Un(n.eventQueue_,r,s)}function xm(n){return n.nextWriteId_++}function PW(n,e,t){let r=fW(n.serverSyncTree_,e);return r!=null?Promise.resolve(r):n.server_.get(e).then(i=>{let s=lt(i).withIndex(e._queryParams.getIndex());zC(n.serverSyncTree_,e,t,!0);let o;if(e._queryParams.loadsAllData())o=jd(n.serverSyncTree_,e._path,s);else{let a=Nd(n.serverSyncTree_,e);o=I1(n.serverSyncTree_,e._path,s,a)}return Un(n.eventQueue_,e._path,o),hm(n.serverSyncTree_,e,t,null,!0),s},i=>(Gc(n,"get for query "+Ct(e)+" failed: "+i),Promise.reject(new Error(i))))}function OD(n,e,t,r,i){Gc(n,"set",{path:e.toString(),value:t,priority:r});let s=Hd(n),o=lt(t,r),a=Cm(n.serverSyncTree_,e),c=xD(o,a,s),l=xm(n),d=bD(n.serverSyncTree_,e,c,l,!0);Rm(n.eventQueue_,d),n.server_.put(e.toString(),o.val(!0),(g,y)=>{let v=g==="ok";v||sn("set at "+e+" failed: "+g);let b=ws(n.serverSyncTree_,l,!v);Un(n.eventQueue_,e,b),bs(n,i,g,y)});let f=LD(n,e);jc(n,f),Un(n.eventQueue_,f,[])}function kW(n,e,t,r){Gc(n,"update",{path:e.toString(),value:t});let i=!0,s=Hd(n),o={};if(qt(t,(a,c)=>{i=!1,o[a]=b1(at(e,a),lt(c),n.serverSyncTree_,s)}),i)$t("update() called with empty data.  Don't do anything."),bs(n,r,"ok",void 0);else{let a=xm(n),c=cW(n.serverSyncTree_,e,o,a);Rm(n.eventQueue_,c),n.server_.merge(e.toString(),t,(l,d)=>{let f=l==="ok";f||sn("update at "+e+" failed: "+l);let g=ws(n.serverSyncTree_,a,!f),y=g.length>0?jc(n,e):e;Un(n.eventQueue_,y,g),bs(n,r,l,d)}),qt(t,l=>{let d=LD(n,at(e,l));jc(n,d)}),Un(n.eventQueue_,e,[])}}function OW(n){Gc(n,"onDisconnectEvents");let e=Hd(n),t=nm();NC(n.onDisconnect_,Fe(),(i,s)=>{let o=b1(i,s,n.serverSyncTree_,e);qc(t,i,o)});let r=[];NC(t,Fe(),(i,s)=>{r=r.concat(jd(n.serverSyncTree_,i,s));let o=LD(n,i);jc(n,o)}),n.onDisconnect_=nm(),Un(n.eventQueue_,Fe(),r)}function FW(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&MC(n.onDisconnect_,e),bs(n,t,r,i)})}function NO(n,e,t,r){let i=lt(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&qc(n.onDisconnect_,e,i),bs(n,r,s,o)})}function LW(n,e,t,r,i){let s=lt(t,r);n.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&qc(n.onDisconnect_,e,s),bs(n,i,o,a)})}function VW(n,e,t,r){if(vh(t)){$t("onDisconnect().update() called with empty data.  Don't do anything."),bs(n,r,"ok",void 0);return}n.server_.onDisconnectMerge(e.toString(),t,(i,s)=>{i==="ok"&&qt(t,(o,a)=>{let c=lt(a);qc(n.onDisconnect_,at(e,o),c)}),bs(n,r,i,s)})}function UW(n,e,t){let r;we(e._path)===".info"?r=zC(n.infoSyncTree_,e,t):r=zC(n.serverSyncTree_,e,t),N1(n.eventQueue_,e._path,r)}function ZC(n,e,t){let r;we(e._path)===".info"?r=hm(n.infoSyncTree_,e,t):r=hm(n.serverSyncTree_,e,t),N1(n.eventQueue_,e._path,r)}function F1(n){n.persistentConnection_&&n.persistentConnection_.interrupt(k1)}function jW(n){n.persistentConnection_&&n.persistentConnection_.resume(k1)}function Gc(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),$t(t,...e)}function bs(n,e,t,r){e&&$c(()=>{if(t==="ok")e(null);else{let i=(t||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function BW(n,e,t,r,i,s){Gc(n,"transaction on "+e);let o={path:e,update:t,onComplete:r,status:null,order:OO(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=FD(n,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{$d("transaction failed: Data returned ",c,o.path),o.status=0;let l=bm(n.transactionQueueTree_,e),d=$o(l)||[];d.push(o),ND(l,d);let f;typeof c=="object"&&c!==null&&Hn(c,".priority")?(f=Pi(c,".priority"),j(kd(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(Cm(n.serverSyncTree_,e)||ge.EMPTY_NODE).getPriority().val();let g=Hd(n),y=lt(c,f),v=xD(y,a,g);o.currentOutputSnapshotRaw=y,o.currentOutputSnapshotResolved=v,o.currentWriteId=xm(n);let b=bD(n.serverSyncTree_,e,v,o.currentWriteId,o.applyLocally);Un(n.eventQueue_,e,b),Mm(n,n.transactionQueueTree_)}}function FD(n,e,t){return Cm(n.serverSyncTree_,e,t)||ge.EMPTY_NODE}function Mm(n,e=n.transactionQueueTree_){if(e||Nm(n,e),$o(e)){let t=V1(n,e);j(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&$W(n,Bd(e),t)}else S1(e)&&Sm(e,t=>{Mm(n,t)})}function $W(n,e,t){let r=t.map(l=>l.currentWriteId),i=FD(n,e,r),s=i,o=i.hash();for(let l=0;l<t.length;l++){let d=t[l];j(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let f=pn(e,d.path);s=s.updateChild(f,d.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;n.server_.put(c.toString(),a,l=>{Gc(n,"transaction put response",{path:c.toString(),status:l});let d=[];if(l==="ok"){let f=[];for(let g=0;g<t.length;g++)t[g].status=2,d=d.concat(ws(n.serverSyncTree_,t[g].currentWriteId)),t[g].onComplete&&f.push(()=>t[g].onComplete(null,!0,t[g].currentOutputSnapshotResolved)),t[g].unwatcher();Nm(n,bm(n.transactionQueueTree_,e)),Mm(n,n.transactionQueueTree_),Un(n.eventQueue_,e,d);for(let g=0;g<f.length;g++)$c(f[g])}else{if(l==="datastale")for(let f=0;f<t.length;f++)t[f].status===3?t[f].status=4:t[f].status=0;else{sn("transaction at "+c.toString()+" failed: "+l);for(let f=0;f<t.length;f++)t[f].status=4,t[f].abortReason=l}jc(n,e)}},o)}function jc(n,e){let t=L1(n,e),r=Bd(t),i=V1(n,t);return qW(n,i,r),r}function qW(n,e,t){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],l=pn(t,c.path),d=!1,f;if(j(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,f=c.abortReason,i=i.concat(ws(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=xW)d=!0,f="maxretry",i=i.concat(ws(n.serverSyncTree_,c.currentWriteId,!0));else{let g=FD(n,c.path,o);c.currentInputSnapshot=g;let y=e[a].update(g.val());if(y!==void 0){$d("transaction failed: Data returned ",y,c.path);let v=lt(y);typeof y=="object"&&y!=null&&Hn(y,".priority")||(v=v.updatePriority(g.getPriority()));let C=c.currentWriteId,V=Hd(n),B=xD(v,g,V);c.currentOutputSnapshotRaw=v,c.currentOutputSnapshotResolved=B,c.currentWriteId=xm(n),o.splice(o.indexOf(C),1),i=i.concat(bD(n.serverSyncTree_,c.path,B,c.currentWriteId,c.applyLocally)),i=i.concat(ws(n.serverSyncTree_,C,!0))}else d=!0,f="nodata",i=i.concat(ws(n.serverSyncTree_,c.currentWriteId,!0))}Un(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(g){setTimeout(g,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(f==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(f),!1,null))))}Nm(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)$c(r[a]);Mm(n,n.transactionQueueTree_)}function L1(n,e){let t,r=n.transactionQueueTree_;for(t=we(e);t!==null&&$o(r)===void 0;)r=bm(r,t),e=Ke(e),t=we(e);return r}function V1(n,e){let t=[];return U1(n,e,t),t.sort((r,i)=>r.order-i.order),t}function U1(n,e,t){let r=$o(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);Sm(e,i=>{U1(n,i,t)})}function Nm(n,e){let t=$o(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,ND(e,t.length>0?t:void 0)}Sm(e,r=>{Nm(n,r)})}function LD(n,e){let t=Bd(L1(n,e)),r=bm(n.transactionQueueTree_,e);return IW(r,i=>{oC(n,i)}),oC(n,r),A1(r,i=>{oC(n,i)}),t}function oC(n,e){let t=$o(e);if(t){let r=[],i=[],s=-1;for(let o=0;o<t.length;o++)t[o].status===3||(t[o].status===1?(j(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(j(t[o].status===0,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(ws(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?ND(e,void 0):t.length=s+1,Un(n.eventQueue_,Bd(e),i);for(let o=0;o<r.length;o++)$c(r[o])}}function HW(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function zW(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):sn(`Invalid query segment '${t}' in query '${n}'`)}return e}var XC=function(n,e){let t=GW(n),r=t.namespace;t.domain==="firebase.com"&&Zr(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&Zr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||IG();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Kg(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new Le(t.pathString)}},GW=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",c=443;if(typeof n=="string"){let l=n.indexOf("//");l>=0&&(a=n.substring(0,l-1),n=n.substring(l+2));let d=n.indexOf("/");d===-1&&(d=n.length);let f=n.indexOf("?");f===-1&&(f=n.length),e=n.substring(0,Math.min(d,f)),d<f&&(i=HW(n.substring(d,f)));let g=zW(n.substring(Math.min(n.length,f)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;let y=e.slice(0,l);if(y.toLowerCase()==="localhost")t="localhost";else if(y.split(".").length<=2)t=y;else{let v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),t=e.substring(v+1),s=r}"ns"in g&&(s=g.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var PO="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",WW=function(){let n=0,e=[];return function(t){let r=t===n;n=t;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=PO.charAt(t%64),t=Math.floor(t/64);j(t===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=PO.charAt(e[i]);return j(o.length===20,"nextPushId: Length should be 20."),o}}();var fm=class{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Ct(this.snapshot.exportVal())}},pm=class{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Od=class{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return j(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var gm=class{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new Ut;return FW(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Vn("OnDisconnect.remove",this._path);let e=new Ut;return NO(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Vn("OnDisconnect.set",this._path),Jr("OnDisconnect.set",e,this._path,!1);let t=new Ut;return NO(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){Vn("OnDisconnect.setWithPriority",this._path),Jr("OnDisconnect.setWithPriority",e,this._path,!1),PD("OnDisconnect.setWithPriority",t,!1);let r=new Ut;return LW(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){Vn("OnDisconnect.update",this._path),x1("OnDisconnect.update",e,this._path,!1);let t=new Ut;return VW(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}};var mn=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Ee(this._path)?null:gD(this._path)}get ref(){return new jn(this._repo,this._path)}get _queryIdentifier(){let e=vO(this._queryParams),t=fD(e);return t==="{}"?"default":t}get _queryObject(){return vO(this._queryParams)}isEqual(e){if(e=ce(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=mD(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+e9(this._path)}};function Pm(n,e){if(n._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function As(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===Yr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==Ts)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==Ai)throw new Error(r);if(typeof t!="string")throw new Error(i)}}else if(n.getIndex()===Ze){if(e!=null&&!kd(e)||t!=null&&!kd(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(j(n.getIndex()instanceof Dd||n.getIndex()===vD,"unknown index type."),e!=null&&typeof e=="object"||t!=null&&typeof t=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function km(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var jn=class n extends mn{constructor(e,t){super(e,t,new Rd,!1)}get parent(){let e=n1(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Bc=class n{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new Le(e),r=Ss(this.ref,e);return new n(this._node.getChild(t),r,Ze)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new n(i,Ss(this.ref,r),Ze)))}hasChild(e){let t=new Le(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function VD(n,e){return n=ce(n),n._checkNotDeleted("ref"),e!==void 0?Ss(n._root,e):n._root}function UD(n,e){n=ce(n),n._checkNotDeleted("refFromURL");let t=XC(e,n._repo.repoInfo_.nodeAdmin);M1("refFromURL",t);let r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&Zr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),VD(n,t.path.toString())}function Ss(n,e){return n=ce(n),we(n._path)===null?AW("child","path",e,!1):zc("child","path",e,!1),new jn(n._repo,at(n._path,e))}function j1(n,e){n=ce(n),Vn("push",n._path),Jr("push",e,n._path,!0);let t=O1(n._repo),r=WW(t),i=Ss(n,r),s=Ss(n,r),o;return e!=null?o=Om(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function B1(n){return Vn("remove",n._path),Om(n,null)}function Om(n,e){n=ce(n),Vn("set",n._path),Jr("set",e,n._path,!1);let t=new Ut;return OD(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function $1(n,e){n=ce(n),Vn("setPriority",n._path),PD("setPriority",e,!1);let t=new Ut;return OD(n._repo,at(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}function q1(n,e,t){if(Vn("setWithPriority",n._path),Jr("setWithPriority",e,n._path,!1),PD("setWithPriority",t,!1),n.key===".length"||n.key===".keys")throw"setWithPriority failed: "+n.key+" is a read-only object.";let r=new Ut;return OD(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}function H1(n,e){x1("update",e,n._path,!1);let t=new Ut;return kW(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function z1(n){n=ce(n);let e=new Od(()=>{}),t=new Fd(e);return PW(n._repo,n,t).then(r=>new Bc(r,new jn(n._repo,n._path),n._queryParams.getIndex()))}var Fd=class n{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,t){let r=t._queryParams.getIndex();return new fm("value",this,new Bc(e.snapshotNode,new jn(t._repo,t._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new pm(this,e,t):null}matches(e){return e instanceof n?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},mm=class n{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t=e==="children_added"?"child_added":e;return t=t==="children_removed"?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new pm(this,e,t):null}createEvent(e,t){j(e.childName!=null,"Child events should have a childName.");let r=Ss(new jn(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new fm(e.type,this,new Bc(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof n?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function zd(n,e,t,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=t,l=(d,f)=>{ZC(n._repo,n,a),c(d,f)};l.userCallback=t.userCallback,l.context=t.context,t=l}let o=new Od(t,s||void 0),a=e==="value"?new Fd(o):new mm(e,o);return UW(n._repo,n,a),()=>ZC(n._repo,n,a)}function Fm(n,e,t,r){return zd(n,"value",e,t,r)}function jD(n,e,t,r){return zd(n,"child_added",e,t,r)}function BD(n,e,t,r){return zd(n,"child_changed",e,t,r)}function $D(n,e,t,r){return zd(n,"child_moved",e,t,r)}function qD(n,e,t,r){return zd(n,"child_removed",e,t,r)}function HD(n,e,t){let r=null,i=t?new Od(t):null;e==="value"?r=new Fd(i):e&&(r=new mm(e,i)),ZC(n._repo,n,r)}var Bn=class{},ym=class extends Bn{constructor(e,t){super(),this._value=e,this._key=t,this.type="endAt"}_apply(e){Jr("endAt",this._value,e._path,!0);let t=AC(e._queryParams,this._value,this._key);if(km(t),As(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new mn(e._repo,e._path,t,e._orderByCalled)}};function G1(n,e){return qd("endAt","key",e,!0),new ym(n,e)}var JC=class extends Bn{constructor(e,t){super(),this._value=e,this._key=t,this.type="endBefore"}_apply(e){Jr("endBefore",this._value,e._path,!1);let t=v9(e._queryParams,this._value,this._key);if(km(t),As(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new mn(e._repo,e._path,t,e._orderByCalled)}};function W1(n,e){return qd("endBefore","key",e,!0),new JC(n,e)}var _m=class extends Bn{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAt"}_apply(e){Jr("startAt",this._value,e._path,!0);let t=SC(e._queryParams,this._value,this._key);if(km(t),As(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new mn(e._repo,e._path,t,e._orderByCalled)}};function K1(n=null,e){return qd("startAt","key",e,!0),new _m(n,e)}var eD=class extends Bn{constructor(e,t){super(),this._value=e,this._key=t,this.type="startAfter"}_apply(e){Jr("startAfter",this._value,e._path,!1);let t=_9(e._queryParams,this._value,this._key);if(km(t),As(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new mn(e._repo,e._path,t,e._orderByCalled)}};function Q1(n,e){return qd("startAfter","key",e,!0),new eD(n,e)}var tD=class extends Bn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new mn(e._repo,e._path,m9(e._queryParams,this._limit),e._orderByCalled)}};function Y1(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new tD(n)}var nD=class extends Bn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new mn(e._repo,e._path,y9(e._queryParams,this._limit),e._orderByCalled)}};function Z1(n){if(typeof n!="number"||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new nD(n)}var rD=class extends Bn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Pm(e,"orderByChild");let t=new Le(this._path);if(Ee(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new Dd(t),i=wm(e._queryParams,r);return As(i),new mn(e._repo,e._path,i,!0)}};function X1(n){if(n==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(n==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(n==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return zc("orderByChild","path",n,!1),new rD(n)}var iD=class extends Bn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Pm(e,"orderByKey");let t=wm(e._queryParams,Yr);return As(t),new mn(e._repo,e._path,t,!0)}};function J1(){return new iD}var sD=class extends Bn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Pm(e,"orderByPriority");let t=wm(e._queryParams,Ze);return As(t),new mn(e._repo,e._path,t,!0)}};function eF(){return new sD}var oD=class extends Bn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Pm(e,"orderByValue");let t=wm(e._queryParams,vD);return As(t),new mn(e._repo,e._path,t,!0)}};function tF(){return new oD}var aD=class extends Bn{constructor(e,t){super(),this._value=e,this._key=t,this.type="equalTo"}_apply(e){if(Jr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new ym(this._value,this._key)._apply(new _m(this._value,this._key)._apply(e))}};function nF(n,e){return qd("equalTo","key",e,!0),new aD(n,e)}function nr(n,...e){let t=ce(n);for(let r of e)t=r._apply(t);return t}eW(jn);sW(jn);var KW="FIREBASE_DATABASE_EMULATOR_HOST",cD={},QW=!1;function YW(n,e,t,r){n.repoInfo_=new Kg(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}function zD(n,e,t,r,i){let s=r||n.options.databaseURL;s===void 0&&(n.options.projectId||Zr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),$t("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let o=XC(s,i),a=o.repoInfo,c,l;typeof process<"u"&&process.env&&(l=process.env[KW]),l?(c=!0,s=`http://${l}?ns=${a.namespace}`,o=XC(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let d=i&&c?new vd(vd.OWNER):new hC(n.name,n.options,e);M1("Invalid Firebase Database URL",o),Ee(o.path)||Zr("Database URL must point to the root of a Firebase Database (not including a child path).");let f=XW(a,n,d,new dC(n.name,t));return new uD(f,n)}function ZW(n,e){let t=cD[e];(!t||t[n.key]!==n)&&Zr(`Database ${e}(${n.repoInfo_}) has already been deleted.`),F1(n),delete t[n.key]}function XW(n,e,t,r){let i=cD[e.name];i||(i={},cD[e.name]=i);let s=i[n.toURLString()];return s&&Zr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new YC(n,QW,t,r),i[n.toURLString()]=s,s}var uD=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(MW(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new jn(this._repo,Fe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(ZW(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Zr("Cannot call "+e+" on a deleted database.")}};function rF(){t1.IS_TRANSPORT_INITIALIZED&&sn("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function iF(){rF(),Td.forceDisallow()}function sF(){rF(),Mc.forceDisallow(),Td.forceAllow()}function oF(n,e,t,r={}){n=ce(n),n._checkNotDeleted("useEmulator"),n._instanceStarted&&Zr("Cannot call useEmulator() after instance has already been initialized.");let i=n._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Zr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new vd(vd.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:ta(r.mockUserToken,n.app.options.projectId);s=new vd(o)}YW(i,e,t,s)}function aF(n){n=ce(n),n._checkNotDeleted("goOffline"),F1(n._repo)}function cF(n){n=ce(n),n._checkNotDeleted("goOnline"),jW(n._repo)}function uF(n,e){LO(n,e)}function JW(n){hD(na),si(new Gt("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return zD(r,i,s,t)},"PUBLIC").setMultipleInstances(!0)),En(nO,rO,n),En(nO,rO,"esm2017")}var e3={".sv":"timestamp"};function lF(){return e3}function dF(n){return{".sv":{increment:n}}}var lD=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function hF(n,e,t){var r;if(n=ce(n),Vn("Reference.transaction",n._path),n.key===".length"||n.key===".keys")throw"Reference.transaction failed: "+n.key+" is a read-only object.";let i=(r=t?.applyLocally)!==null&&r!==void 0?r:!0,s=new Ut,o=(c,l,d)=>{let f=null;c?s.reject(c):(f=new Bc(d,new jn(n._repo,n._path),Ze),s.resolve(new lD(l,f)))},a=Fm(n,()=>{});return BW(n._repo,n._path,e,o,a,i),s.promise}yD.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};yD.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};JW();var t3="@firebase/database-compat",n3="1.0.7";var r3=new ki("@firebase/database-compat"),fF=function(n){let e="FIREBASE WARNING: "+n;r3.warn(e)};var i3=function(n,e,t,r){if(!(r&&t===void 0)&&typeof t!="boolean")throw new Error(wn(n,e)+"must be a boolean.")},s3=function(n,e,t){if(!(t&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(wn(n,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var GD=class{constructor(e){this._delegate=e}cancel(e){ae("OnDisconnect.cancel",0,1,arguments.length),Pt("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){ae("OnDisconnect.remove",0,1,arguments.length),Pt("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){ae("OnDisconnect.set",1,2,arguments.length),Pt("OnDisconnect.set","onComplete",t,!0);let r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ae("OnDisconnect.setWithPriority",2,3,arguments.length),Pt("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,t){if(ae("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,fF("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Pt("OnDisconnect.update","onComplete",t,!0);let r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}};var WD=class{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return ae("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var qo=class n{constructor(e,t){this._database=e,this._delegate=t}val(){return ae("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return ae("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return ae("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return ae("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return ae("DataSnapshot.child",0,1,arguments.length),e=String(e),zc("DataSnapshot.child","path",e,!1),new n(this._database,this._delegate.child(e))}hasChild(e){return ae("DataSnapshot.hasChild",1,1,arguments.length),zc("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return ae("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return ae("DataSnapshot.forEach",1,1,arguments.length),Pt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new n(this._database,t)))}hasChildren(){return ae("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return ae("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return ae("DataSnapshot.ref",0,0,arguments.length),new Ri(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Lm=class n{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var s;ae("Query.on",2,4,arguments.length),Pt("Query.on","callback",t,!1);let o=n.getCancelAndContextArgs_("Query.on",r,i),a=(l,d)=>{t.call(o.context,new qo(this.database,l),d)};a.userCallback=t,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Fm(this._delegate,a,c),t;case"child_added":return jD(this._delegate,a,c),t;case"child_removed":return qD(this._delegate,a,c),t;case"child_changed":return BD(this._delegate,a,c),t;case"child_moved":return $D(this._delegate,a,c),t;default:throw new Error(wn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if(ae("Query.off",0,3,arguments.length),s3("Query.off",e,!0),Pt("Query.off","callback",t,!0),my("Query.off","context",r,!0),t){let i=()=>{};i.userCallback=t,i.context=r,HD(this._delegate,e,i)}else HD(this._delegate,e)}get(){return z1(this._delegate).then(e=>new qo(this.database,e))}once(e,t,r,i){ae("Query.once",1,4,arguments.length),Pt("Query.once","callback",t,!0);let s=n.getCancelAndContextArgs_("Query.once",r,i),o=new Ut,a=(l,d)=>{let f=new qo(this.database,l);t&&t.call(s.context,f,d),o.resolve(f)};a.userCallback=t,a.context=s.context;let c=l=>{s.cancel&&s.cancel.call(s.context,l),o.reject(l)};switch(e){case"value":Fm(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":jD(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":qD(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":BD(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":$D(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(wn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return ae("Query.limitToFirst",1,1,arguments.length),new n(this.database,nr(this._delegate,Y1(e)))}limitToLast(e){return ae("Query.limitToLast",1,1,arguments.length),new n(this.database,nr(this._delegate,Z1(e)))}orderByChild(e){return ae("Query.orderByChild",1,1,arguments.length),new n(this.database,nr(this._delegate,X1(e)))}orderByKey(){return ae("Query.orderByKey",0,0,arguments.length),new n(this.database,nr(this._delegate,J1()))}orderByPriority(){return ae("Query.orderByPriority",0,0,arguments.length),new n(this.database,nr(this._delegate,eF()))}orderByValue(){return ae("Query.orderByValue",0,0,arguments.length),new n(this.database,nr(this._delegate,tF()))}startAt(e=null,t){return ae("Query.startAt",0,2,arguments.length),new n(this.database,nr(this._delegate,K1(e,t)))}startAfter(e=null,t){return ae("Query.startAfter",0,2,arguments.length),new n(this.database,nr(this._delegate,Q1(e,t)))}endAt(e=null,t){return ae("Query.endAt",0,2,arguments.length),new n(this.database,nr(this._delegate,G1(e,t)))}endBefore(e=null,t){return ae("Query.endBefore",0,2,arguments.length),new n(this.database,nr(this._delegate,W1(e,t)))}equalTo(e,t){return ae("Query.equalTo",1,2,arguments.length),new n(this.database,nr(this._delegate,nF(e,t)))}toString(){return ae("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return ae("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(ae("Query.isEqual",1,1,arguments.length),!(e instanceof n)){let t="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(t)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){let i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,Pt(e,"cancel",i.cancel,!0),i.context=r,my(e,"context",i.context,!0);else if(t)if(typeof t=="object"&&t!==null)i.context=t;else if(typeof t=="function")i.cancel=t;else throw new Error(wn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Ri(this.database,new jn(this._delegate._repo,this._delegate._path))}},Ri=class n extends Lm{constructor(e,t){super(e,new mn(t._repo,t._path,new Rd,!1)),this.database=e,this._delegate=t}getKey(){return ae("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return ae("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new n(this.database,Ss(this._delegate,e))}getParent(){ae("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new n(this.database,e):null}getRoot(){return ae("Reference.root",0,0,arguments.length),new n(this.database,this._delegate.root)}set(e,t){ae("Reference.set",1,2,arguments.length),Pt("Reference.set","onComplete",t,!0);let r=Om(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if(ae("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,fF("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Vn("Reference.update",this._delegate._path),Pt("Reference.update","onComplete",t,!0);let r=H1(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){ae("Reference.setWithPriority",2,3,arguments.length),Pt("Reference.setWithPriority","onComplete",r,!0);let i=q1(this._delegate,e,t);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){ae("Reference.remove",0,1,arguments.length),Pt("Reference.remove","onComplete",e,!0);let t=B1(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){ae("Reference.transaction",1,3,arguments.length),Pt("Reference.transaction","transactionUpdate",e,!1),Pt("Reference.transaction","onComplete",t,!0),i3("Reference.transaction","applyLocally",r,!0);let i=hF(this._delegate,e,{applyLocally:r}).then(s=>new WD(s.committed,new qo(this.database,s.snapshot)));return t&&i.then(s=>t(null,s.committed,s.snapshot),s=>t(s,!1,null)),i}setPriority(e,t){ae("Reference.setPriority",1,2,arguments.length),Pt("Reference.setPriority","onComplete",t,!0);let r=$1(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){ae("Reference.push",0,2,arguments.length),Pt("Reference.push","onComplete",t,!0);let r=j1(this._delegate,e),i=r.then(o=>new n(this.database,o));t&&i.then(()=>t(null),o=>t(o));let s=new n(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return Vn("Reference.onDisconnect",this._delegate._path),new GD(new gm(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Ho=class{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:iF,forceLongPolling:sF}}useEmulator(e,t,r={}){oF(this._delegate,e,t,r)}ref(e){if(ae("database.ref",0,1,arguments.length),e instanceof Ri){let t=UD(this._delegate,e.toString());return new Ri(this,t)}else{let t=VD(this._delegate,e);return new Ri(this,t)}}refFromURL(e){ae("database.refFromURL",1,1,arguments.length);let r=UD(this._delegate,e);return new Ri(this,r)}goOffline(){return ae("database.goOffline",0,0,arguments.length),aF(this._delegate)}goOnline(){return ae("database.goOnline",0,0,arguments.length),cF(this._delegate)}};Ho.ServerValue={TIMESTAMP:lF(),increment:n=>dF(n)};function o3({app:n,url:e,version:t,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){hD(t);let a=new yy("database-standalone"),c=new wh("auth-internal",a);c.setComponent(new Gt("auth-internal",()=>r,"PRIVATE"));let l;return i&&(l=new wh("app-check-internal",a),l.setComponent(new Gt("app-check-internal",()=>i,"PRIVATE"))),{instance:new Ho(zD(n,c,l,e,o),n),namespace:s}}var a3=Object.freeze({__proto__:null,initStandalone:o3});var c3=Ho.ServerValue;function u3(n){n.INTERNAL.registerComponent(new Gt("database-compat",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new Ho(i,r)},"PUBLIC").setServiceProps({Reference:Ri,Query:Lm,Database:Ho,DataSnapshot:qo,enableLogging:uF,INTERNAL:a3,ServerValue:c3}).setMultipleInstances(!0)),n.registerVersion(t3,n3)}u3(ft);function Gd(n,e,t="on",r=ai){return new ve(i=>{let s=null;return s=n[t](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),t==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),t==="on"?{unsubscribe(){s!=null&&n.off(e,s)}}:{unsubscribe(){}}}).pipe(ee(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),Su())}function l3(n){return typeof n=="string"}function d3(n){return typeof n.exportVal=="function"}function _F(n){return n==null}function vF(n){return typeof n.set=="function"}function pF(n,e){return vF(e)?e:n.ref(e)}function wF(n,e){if(l3(n))return e.stringCase();if(vF(n))return e.firebaseCase();if(d3(n))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof n}`)}function EF(n){return(_F(n)||n.length===0)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function IF(n,e,t){e=EF(e);let r=e.map(i=>Gd(n,i,"on",t));return pa(...r)}function h3(n,e,t){let r=IF(n,e).pipe(Tr((i,s)=>[...i,s],[]));return p3(n,r,t)}function f3(n,e){return Gd(n,"value","on",e).pipe(ee(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}function p3(n,e,t){return f3(n,t).pipe(jy(e),ee(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(c=>c.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),Vy(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),ee(i=>i.actions))}function gF(n,e){return function(r,i){return wF(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function g3(n){return function(t){return t?wF(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function m3(n,e,t){return Gd(n,"value","once",t).pipe(ze(r=>{let i=[ne(r)];return e.forEach(s=>i.push(Gd(n,s,"on",t))),pa(...i).pipe(Tr(_3,[]))}),Cu())}function TF(n,e){let t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function y3(n,e){if(_F(e))return 0;{let t=TF(n,e);return t===-1?n.length:t+1}}function _3(n,e){let{payload:t,prevKey:r,key:i}=e,s=TF(n,i),o=y3(n,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(c=>{let l={payload:c,type:"value",prevKey:a,key:c.key};return a=c.key,n=[...n,l],!1})}return n;case"child_added":if(s>-1)(n[s-1]?.key||null)!==r&&(n=n.filter(c=>c.payload.key!==t.key),n.splice(o,0,e));else{if(r==null)return[e,...n];n=n.slice(),n.splice(o,0,e)}return n;case"child_removed":return n.filter(a=>a.payload.key!==t.key);case"child_changed":return n.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=n.splice(s,1)[0];return n=n.slice(),n.splice(o,0,a),n}return n;default:return n}}function mF(n,e,t){return e=EF(e),m3(n,e,t)}function v3(n,e){let t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:gF(r,"update"),set:gF(r,"set"),push:i=>r.push(i),remove:g3(r),snapshotChanges(i){return mF(n,i,t).pipe(it)},stateChanges(i){return IF(n,i,t).pipe(it)},auditTrail(i){return h3(n,i,t).pipe(it)},valueChanges(i,s){return mF(n,i,t).pipe(ee(a=>a.map(c=>s&&s.idField?Je(Q({},c.payload.val()),{[s.idField]:c.key}):c.payload.val())),it)}}}function yF(n,e){return function(){return Gd(n,"value","on",e)}}function w3(n,e){return{query:n,snapshotChanges(){return yF(n,e.schedulers.outsideAngular)().pipe(it)},update(t){return n.ref.update(t)},set(t){return n.ref.set(t)},remove(){return n.ref.remove()},valueChanges(){return yF(n,e.schedulers.outsideAngular)().pipe(it,ee(r=>r.payload.exists()?r.payload.val():null))}}}var E3=new K("angularfire2.realtimeDatabaseURL"),I3=new K("angularfire2.database.use-emulator"),T3=(()=>{class n{schedulers;database;constructor(t,r,i,s,o,a,c,l,d,f,g,y,v,b,C){this.schedulers=a;let V=c,B=yi(t,o,r);l&&Cl(B,o,d,g,y,v,f,b),this.database=Ji(`${B.name}.database.${i}`,"AngularFireDatabase",B.name,()=>{let O=o.runOutsideAngular(()=>B.database(i||void 0));return V&&O.useEmulator(...V),O},[V])}list(t,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>pF(this.database,t)),s=i;return r&&(s=r(i)),v3(s,this)}object(t){let r=this.schedulers.ngZone.runOutsideAngular(()=>pF(this.database,t));return w3(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||n)(F(Lr),F(Vr,8),F(E3,8),F(jt),F(De),F(Zi),F(I3,8),F(Ep,8),F(_l,8),F(vl,8),F(wl,8),F(El,8),F(Il,8),F(Tl,8),F(dr,8))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),CF=(()=>{class n{constructor(){ft.registerVersion("angularfire",Fr.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=vt({type:n});static \u0275inj=_t({providers:[T3]})}return n})();var PF="firebasestorage.googleapis.com",kF="storageBucket",C3=2*60*1e3,D3=10*60*1e3,b3=1e3;var dt=class n extends yh{constructor(e,t,r=0){super(KD(e),`Firebase Storage: ${t} (${KD(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,n.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return KD(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}},ct=function(n){return n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment",n}(ct||{});function KD(n){return"storage/"+n}function n0(){let n="An unknown error occurred, please check the error payload for server response.";return new dt(ct.UNKNOWN,n)}function S3(n){return new dt(ct.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function A3(n){return new dt(ct.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function R3(){let n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new dt(ct.UNAUTHENTICATED,n)}function x3(){return new dt(ct.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function M3(n){return new dt(ct.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function OF(){return new dt(ct.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function FF(){return new dt(ct.CANCELED,"User canceled the upload/download.")}function N3(n){return new dt(ct.INVALID_URL,"Invalid URL '"+n+"'.")}function P3(n){return new dt(ct.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function k3(){return new dt(ct.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+kF+"' property when initializing the app?")}function LF(){return new dt(ct.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function O3(){return new dt(ct.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function F3(){return new dt(ct.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function L3(n){return new dt(ct.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function zo(n){return new dt(ct.INVALID_ARGUMENT,n)}function VF(){return new dt(ct.APP_DELETED,"The Firebase app was deleted.")}function r0(n){return new dt(ct.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Kd(n,e){return new dt(ct.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Wd(n){throw new dt(ct.INTERNAL_ERROR,"Internal error: "+n)}var yn=class n{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=n.makeFromUrl(e,t)}catch{return new n(e,"")}if(r.path==="")return r;throw P3(e)}static makeFromUrl(e,t){let r=null,i="([A-Za-z0-9.\\-_]+)";function s(z){z.path.charAt(z.path.length-1)==="/"&&(z.path_=z.path_.slice(0,-1))}let o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),c={bucket:1,path:3};function l(z){z.path_=decodeURIComponent(z.path)}let d="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",y=new RegExp(`^https?://${f}/${d}/b/${i}/o${g}`,"i"),v={bucket:1,path:3},b=t===PF?"(?:storage.googleapis.com|storage.cloud.google.com)":t,C="([^?#]*)",V=new RegExp(`^https?://${b}/${i}/${C}`,"i"),O=[{regex:a,indices:c,postModify:s},{regex:y,indices:v,postModify:l},{regex:V,indices:{bucket:1,path:2},postModify:l}];for(let z=0;z<O.length;z++){let re=O[z],Z=re.regex.exec(e);if(Z){let I=Z[re.indices.bucket],_=Z[re.indices.path];_||(_=""),r=new n(I,_),re.postModify(r);break}}if(r==null)throw N3(e);return r}},YD=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function V3(n,e,t){let r=1,i=null,s=null,o=!1,a=0;function c(){return a===2}let l=!1;function d(...C){l||(l=!0,e.apply(null,C))}function f(C){i=setTimeout(()=>{i=null,n(y,c())},C)}function g(){s&&clearTimeout(s)}function y(C,...V){if(l){g();return}if(C){g(),d.call(null,C,...V);return}if(c()||o){g(),d.call(null,C,...V);return}r<64&&(r*=2);let O;a===1?(a=2,O=0):O=(r+Math.random())*1e3,f(O)}let v=!1;function b(C){v||(v=!0,g(),!l&&(i!==null?(C||(a=2),clearTimeout(i),f(0)):C||(a=1)))}return f(0),s=setTimeout(()=>{o=!0,b(!0)},t),b}function U3(n){n(!1)}function j3(n){return n!==void 0}function B3(n){return typeof n=="function"}function $3(n){return typeof n=="object"&&!Array.isArray(n)}function jm(n){return typeof n=="string"||n instanceof String}function DF(n){return i0()&&n instanceof Blob}function i0(){return typeof Blob<"u"}function ZD(n,e,t,r){if(r<e)throw zo(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw zo(`Invalid value for '${n}'. Expected ${t} or less.`)}function Rs(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function UF(n){let e=encodeURIComponent,t="?";for(let r in n)if(n.hasOwnProperty(r)){let i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var Qc=function(n){return n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT",n}(Qc||{});function jF(n,e){let t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||i||s}var XD=class{constructor(e,t,r,i,s,o,a,c,l,d,f,g=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=d,this.connectionFactory_=f,this.retry=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((y,v)=>{this.resolve_=y,this.reject_=v,this.start_()})}start_(){let e=(r,i)=>{if(i){r(!1,new Kc(!1,null,!0));return}let s=this.connectionFactory_();this.pendingConnection_=s;let o=a=>{let c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;let a=s.getErrorCode()===Qc.NO_ERROR,c=s.getStatus();if(!a||jF(c,this.additionalRetryCodes_)&&this.retry){let d=s.getErrorCode()===Qc.ABORT;r(!1,new Kc(!1,null,d));return}let l=this.successCodes_.indexOf(c)!==-1;r(!0,new Kc(l,s))})},t=(r,i)=>{let s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{let c=this.callback_(a,a.getResponse());j3(c)?s(c):s()}catch(c){o(c)}else if(a!==null){let c=n0();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(i.canceled){let c=this.appDelete_?VF():FF();o(c)}else{let c=OF();o(c)}};this.canceled_?t(!1,new Kc(!1,null,!0)):this.backoffId_=V3(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&U3(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},Kc=class{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}};function q3(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function H3(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function z3(n,e){e&&(n["X-Firebase-GMPID"]=e)}function G3(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function W3(n,e,t,r,i,s,o=!0){let a=UF(n.urlParams),c=n.url+a,l=Object.assign({},n.headers);return z3(l,e),q3(l,t),H3(l,s),G3(l,r),new XD(c,n.method,l,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,o)}function K3(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Q3(...n){let e=K3();if(e!==void 0){let t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(i0())return new Blob(n);throw new dt(ct.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Y3(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}function Z3(n){if(typeof atob>"u")throw L3("base-64");return atob(n)}var $n={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Qd=class{constructor(e,t){this.data=e,this.contentType=t||null}};function s0(n,e){switch(n){case $n.RAW:return new Qd(BF(e));case $n.BASE64:case $n.BASE64URL:return new Qd($F(n,e));case $n.DATA_URL:return new Qd(J3(e),e6(e))}throw n0()}function BF(n){let e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{let s=r,o=n.charCodeAt(++t);r=65536|(s&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function X3(n){let e;try{e=decodeURIComponent(n)}catch{throw Kd($n.DATA_URL,"Malformed data URL.")}return BF(e)}function $F(n,e){switch(n){case $n.BASE64:{let i=e.indexOf("-")!==-1,s=e.indexOf("_")!==-1;if(i||s)throw Kd(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case $n.BASE64URL:{let i=e.indexOf("+")!==-1,s=e.indexOf("/")!==-1;if(i||s)throw Kd(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=Z3(e)}catch(i){throw i.message.includes("polyfill")?i:Kd(n,"Invalid character found")}let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}var Um=class{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(t===null)throw Kd($n.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let r=t[1]||null;r!=null&&(this.base64=t6(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}};function J3(n){let e=new Um(n);return e.base64?$F($n.BASE64,e.rest):X3(e.rest)}function e6(n){return new Um(n).contentType}function t6(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}var Yc=class n{constructor(e,t){let r=0,i="";DF(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(DF(this.data_)){let r=this.data_,i=Y3(r,e,t);return i===null?null:new n(i)}else{let r=new Uint8Array(this.data_.buffer,e,t-e);return new n(r,!0)}}static getBlob(...e){if(i0()){let t=e.map(r=>r instanceof n?r.data_:r);return new n(Q3.apply(null,t))}else{let t=e.map(o=>jm(o)?s0($n.RAW,o).data:o.data_),r=0;t.forEach(o=>{r+=o.byteLength});let i=new Uint8Array(r),s=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)i[s++]=o[a]}),new n(i,!0)}}uploadData(){return this.data_}};function o0(n){let e;try{e=JSON.parse(n)}catch{return null}return $3(e)?e:null}function n6(n){if(n.length===0)return null;let e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function r6(n,e){let t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function qF(n){let e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}function i6(n,e){return e}var Zt=class{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||i6}},Vm=null;function s6(n){return!jm(n)||n.length<2?n:qF(n)}function Bm(){if(Vm)return Vm;let n=[];n.push(new Zt("bucket")),n.push(new Zt("generation")),n.push(new Zt("metageneration")),n.push(new Zt("name","fullPath",!0));function e(s,o){return s6(o)}let t=new Zt("name");t.xform=e,n.push(t);function r(s,o){return o!==void 0?Number(o):o}let i=new Zt("size");return i.xform=r,n.push(i),n.push(new Zt("timeCreated")),n.push(new Zt("updated")),n.push(new Zt("md5Hash",null,!0)),n.push(new Zt("cacheControl",null,!0)),n.push(new Zt("contentDisposition",null,!0)),n.push(new Zt("contentEncoding",null,!0)),n.push(new Zt("contentLanguage",null,!0)),n.push(new Zt("contentType",null,!0)),n.push(new Zt("metadata","customMetadata",!0)),Vm=n,Vm}function o6(n,e){function t(){let r=n.bucket,i=n.fullPath,s=new yn(r,i);return e._makeStorageReference(s)}Object.defineProperty(n,"ref",{get:t})}function a6(n,e,t){let r={};r.type="file";let i=t.length;for(let s=0;s<i;s++){let o=t[s];r[o.local]=o.xform(r,e[o.server])}return o6(r,n),r}function HF(n,e,t){let r=o0(e);return r===null?null:a6(n,r,t)}function c6(n,e,t,r){let i=o0(e);if(i===null||!jm(i.downloadTokens))return null;let s=i.downloadTokens;if(s.length===0)return null;let o=encodeURIComponent;return s.split(",").map(l=>{let d=n.bucket,f=n.fullPath,g="/b/"+o(d)+"/o/"+o(f),y=Rs(g,t,r),v=UF({alt:"media",token:l});return y+v})[0]}function a0(n,e){let t={},r=e.length;for(let i=0;i<r;i++){let s=e[i];s.writable&&(t[s.server]=n[s.local])}return JSON.stringify(t)}var bF="prefixes",SF="items";function u6(n,e,t){let r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[bF])for(let i of t[bF]){let s=i.replace(/\/$/,""),o=n._makeStorageReference(new yn(e,s));r.prefixes.push(o)}if(t[SF])for(let i of t[SF]){let s=n._makeStorageReference(new yn(e,i.name));r.items.push(s)}return r}function l6(n,e,t){let r=o0(t);return r===null?null:u6(n,e,r)}var vr=class{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}};function ti(n){if(!n)throw n0()}function $m(n,e){function t(r,i){let s=HF(n,i,e);return ti(s!==null),s}return t}function d6(n,e){function t(r,i){let s=l6(n,e,i);return ti(s!==null),s}return t}function h6(n,e){function t(r,i){let s=HF(n,i,e);return ti(s!==null),c6(s,i,n.host,n._protocol)}return t}function Jc(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=x3():i=R3():t.getStatus()===402?i=A3(n.bucket):t.getStatus()===403?i=M3(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function qm(n){let e=Jc(n);function t(r,i){let s=e(r,i);return r.getStatus()===404&&(s=S3(n.path)),s.serverResponse=i.serverResponse,s}return t}function zF(n,e,t){let r=e.fullServerUrl(),i=Rs(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new vr(i,s,$m(n,t),o);return a.errorHandler=qm(e),a}function f6(n,e,t,r,i){let s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",t&&t.length>0&&(s.delimiter=t),r&&(s.pageToken=r),i&&(s.maxResults=i);let o=e.bucketOnlyServerUrl(),a=Rs(o,n.host,n._protocol),c="GET",l=n.maxOperationRetryTime,d=new vr(a,c,d6(n,e.bucket),l);return d.urlParams=s,d.errorHandler=Jc(e),d}function p6(n,e,t){let r=e.fullServerUrl(),i=Rs(r,n.host,n._protocol),s="GET",o=n.maxOperationRetryTime,a=new vr(i,s,h6(n,t),o);return a.errorHandler=qm(e),a}function g6(n,e,t,r){let i=e.fullServerUrl(),s=Rs(i,n.host,n._protocol),o="PATCH",a=a0(t,r),c={"Content-Type":"application/json; charset=utf-8"},l=n.maxOperationRetryTime,d=new vr(s,o,$m(n,r),l);return d.headers=c,d.body=a,d.errorHandler=qm(e),d}function m6(n,e){let t=e.fullServerUrl(),r=Rs(t,n.host,n._protocol),i="DELETE",s=n.maxOperationRetryTime;function o(c,l){}let a=new vr(r,i,o,s);return a.successCodes=[200,204],a.errorHandler=qm(e),a}function y6(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function GF(n,e,t){let r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=y6(null,e)),r}function _6(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let O="";for(let z=0;z<2;z++)O=O+Math.random().toString().slice(2);return O}let c=a();o["Content-Type"]="multipart/related; boundary="+c;let l=GF(e,r,i),d=a0(l,t),f="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,g=`\r
--`+c+"--",y=Yc.getBlob(f,r,g);if(y===null)throw LF();let v={name:l.fullPath},b=Rs(s,n.host,n._protocol),C="POST",V=n.maxUploadRetryTime,B=new vr(b,C,$m(n,t),V);return B.urlParams=v,B.headers=o,B.body=y.uploadData(),B.errorHandler=Jc(e),B}var Zc=class{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}};function c0(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{ti(!1)}return ti(!!t&&(e||["active"]).indexOf(t)!==-1),t}function v6(n,e,t,r,i){let s=e.bucketOnlyServerUrl(),o=GF(e,r,i),a={name:o.fullPath},c=Rs(s,n.host,n._protocol),l="POST",d={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},f=a0(o,t),g=n.maxUploadRetryTime;function y(b){c0(b);let C;try{C=b.getResponseHeader("X-Goog-Upload-URL")}catch{ti(!1)}return ti(jm(C)),C}let v=new vr(c,l,y,g);return v.urlParams=a,v.headers=d,v.body=f,v.errorHandler=Jc(e),v}function w6(n,e,t,r){let i={"X-Goog-Upload-Command":"query"};function s(l){let d=c0(l,["active","final"]),f=null;try{f=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{ti(!1)}f||ti(!1);let g=Number(f);return ti(!isNaN(g)),new Zc(g,r.size(),d==="final")}let o="POST",a=n.maxUploadRetryTime,c=new vr(t,o,s,a);return c.headers=i,c.errorHandler=Jc(e),c}var AF=256*1024;function E6(n,e,t,r,i,s,o,a){let c=new Zc(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw O3();let l=c.total-c.current,d=l;i>0&&(d=Math.min(d,i));let f=c.current,g=f+d,y="";d===0?y="finalize":l===d?y="upload, finalize":y="upload";let v={"X-Goog-Upload-Command":y,"X-Goog-Upload-Offset":`${c.current}`},b=r.slice(f,g);if(b===null)throw LF();function C(z,re){let Z=c0(z,["active","final"]),I=c.current+d,_=r.size(),w;return Z==="final"?w=$m(e,s)(z,re):w=null,new Zc(I,_,Z==="final",w)}let V="POST",B=e.maxUploadRetryTime,O=new vr(t,V,C,B);return O.headers=v,O.body=b.uploadData(),O.progressCallback=a||null,O.errorHandler=Jc(n),O}var WF={STATE_CHANGED:"state_changed"},on={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function QD(n){switch(n){case"running":case"pausing":case"canceling":return on.RUNNING;case"paused":return on.PAUSED;case"success":return on.SUCCESS;case"canceled":return on.CANCELED;case"error":return on.ERROR;default:return on.ERROR}}var JD=class{constructor(e,t,r){if(B3(e)||t!=null||r!=null)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{let s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}};function Wc(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}var RF=null,e0=class{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Qc.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Qc.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Qc.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw Wd("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(let s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Wd("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Wd("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Wd("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Wd("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}},t0=class extends e0{initXhr(){this.xhr_.responseType="text"}};function ei(){return RF?RF():new t0}var Yd=class{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=Bm(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals(ct.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let s=this.isExponentialBackoffExpired();if(jF(i.status,[]))if(s)i=OF();else{this.sleepTime=Math.max(this.sleepTime*2,b3),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals(ct.CANCELED)?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,s)=>{this._resolve=i,this._reject=s,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,t)=>{let r=v6(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,ei,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._uploadUrl=s,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((t,r)=>{let i=w6(this._ref.storage,this._ref._location,e,this._blob),s=this._ref.storage._makeRequest(i,ei,t,r);this._request=s,s.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=AF*this._chunkMultiplier,t=new Zc(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,s)=>{let o;try{o=E6(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}let a=this._ref.storage._makeRequest(o,ei,i,s,!1);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){AF*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{let r=zF(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,ei,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{let r=_6(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,ei,e,t);this._request=i,i.getPromise().then(s=>{this._request=void 0,this._metadata=s,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let t=this._state==="paused";this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=FF(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){let e=QD(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){let s=new JD(t||void 0,r||void 0,i||void 0);return this._addObserver(s),()=>{this._removeObserver(s)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let t=this._observers.indexOf(e);t!==-1&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(QD(this._state)){case on.SUCCESS:Wc(this._resolve.bind(null,this.snapshot))();break;case on.CANCELED:case on.ERROR:let t=this._reject;Wc(t.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(QD(this._state)){case on.RUNNING:case on.PAUSED:e.next&&Wc(e.next.bind(e,this.snapshot))();break;case on.SUCCESS:e.complete&&Wc(e.complete.bind(e))();break;case on.CANCELED:case on.ERROR:e.error&&Wc(e.error.bind(e,this._error))();break;default:e.error&&Wc(e.error.bind(e,this._error))()}}resume(){let e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){let e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){let e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}};var Xc=class n{constructor(e,t){this._service=e,t instanceof yn?this._location=t:this._location=yn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new n(e,t)}get root(){let e=new yn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return qF(this._location.path)}get storage(){return this._service}get parent(){let e=n6(this._location.path);if(e===null)return null;let t=new yn(this._location.bucket,e);return new n(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw r0(e)}};function I6(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new Yd(n,new Yc(e),t)}function T6(n){let e={prefixes:[],items:[]};return KF(n,e).then(()=>e)}function KF(n,e,t){return M(this,null,function*(){let i=yield QF(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),i.nextPageToken!=null&&(yield KF(n,e,i.nextPageToken))})}function QF(n,e){e!=null&&typeof e.maxResults=="number"&&ZD("options.maxResults",1,1e3,e.maxResults);let t=e||{},r=f6(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,ei)}function C6(n){n._throwIfRoot("getMetadata");let e=zF(n.storage,n._location,Bm());return n.storage.makeRequestWithTokens(e,ei)}function D6(n,e){n._throwIfRoot("updateMetadata");let t=g6(n.storage,n._location,e,Bm());return n.storage.makeRequestWithTokens(t,ei)}function b6(n){n._throwIfRoot("getDownloadURL");let e=p6(n.storage,n._location,Bm());return n.storage.makeRequestWithTokens(e,ei).then(t=>{if(t===null)throw F3();return t})}function S6(n){n._throwIfRoot("deleteObject");let e=m6(n.storage,n._location);return n.storage.makeRequestWithTokens(e,ei)}function YF(n,e){let t=r6(n._location.path,e),r=new yn(n._location.bucket,t);return new Xc(n.storage,r)}function A6(n){return/^[A-Za-z]+:\/\//.test(n)}function R6(n,e){return new Xc(n,e)}function ZF(n,e){if(n instanceof Zd){let t=n;if(t._bucket==null)throw k3();let r=new Xc(t,t._bucket);return e!=null?ZF(r,e):r}else return e!==void 0?YF(n,e):n}function x6(n,e){if(e&&A6(e)){if(n instanceof Zd)return R6(n,e);throw zo("To use ref(service, url), the first argument must be a Storage instance.")}else return ZF(n,e)}function xF(n,e){let t=e?.[kF];return t==null?null:yn.makeFromBucketSpec(t,n)}function M6(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";let{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:ta(i,n.app.options.projectId))}var Zd=class{constructor(e,t,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=PF,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=C3,this._maxUploadRetryTime=D3,this._requests=new Set,i!=null?this._bucket=yn.makeFromBucketSpec(i,this._host):this._bucket=xF(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=yn.makeFromBucketSpec(this._url,e):this._bucket=xF(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){ZD("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){ZD("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){return M(this,null,function*(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=yield e.getToken();if(t!==null)return t.accessToken}return null})}_getAppCheckToken(){return M(this,null,function*(){let e=this._appCheckProvider.getImmediate({optional:!0});return e?(yield e.getToken()).token:null})}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xc(this,e)}_makeRequest(e,t,r,i,s=!0){if(this._deleted)return new YD(VF());{let o=W3(e,this._appId,r,i,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}makeRequestWithTokens(e,t){return M(this,null,function*(){let[r,i]=yield Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()})}},MF="@firebase/storage",NF="0.13.1";var N6="storage";function XF(n,e,t){return n=ce(n),I6(n,e,t)}function JF(n){return n=ce(n),C6(n)}function eL(n,e){return n=ce(n),D6(n,e)}function tL(n,e){return n=ce(n),QF(n,e)}function nL(n){return n=ce(n),T6(n)}function rL(n){return n=ce(n),b6(n)}function iL(n){return n=ce(n),S6(n)}function u0(n,e){return n=ce(n),x6(n,e)}function sL(n,e){return YF(n,e)}function oL(n,e,t,r={}){M6(n,e,t,r)}function P6(n,{instanceIdentifier:e}){let t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Zd(t,r,i,e,na)}function k6(){si(new Gt(N6,P6,"PUBLIC").setMultipleInstances(!0)),En(MF,NF,""),En(MF,NF,"esm2017")}k6();var eu=class{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}};var Hm=class{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new eu(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new eu(r,this,this._ref))},t)}on(e,t,r,i){let s;return t&&(typeof t=="function"?s=o=>t(new eu(o,this,this._ref)):s={next:t.next?o=>t.next(new eu(o,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,s,r||void 0,i||void 0)}},zm=class{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new Go(e,this._service))}get items(){return this._delegate.items.map(e=>new Go(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}};var Go=class n{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let t=sL(this._delegate,e);return new n(t,this.storage)}get root(){return new n(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return e==null?null:new n(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new Hm(XF(this._delegate,e,t),this)}putString(e,t=$n.RAW,r){this._throwIfRoot("putString");let i=s0(t,e),s=Object.assign({},r);return s.contentType==null&&i.contentType!=null&&(s.contentType=i.contentType),new Hm(new Yd(this._delegate,new Yc(i.data,!0),s),this)}listAll(){return nL(this._delegate).then(e=>new zm(e,this.storage))}list(e){return tL(this._delegate,e||void 0).then(t=>new zm(t,this.storage))}getMetadata(){return JF(this._delegate)}updateMetadata(e){return eL(this._delegate,e)}getDownloadURL(){return rL(this._delegate)}delete(){return this._throwIfRoot("delete"),iL(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw r0(e)}};var Gm=class{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(aL(e))throw zo("ref() expected a child path but got a URL, use refFromURL instead.");return new Go(u0(this._delegate,e),this)}refFromURL(e){if(!aL(e))throw zo("refFromURL() expected a full URL but got a child path, use ref() instead.");try{yn.makeFromUrl(e,this._delegate.host)}catch{throw zo("refFromUrl() expected a valid full URL but got an invalid one.")}return new Go(u0(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){oL(this._delegate,e,t,r)}};function aL(n){return/^[A-Za-z]+:\/\//.test(n)}var O6="@firebase/storage-compat",F6="0.3.11";var L6="storage-compat";function V6(n,{instanceIdentifier:e}){let t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new Gm(t,r)}function U6(n){let e={TaskState:on,TaskEvent:WF,StringFormat:$n,Storage:Gm,Reference:Go};n.INTERNAL.registerComponent(new Gt(L6,V6,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion(O6,F6)}U6(ft);function j6(n){return new ve(e=>{let t=o=>e.next(o),r=o=>e.error(o),i=()=>e.complete();t(n.snapshot);let s=n.on("state_changed",t);return n.then(o=>{t(o),i()},o=>{t(n.snapshot),r(o)}),function(){s()}}).pipe(ky(0))}function cL(n){let e=j6(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>e,percentageChanges:()=>e.pipe(ee(t=>t.bytesTransferred/t.totalBytes*100))}}function Wm(n){return{getDownloadURL:()=>ne(void 0).pipe(Lw,ze(()=>n.getDownloadURL()),it),getMetadata:()=>ne(void 0).pipe(Lw,ze(()=>n.getMetadata()),it),delete:()=>Ae(n.delete()),child:e=>Wm(n.child(e)),updateMetadata:e=>Ae(n.updateMetadata(e)),put:(e,t)=>{let r=n.put(e,t);return cL(r)},putString:(e,t,r)=>{let i=n.putString(e,t,r);return cL(i)},list:e=>Ae(n.list(e)),listAll:()=>Ae(n.listAll())}}var B6=new K("angularfire2.storageBucket"),$6=new K("angularfire2.storage.maxUploadRetryTime"),q6=new K("angularfire2.storage.maxOperationRetryTime"),H6=new K("angularfire2.storage.use-emulator"),z6=(()=>{class n{storage;constructor(t,r,i,s,o,a,c,l,d,f){let g=yi(t,o,r);this.storage=Ji(`${g.name}.storage.${i}`,"AngularFireStorage",g.name,()=>{let y=o.runOutsideAngular(()=>g.storage(i||void 0)),v=d;return v&&y.useEmulator(...v),c&&y.setMaxUploadRetryTime(c),l&&y.setMaxOperationRetryTime(l),y},[c,l])}ref(t){return Wm(this.storage.ref(t))}refFromURL(t){return Wm(this.storage.refFromURL(t))}upload(t,r,i){let s=this.storage.ref(t);return Wm(s).put(r,i)}static \u0275fac=function(r){return new(r||n)(F(Lr),F(Vr,8),F(B6,8),F(jt),F(De),F(Zi),F($6,8),F(q6,8),F(H6,8),F(dr,8))};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var G6=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=vt({type:n});static \u0275inj=_t({})}return n})(),uL=(()=>{class n{constructor(){ft.registerVersion("angularfire",Fr.full,"gcs-compat")}static \u0275fac=function(r){return new(r||n)};static \u0275mod=vt({type:n});static \u0275inj=_t({providers:[z6],imports:[G6]})}return n})();var lL=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=vt({type:e,bootstrap:[eO]}),e.\u0275inj=_t({imports:[ax,Xx,fM.initializeApp(tO.firebaseConfig),CF,Xk,uL]});let n=e;return n})();ox().bootstrapModule(lL).catch(n=>console.error(n));
